<!-- HTML header for doxygen 1.10.0-->
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
  <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=11" />
  <meta name="generator" content="Doxygen 1.10.0" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>INSTINCT: Single Point Positioning using Kalman Filtering</title>
  <link href="tabs.css" rel="stylesheet" type="text/css" />
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript" src="dynsections.js"></script>
  <script type="text/javascript" src="clipboard.js"></script>
  <link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
  <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
  <link href="doxygen.css" rel="stylesheet" type="text/css" />
  <link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
  <!--Doxygen Awesome Theme related settings:-->
  <script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
  <script type="text/javascript" src="doxygen-awesome-fragment-copy-button.js"></script>
  <script type="text/javascript" src="doxygen-awesome-paragraph-link.js"></script>
  <script type="text/javascript" src="doxygen-awesome-interactive-toc.js"></script>
  <script type="text/javascript" src="doxygen-awesome-tabs.js"></script>
  <script type="text/javascript">
    DoxygenAwesomeDarkModeToggle.init()
    DoxygenAwesomeFragmentCopyButton.init()
    DoxygenAwesomeInteractiveToc.init()
    DoxygenAwesomeParagraphLink.init()
    DoxygenAwesomeTabs.init()
  </script>
  <!--End of Doxygen Awesome settings-->
</head>
<body>
    <div id="top"><!-- do not remove this div, it is closed by doxygen! -->
      <div id="titlearea">
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr id="projectrow">
              <td id="projectlogo"><img alt="Logo" src="INSTINCT_Logo_Text.png"  /></td>
              <td id="projectalign">
                <div id="projectname"><span
                    id="projectnumber">&#160;0.2.0</span>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      <!-- end header part --><!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('group__SppKF.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">Single Point Positioning using Kalman Filtering<div class="ingroups"><a class="el" href="group__DataProcessor__chapter.html">DataProcessor</a> &raquo; <a class="el" href="group__DataProcessor__GNSS__chapter.html">GNSS</a></div></div></div>
</div><!--header-->
<div class="contents">
<h1><a class="anchor" id="SppKF-KfAlgorithm"></a>
Algorithm - Extended Kalman Filter</h1>
<ul>
<li>Prediction <a class="anchor" id="eq-SppKF-KfAlgorithm-prediction"></a> <p class="formulaDsp">
<img class="formulaDsp" alt="\begin{equation} \label{eq:eq-SppKF-KfAlgorithm-prediction}
\begin{aligned}
  \hat{\boldsymbol{x}}_{n \mid n-1} &amp;=\boldsymbol{\Phi}_{n-1 \mid n-1} \cdot \hat{\boldsymbol{x}}_{n-1 \mid n-1} \\
  \boldsymbol{P}_{n \mid n-1} &amp;=\boldsymbol{\Phi}_{n-1 \mid n-1} \boldsymbol{P}_{n-1 \mid n-1} \boldsymbol{\Phi}_{n-1 \mid n-1}^{T}+\boldsymbol{Q}
\end{aligned}
\end{equation}" src="form_122.svg" width="1638" height="51"/>
</p>
</li>
<li>Kalman Gain <a class="anchor" id="eq-SppKF-KfAlgorithm-gain"></a> <p class="formulaDsp">
<img class="formulaDsp" alt="\begin{equation} \label{eq:eq-SppKF-KfAlgorithm-gain}
\boldsymbol{K}_{n}=\boldsymbol{P}_{n \mid n-1} \boldsymbol{H}_{n}^{T}\left(\boldsymbol{H}_{n} \boldsymbol{P}_{n \mid n-1} \boldsymbol{H}_{n}^{T}+\boldsymbol{R}_{n}\right)^{-1}
\end{equation}" src="form_123.svg" width="1642" height="37"/>
</p>
</li>
<li>Update <a class="anchor" id="eq-SppKF-KfAlgorithm-update"></a> <p class="formulaDsp">
<img class="formulaDsp" alt="\begin{equation} \label{eq:eq-SppKF-KfAlgorithm-update}
\begin{aligned}
  \hat{\boldsymbol{x}}_{n \mid n}&amp;=\hat{\boldsymbol{x}}_{n \mid n-1}+\boldsymbol{K}_{n}\left(\Delta \boldsymbol{y}_{n}-\boldsymbol{H}_{n} \left(\hat{\boldsymbol{x}}_{n \mid n-1} - \hat{\boldsymbol{x}}_{n-1 \mid n-1}\right)\right) \\
  \boldsymbol{P}_{n \mid n}&amp;=\left(\boldsymbol{I}-\boldsymbol{K}_{n} \boldsymbol{H}_{n}\right) \boldsymbol{P}_{n \mid n-1}
\end{aligned}
\end{equation}" src="form_124.svg" width="1685" height="47"/>
</p>
</li>
</ul>
<h1><a class="anchor" id="SppKF-unknowns"></a>
Unknowns</h1>
<p>Pseudorange and Doppler observations are processed together.</p>
<p><a class="anchor" id="eq-SppKF-unknowns"></a> </p><p class="formulaDsp">
<img class="formulaDsp" alt="\begin{equation} \label{eq:eq-SppKF-unknowns}
\mathbf{x}^e =
  \begin{tikzpicture}[baseline=-\the\dimexpr\fontdimen22\textfont2\relax,decoration=brace]
    \matrix (m)[matrix of math nodes,left delimiter={[},right delimiter={]},
                nodes={rectangle,text width=2.5em,align=center},row sep=0.3em, column sep=0.4em] {
      \mathbf{r}^e \\
      \mathbf{v}^e \\
      dt_R \\
      d\dotup{t}_R \\
      dt_{ISB}^{S_2 \rightarrow S_1} \\
      d\dotup{t}_{ISB}^{S_2 \rightarrow S_1} \\
      \vdots \\
      dt_{ISB}^{S_o \rightarrow S_1} \\
      d\dotup{t}_{ISB}^{S_o \rightarrow S_1} \\
    };
    \draw [dash dot] (-0.75,1.9) -- (0.75,1.9);

  \end{tikzpicture}
  =
  \begin{tikzpicture}[baseline=-\the\dimexpr\fontdimen22\textfont2\relax,decoration=brace]
    \matrix (m)[matrix of math nodes,left delimiter={[},right delimiter={]},
                nodes={rectangle,text width=20em,align=center},row sep=0.3em, column sep=0.4em] {
      \text{Position [m]} \\
      \text{Velocity [m/s]} \\
      \text{Receiver clock error [m]} \\
      \text{Receiver clock drift [m/s]} \\
      \text{Inter-system clock error (System 2 to 1) [m]} \\
      \text{Inter-system clock drift (System 2 to 1)  [m/s]} \\
      \vdots \\
      \text{Inter-system clock error (System o to 1) [m]} \\
      \text{Inter-system clock drift (System o to 1)  [m/s]} \\
    };
    \draw [dash dot] (-3.75,1.9) -- (3.75,1.9);

  \end{tikzpicture}
\end{equation}" src="form_125.svg" width="1752" height="326"/>
</p>
<h1><a class="anchor" id="SppKF-processModel"></a>
Process Model</h1>
<h2><a class="anchor" id="SppKF-processModel-systemModel"></a>
System Model</h2>
<p><a class="anchor" id="eq-SppKF-processModel-systemModel"></a> </p><p class="formulaDsp">
<img class="formulaDsp" alt="\begin{equation} \label{eq:eq-SppKF-processModel-systemModel}
\begin{tikzpicture}[baseline=-\the\dimexpr\fontdimen22\textfont2\relax,decoration=brace]
  \matrix (m)[matrix of math nodes,left delimiter={(},right delimiter={)},nodes={rectangle,text width=2.5em,align=center},row sep=0.3em, column sep=0.4em]
  {
    \boldsymbol{v}^e \\
    \boldsymbol{a}^e \\
    d\dotup{t}_R \\
    d\ddotup{t}_R \\
    d\dotup{t}_{ISB}^{S_2 \rightarrow S_1} \\
    d\dotup{t}_{ISB}^{S_2 \rightarrow S_1} \\
    \vdots \\
    d\dotup{t}_{ISB}^{S_o \rightarrow S_1} \\
    d\dotup{t}_{ISB}^{S_o \rightarrow S_1} \\
  };
  \draw[decorate,transform canvas={yshift=.5em},thick] (m-1-1.north west) -- node[above=2pt] {$\boldsymbol{\dot{x}}^e$} (m-1-1.north east);
  \draw [dash dot] (-0.75,1.9) -- (0.75,1.9);

\end{tikzpicture}
=
\begin{tikzpicture}[baseline=-\the\dimexpr\fontdimen22\textfont2\relax,decoration=brace]
  \matrix (m)[matrix of math nodes,left delimiter={(},right delimiter={)},
              nodes={rectangle,text width=2.5em,align=center},row sep=0.3em, column sep=0.4em]
  {
    \mathbf{0}_3     &amp; \mathbf{I}_3     &amp; \mathbf{0}_{3,1} &amp; \mathbf{0}_{3,1} &amp; \mathbf{0}_{3,1} &amp; \mathbf{0}_{3,1} &amp; \dots  &amp; \mathbf{0}_{3,1} &amp; \mathbf{0}_{3,1} \\
    \mathbf{0}_3     &amp; \mathbf{0}_3     &amp; \mathbf{0}_{3,1} &amp; \mathbf{0}_{3,1} &amp; \mathbf{0}_{3,1} &amp; \mathbf{0}_{3,1} &amp; \dots  &amp; \mathbf{0}_{3,1} &amp; \mathbf{0}_{3,1} \\
    \mathbf{0}_{1,3} &amp; \mathbf{0}_{1,3} &amp;         0        &amp;         1        &amp;         0        &amp;         0        &amp; \dots  &amp;         0        &amp;         0        \\
    \mathbf{0}_{1,3} &amp; \mathbf{0}_{1,3} &amp;         0        &amp;         0        &amp;         0        &amp;         0        &amp; \dots  &amp;         0        &amp;         0        \\
    \mathbf{0}_{1,3} &amp; \mathbf{0}_{1,3} &amp;         0        &amp;         0        &amp;         0        &amp;         1        &amp; \dots  &amp;         0        &amp;         0        \\
    \mathbf{0}_{1,3} &amp; \mathbf{0}_{1,3} &amp;         0        &amp;         0        &amp;         0        &amp;         0        &amp; \dots  &amp;         0        &amp;         0        \\
    \vdots      &amp;      \vdots      &amp;      \vdots      &amp;      \vdots      &amp;      \vdots      &amp;      \vdots      &amp; \ddots &amp;      \vdots      &amp;      \vdots      \\
    \mathbf{0}_{1,3} &amp; \mathbf{0}_{1,3} &amp;         0        &amp;         0        &amp;         0        &amp;         0        &amp; \dots  &amp;         0        &amp;         1        \\
    \mathbf{0}_{1,3} &amp; \mathbf{0}_{1,3} &amp;         0        &amp;         0        &amp;         0        &amp;         0        &amp; \dots  &amp;         0        &amp;         0        \\
  };
  \draw[decorate,transform canvas={yshift=.5em},thick] (m-1-1.north west) -- node[above=2pt] {$\mathbf{F}$} (m-1-9.north east);
  \draw [dash dot] (-5.75,1.9) -- (5.75,1.9);
  \draw [dash dot] (-3.2,3.1) -- (-3.2,-3.2);

\end{tikzpicture}
\cdot
\begin{tikzpicture}[baseline=-\the\dimexpr\fontdimen22\textfont2\relax,decoration=brace]
  \matrix (m)[matrix of math nodes,left delimiter={(},right delimiter={)},
              nodes={rectangle,text width=2.5em,align=center},row sep=0.3em, column sep=0.4em]
  {
    \mathbf{r}^e \\
    \mathbf{v}^e \\
    dt_R \\
    d\dotup{t}_R \\
    dt_{ISB}^{S_2 \rightarrow S_1} \\
    d\dotup{t}_{ISB}^{S_2 \rightarrow S_1} \\
    \vdots \\
    dt_{ISB}^{S_o \rightarrow S_1} \\
    d\dotup{t}_{ISB}^{S_o \rightarrow S_1} \\
  };
  \draw[decorate,transform canvas={yshift=.5em},thick] (m-1-1.north west) -- node[above=2pt] {$\mathbf{x}^e$} (m-1-1.north east);
  \draw [dash dot] (-0.75,1.9) -- (0.75,1.9);

\end{tikzpicture}
+
\mathbf{G} \cdot \boldsymbol{w}
\end{equation}" src="form_126.svg" width="1920" height="354"/>
</p>
<p>(<a class="el" href="citelist.html#CITEREF_Groves2013">[16]</a> Groves, ch. 9.4.2.2, eq. 9.148, p. 415)</p>
<h2><a class="anchor" id="SppKF-processModel-stateTransitionMatrix"></a>
State transition matrix</h2>
<p>Higher order terms are zero, so the exact solution is</p>
<p><a class="anchor" id="eq-SppKF-processModel-stateTransitionMatrix"></a> </p><p class="formulaDsp">
<img class="formulaDsp" alt="\begin{equation} \label{eq:eq-SppKF-processModel-stateTransitionMatrix}
\mathbf{\Phi} = \text{exp}(\mathbf{F} \tau_s) = \mathbf{I} + \mathbf{F}\tau_s
\end{equation}" src="form_127.svg" width="1565" height="19"/>
</p>
<p>(<a class="el" href="citelist.html#CITEREF_Groves2013">[16]</a> Groves, ch. 9.4.2.2, eq. 9.150, p. 416)</p>
<h2><a class="anchor" id="SppKF-processModel-processNoise"></a>
Process noise covariance matrix</h2>
<p><b> Clock modeling </b></p><ul>
<li>Phase drift <img class="formulaInl" alt="$ \sigma_{c\phi} $" src="form_128.svg" width="25" height="14"/> (random walk) and Frequency drift <img class="formulaInl" alt="$ \sigma_{cf} $" src="form_129.svg" width="25" height="14"/> (integrated random walk) <a class="anchor" id="eq-SppKF-processModel-processNoise-clock"></a> <p class="formulaDsp">
<img class="formulaDsp" alt="\begin{equation} \label{eq:eq-SppKF-processModel-processNoise-clock}
S_{c f}^a = \frac{\sigma^2\left(\delta \dot{\rho}_c^a\left(t+\tau_s\right)-\delta \dot{\rho}_c^a(t)\right)}{\tau_s} \quad S_{c \phi}^a = \frac{\sigma^2\left(\delta \rho_c^a\left(t+tau_s\right)-\delta \rho_c^a(t)-\delta \dot{\rho}_c^a(t) \tau_s\right)}{\tau_s}
\end{equation}" src="form_130.svg" width="1771" height="44"/>
</p>
</li>
<li>Typical values for a TCXO are <img class="formulaInl" alt="$ S_{cf} \approx 0.04 \text{ m}^2 \text{s}^{-3} $" src="form_131.svg" width="133" height="21"/> and <img class="formulaInl" alt="$ S_{c\phi} \approx 0.01 \text{ m}^2 \text{s}^{-1} $" src="form_132.svg" width="133" height="21"/></li>
</ul>
<p><b> Velocity change due to user motion (Variances) </b> <br  />
  <img class="formulaInl" alt="$
  \mathbf{S}_a^n
  =
  \begin{bmatrix}
    S_{aH} &amp; 0 &amp; 0 \\
    0 &amp; S_{aH} &amp; 0 \\
    0 &amp; 0 &amp; S_{aV} \\
  \end{bmatrix}
  $" src="form_133.svg" width="191" height="63"/></p>
<p><a class="anchor" id="eq-SppKF-processModel-processNoise-userMotion"></a> </p><p class="formulaDsp">
<img class="formulaDsp" alt="\begin{equation} \label{eq:eq-SppKF-processModel-processNoise-userMotion}
\begin{aligned}
&amp; S_{a H}=\frac{\sigma^2\left(v_{e b, N}^n\left(t+\tau_s\right)-v_{e b, N}^n(t)\right)}{\tau_s}=\frac{\sigma^2\left(v_{e b, E}^n\left(t+\tau_s\right)-v_{e b, E}^n(t)\right)}{\tau_s} \\
&amp; S_{a V}=\frac{\sigma^2\left(v_{e b, D}^n\left(t+\tau_s\right)-v_{e b, D}^n(t)\right)}{\tau_s}
\end{aligned}
\end{equation}" src="form_134.svg" width="1733" height="114"/>
</p>
<ul>
<li>Suitable values for <img class="formulaInl" alt="$ S_{aH} $" src="form_135.svg" width="32" height="16"/> are around<ul>
<li><img class="formulaInl" alt="$ 1 \text{ m}^2 \text{s}^{–3} $" src="form_136.svg" width="58" height="18"/> for a pedestrian or ship,</li>
<li><img class="formulaInl" alt="$ 10 \text{ m}^2 \text{s}^{–3} $" src="form_137.svg" width="67" height="18"/> for a car,</li>
<li><img class="formulaInl" alt="$ 100 \text{ m}^2 \text{s}^{–3} $" src="form_138.svg" width="75" height="18"/> for a military aircraft.</li>
</ul>
</li>
<li>The vertical acceleration PSD <img class="formulaInl" alt="$ S_{aV} $" src="form_139.svg" width="30" height="16"/> is usually smaller</li>
</ul>
<p>(<a class="el" href="citelist.html#CITEREF_Groves2013">[16]</a> Groves, ch. 9.4.2.2, p. 416-418)</p>
<h3><a class="anchor" id="SppKF-processModel-processNoise-vanLoan"></a>
Van Loan method</h3>
<p><b> Noise input matrix </b></p>
<p><a class="anchor" id="eq-SppKF-processModel-processNoise-vanLoan-noiseInput"></a> </p><p class="formulaDsp">
<img class="formulaDsp" alt="\begin{equation} \label{eq:eq-SppKF-processModel-processNoise-vanLoan-noiseInput}
\mathbf{G}
=
\begin{tikzpicture}[baseline=-\the\dimexpr\fontdimen22\textfont2\relax,decoration=brace]
  \matrix (m)[matrix of math nodes,left delimiter={[},right delimiter={]},
              nodes={rectangle,text width=2.5em,align=center},row sep=0.3em, column sep=0.4em]
  {
    \mathbf{0}_3     &amp; \mathbf{0}_3     &amp; \mathbf{0}_{3,1} &amp; \mathbf{0}_{3,1} &amp; \mathbf{0}_{3,1} &amp; \mathbf{0}_{3,1} &amp; \dots  &amp; \mathbf{0}_{3,1} &amp; \mathbf{0}_{3,1} \\
    \mathbf{0}_3     &amp; \mathbf{C}_n^e   &amp; \mathbf{0}_{3,1} &amp; \mathbf{0}_{3,1} &amp; \mathbf{0}_{3,1} &amp; \mathbf{0}_{3,1} &amp; \dots  &amp; \mathbf{0}_{3,1} &amp; \mathbf{0}_{3,1} \\
    \mathbf{0}_{1,3} &amp; \mathbf{0}_{1,3} &amp;         1        &amp;         0        &amp;         0        &amp;         0        &amp; \dots  &amp;         0        &amp;         0        \\
    \mathbf{0}_{1,3} &amp; \mathbf{0}_{1,3} &amp;         0        &amp;         1        &amp;         0        &amp;         0        &amp; \dots  &amp;         0        &amp;         0        \\
    \mathbf{0}_{1,3} &amp; \mathbf{0}_{1,3} &amp;         0        &amp;         0        &amp;         1        &amp;         0        &amp; \dots  &amp;         0        &amp;         0        \\
    \mathbf{0}_{1,3} &amp; \mathbf{0}_{1,3} &amp;         0        &amp;         0        &amp;         0        &amp;         1        &amp; \dots  &amp;         0        &amp;         0        \\
         \vdots      &amp;      \vdots      &amp;      \vdots      &amp;      \vdots      &amp;      \vdots      &amp;      \vdots      &amp; \ddots &amp;      \vdots      &amp;      \vdots      \\
    \mathbf{0}_{1,3} &amp; \mathbf{0}_{1,3} &amp;         0        &amp;         0        &amp;         0        &amp;         0        &amp; \dots  &amp;         1        &amp;         0        \\
    \mathbf{0}_{1,3} &amp; \mathbf{0}_{1,3} &amp;         0        &amp;         0        &amp;         0        &amp;         0        &amp; \dots  &amp;         0        &amp;         1        \\
  };
  \draw [dash dot] (-5.75,1.8) -- (5.75,1.8);
  \draw [dash dot] (-3.2,3.1) -- (-3.2,-3.1);

\end{tikzpicture}
\end{equation}" src="form_140.svg" width="1787" height="315"/>
</p>
<p><b> Noise scale matrix </b></p>
<p><a class="anchor" id="eq-SppKF-processModel-processNoise-vanLoan-noiseScale"></a> </p><p class="formulaDsp">
<img class="formulaDsp" alt="\begin{equation} \label{eq:eq-SppKF-processModel-processNoise-vanLoan-noiseScale}
\mathbf{W}
=
\begin{tikzpicture}[baseline=-\the\dimexpr\fontdimen22\textfont2\relax,decoration=brace]
  \matrix (m)[matrix of math nodes,left delimiter={[},right delimiter={]},
              nodes={rectangle,text width=2.5em,align=center},row sep=0.3em, column sep=0.4em]
  {
    \mathbf{0}_3     &amp; \mathbf{0}_3       &amp; \mathbf{0}_{3,1} &amp; \mathbf{0}_{3,1} &amp;               \mathbf{0}_{3,1}              &amp;             \mathbf{0}_{3,1}             &amp; \dots  &amp;               \mathbf{0}_{3,1}              &amp;              \mathbf{0}_{3,1}            \\
    \mathbf{0}_3     &amp; \mathbf{S}_{a}^{n} &amp; \mathbf{0}_{3,1} &amp; \mathbf{0}_{3,1} &amp;               \mathbf{0}_{3,1}              &amp;             \mathbf{0}_{3,1}             &amp; \dots  &amp;               \mathbf{0}_{3,1}              &amp;              \mathbf{0}_{3,1}            \\
    \mathbf{0}_{1,3} &amp; \mathbf{0}_{1,3}   &amp; \sigma_{c\phi}^2 &amp;         0        &amp;                       0                     &amp;                     0                    &amp; \dots  &amp;                       0                     &amp;                      0                   \\
    \mathbf{0}_{1,3} &amp; \mathbf{0}_{1,3}   &amp;         0        &amp;   \sigma_{cf}^2  &amp;                       0                     &amp;                     0                    &amp; \dots  &amp;                       0                     &amp;                      0                   \\
    \mathbf{0}_{1,3} &amp; \mathbf{0}_{1,3}   &amp;         0        &amp;         0        &amp; {\sigma_{ISB,\phi}^{S_2 \rightarrow S_1}}^2 &amp;                     0                    &amp; \dots  &amp;                       0                     &amp;                      0                   \\
    \mathbf{0}_{1,3} &amp; \mathbf{0}_{1,3}   &amp;         0        &amp;         0        &amp;                       0                     &amp; {\sigma_{ISB,f}^{S_2 \rightarrow S_1}}^2 &amp; \dots  &amp;                       0                     &amp;                      0                   \\
         \vdots      &amp;      \vdots        &amp;      \vdots      &amp;      \vdots      &amp;                    \vdots                   &amp;                  \vdots                  &amp; \ddots &amp;                    \vdots                   &amp;                   \vdots                 \\
    \mathbf{0}_{1,3} &amp; \mathbf{0}_{1,3}   &amp;         0        &amp;         0        &amp;                       0                     &amp;                     0                    &amp; \dots  &amp; {\sigma_{ISB,\phi}^{S_o \rightarrow S_1}}^2 &amp;                      0                   \\
    \mathbf{0}_{1,3} &amp; \mathbf{0}_{1,3}   &amp;         0        &amp;         0        &amp;                       0                     &amp;                     0                    &amp; \dots  &amp;                       0                     &amp; {\sigma_{ISB,f}^{S_o \rightarrow S_1}}^2 \\
  };
  \draw [dash dot] (-5.75,2.25) -- (5.75,2.25);
  \draw [dash dot] (-3.2,3.65) -- (-3.2,-3.65);

\end{tikzpicture}
\end{equation}" src="form_141.svg" width="1790" height="368"/>
</p>
<p><b> Van Loan algorithm </b></p>
<ol type="1">
<li>Form a <img class="formulaInl" alt="$ 2n \times 2n $" src="form_72.svg" width="60" height="14"/> matrix called <img class="formulaInl" alt="$ \mathbf{A} $" src="form_73.svg" width="16" height="14"/> ( <img class="formulaInl" alt="$ n $" src="form_74.svg" width="11" height="11"/> is the dimension of <img class="formulaInl" alt="$ \mathbf{x} $" src="form_75.svg" width="11" height="11"/> and <img class="formulaInl" alt="$ \mathbf{W} $" src="form_76.svg" width="21" height="14"/> is the power spectral density of the noise <img class="formulaInl" alt="$ W(t) $" src="form_77.svg" width="39" height="19"/>) <a class="anchor" id="ep-SppKF-processNoise-vanLoan-A"></a> <p class="formulaDsp">
<img class="formulaDsp" alt="\begin{equation} \label{eq:ep-SppKF-processNoise-vanLoan-A}
  \mathbf{A} = \begin{bmatrix} -\mathbf{F} &amp; \mathbf{G} \mathbf{W} \mathbf{G}^T \\
                                \mathbf{0} &amp;            \mathbf{F}^T          \end{bmatrix} \Delta t
\end{equation}" src="form_142.svg" width="1566" height="42"/>
</p>
</li>
<li>Calculate the exponential of <img class="formulaInl" alt="$ \mathbf{A} $" src="form_73.svg" width="16" height="14"/> <a class="anchor" id="eq-SppKF-processNoise-vanLoan-expA"></a> <p class="formulaDsp">
<img class="formulaDsp" alt="\begin{equation} \label{eq:eq-SppKF-processNoise-vanLoan-expA}
\mathbf{B} = \text{expm}(\mathbf{A})
= \left[ \begin{array}{c:c}
    \dots      &amp; \mathbf{\Phi}^{-1} \mathbf{Q} \\[2mm]
    \hdashline
    \mathbf{0} &amp; \mathbf{\Phi}^T
  \end{array} \right]
= \left[ \begin{array}{c:c}
    \mathbf{B}_{11} &amp; \mathbf{B}_{12} \\[2mm]
    \hdashline
    \mathbf{B}_{21} &amp; \mathbf{B}_{22}
  \end{array} \right]
\end{equation}" src="form_143.svg" width="1670" height="54"/>
</p>
</li>
<li>Calculate the state transition matrix <img class="formulaInl" alt="$ \mathbf{\Phi} $" src="form_80.svg" width="14" height="14"/> as <a class="anchor" id="eq-SppKF-processNoise-vanLoan-Phi"></a> <p class="formulaDsp">
<img class="formulaDsp" alt="\begin{equation} \label{eq:eq-SppKF-processNoise-vanLoan-Phi}
  \mathbf{\Phi} = \mathbf{B}_{22}^T
\end{equation}" src="form_144.svg" width="1505" height="21"/>
</p>
</li>
<li>Calculate the process noise covariance matrix <img class="formulaInl" alt="$ \mathbf{Q} $" src="form_82.svg" width="14" height="16"/> as <a class="anchor" id="eq-SppKF-processNoise-vanLoan-Q"></a> <p class="formulaDsp">
<img class="formulaDsp" alt="\begin{equation} \label{eq:eq-SppKF-processNoise-vanLoan-Q}
  \mathbf{Q} = \mathbf{\Phi} \mathbf{B}_{12}
\end{equation}" src="form_145.svg" width="1512" height="19"/>
</p>
</li>
</ol>
<p>Uses GUI input values for <img class="formulaInl" alt="$ S_{aH} $" src="form_135.svg" width="32" height="16"/>, <img class="formulaInl" alt="$ S_{cf} $" src="form_146.svg" width="25" height="18"/> and <img class="formulaInl" alt="$ S_{c\phi} $" src="form_147.svg" width="26" height="18"/>.</p>
<h3><a class="anchor" id="SppKF-processModel-processNoise-groves"></a>
Groves</h3>
<p><a class="anchor" id="eq-SppKF-processModel-processNoise-groves"></a> </p><p class="formulaDsp">
<img class="formulaDsp" alt="\begin{equation} \label{eq:eq-SppKF-processModel-processNoise-groves}
\mathbf{Q} =
\left[\begin{array}{cc:cc}
  \frac{1}{3} S_a^\gamma \tau_s^3 &amp; \frac{1}{2} S_a^\gamma \tau_s^2 &amp; 0_{3,1} &amp; 0_{3,1} \\
  \frac{1}{2} S_a^\gamma \tau_s^2 &amp; S_a^\gamma \tau_s &amp; 0_{3,1} &amp; 0_{3,1} \\
  \hdashline
  0_{1,3} &amp; 0_{1,3} &amp; S_{c \phi}^a \tau_s+\frac{1}{3} S_{c f}^a \tau_s^3 &amp; \frac{1}{2} S_{c f}^a \tau_s^2 \\
  0_{1,3} &amp; 0_{1,3} &amp; \frac{1}{2} S_{c f}^a \tau_s^2 &amp; S_{c f}^a \tau_s
  \end{array}\right]
\end{equation}" src="form_148.svg" width="1673" height="89"/>
</p>
<p>Uses calculated values for <img class="formulaInl" alt="$ S_{aH} $" src="form_135.svg" width="32" height="16"/>, <img class="formulaInl" alt="$ S_{cf} $" src="form_146.svg" width="25" height="18"/> and <img class="formulaInl" alt="$ S_{c\phi} $" src="form_147.svg" width="26" height="18"/>.</p>
<p>(<a class="el" href="citelist.html#CITEREF_Groves2013">[16]</a> Groves, ch. 9.4.2.2, eq. 9.152, p. 417-418)</p>
<p>The inter-system errors and drifts are assumed constant. Note: Groves does not estimate an inter-system drift (<a class="el" href="citelist.html#CITEREF_Groves2013">[16]</a> Groves, Appendix G.8, p. G-23 - G-24), but we do for all models.</p>
<h1><a class="anchor" id="SppKF-measurmentModel"></a>
Measurement Model</h1>
<h2><a class="anchor" id="SppKF-measurmentModel-innovation"></a>
Measurement innovation</h2>
<p>See <a class="el" href="group__SppBasics.html#SppBasics-measurementModel-innovation">Measurement innovation</a></p>
<h2><a class="anchor" id="SppKF-measurmentModel-sensitivityMatrix"></a>
Measurement sensitivity matrix</h2>
<p>See <a class="el" href="group__SppBasics.html#SppBasics-measurementModel-sensitivityMatrix">Design matrix / Measurement sensitivity matrix</a></p>
<p>In detail for Kalman Filtering <a class="anchor" id="eq-SppKF-measurementModel-sensitivityMatrix"></a> </p><p class="formulaDsp">
<img class="formulaDsp" alt="\begin{equation} \label{eq:eq-SppKF-measurementModel-sensitivityMatrix}
\begin{aligned}
\mathbf{H}_k
&amp;=
\left[\begin{array}{cccccccccc}
  \frac{-x^s+x_r}{\rho_s^s} &amp; \frac{-y^s+y_r}{\rho_s^s} &amp; \frac{-z^s+z_r}{\rho_r^s} &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 \\
  \frac{-x^s+x_r}{\rho_r^s} &amp; \frac{-y^s+y_r}{\rho_r^s} &amp; \frac{-z^s+z_r}{\rho_r^s} &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 1 &amp; 0 \\
  \ldots &amp; \ldots &amp; \ldots &amp; \ldots &amp; \ldots &amp; \ldots &amp; \ldots &amp; \ldots &amp; \ldots &amp; \ldots \\
  \hdashline
  -\frac{\mathbf{v}_x^s-\mathbf{v}_{r, x}}{\rho_r^s} &amp; -\frac{\mathbf{v}_y^s-\mathbf{v}_{r, y}}{\rho_r^s} &amp; -\frac{\mathbf{v}_z^s-\mathbf{v}_{r, z}}{\rho_r^s} &amp; -\frac{x^s-x_r}{\rho_r^s} &amp; -\frac{y^s-y_r}{\rho_r^s} &amp; -\frac{z^s-z_r}{\rho_r^s} &amp; 0 &amp; 1 &amp; 0 &amp; 0 \\
  -\frac{\mathbf{v}_x^s-\mathbf{v}_{r, x}^s}{\rho_r^s} &amp; -\frac{\mathbf{v}_y^s-\mathbf{v}_{r, y}^s}{\rho_r^s} &amp; -\frac{\mathbf{v}_z^s-\mathbf{v}_{r_r}^s}{\rho_r^s} &amp; -\frac{x^s-x_r}{\rho_r^s} &amp; -\frac{y^s-y_r}{\rho_r^s} &amp; -\frac{z^s-z_r}{\rho_r^s} &amp; 0 &amp; 1 &amp; 0 &amp; 1 \\
  \ldots &amp; \ldots &amp; \ldots &amp; \ldots &amp; \ldots &amp; \ldots &amp; \ldots &amp; \ldots &amp; \ldots &amp; \ldots
\end{array}\right] \\
&amp;=
\left[\begin{array}{cccccccccc}
  -u_{rs,x} &amp; -u_{rs,y} &amp; -u_{rs,z} &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 \\
  -u_{rs,x} &amp; -u_{rs,y} &amp; -u_{rs,z} &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 1 &amp; 0 \\
  \ldots &amp; \ldots &amp; \ldots &amp; \ldots &amp; \ldots &amp; \ldots &amp; \ldots &amp; \ldots &amp; \ldots &amp; \ldots \\
  \hdashline
  -\frac{\mathbf{v}_x^s-\mathbf{v}_{r, x}}{\rho_r^s} &amp; -\frac{\mathbf{v}_y^s-\mathbf{v}_{r, y}}{\rho_r^s} &amp; -\frac{\mathbf{v}_z^s-\mathbf{v}_{r, z}}{\rho_r^s} &amp; -u_{rs,x} &amp; -u_{rs,y} &amp; -u_{rs,z} &amp; 0 &amp; 1 &amp; 0 &amp; 0 \\
  -\frac{\mathbf{v}_x^s-\mathbf{v}_{r, x}^s}{\rho_r^s} &amp; -\frac{\mathbf{v}_y^s-\mathbf{v}_{r, y}^s}{\rho_r^s} &amp; -\frac{\mathbf{v}_z^s-\mathbf{v}_{r_r}^s}{\rho_r^s} &amp; -u_{rs,x} &amp; -u_{rs,y} &amp; -u_{rs,z} &amp; 0 &amp; 1 &amp; 0 &amp; 1 \\
  \ldots &amp; \ldots &amp; \ldots &amp; \ldots &amp; \ldots &amp; \ldots &amp; \ldots &amp; \ldots &amp; \ldots &amp; \ldots
\end{array}\right] \\
&amp;\approx
\left[\begin{array}{cccccccccc}
  -u_{rs,x} &amp; -u_{rs,y} &amp; -u_{rs,z} &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 \\
  -u_{rs,x} &amp; -u_{rs,y} &amp; -u_{rs,z} &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 1 &amp; 0 \\
  \ldots &amp; \ldots &amp; \ldots &amp; \ldots &amp; \ldots &amp; \ldots &amp; \ldots &amp; \ldots &amp; \ldots &amp; \ldots \\
  \hdashline
  0 &amp; 0 &amp; 0 &amp; -u_{rs,x} &amp; -u_{rs,y} &amp; -u_{rs,z} &amp; 0 &amp; 1 &amp; 0 &amp; 0 \\
  0 &amp; 0 &amp; 0 &amp; -u_{rs,x} &amp; -u_{rs,y} &amp; -u_{rs,z} &amp; 0 &amp; 1 &amp; 0 &amp; 1 \\
  \ldots &amp; \ldots &amp; \ldots &amp; \ldots &amp; \ldots &amp; \ldots &amp; \ldots &amp; \ldots &amp; \ldots &amp; \ldots
\end{array}\right]
\end{aligned}
\end{equation}" src="form_149.svg" width="1825" height="439"/>
</p>
<p>(<a class="el" href="citelist.html#CITEREF_Groves2013">[16]</a> Groves, ch. 9.4.2.2, eq. 9.163, p. 420)</p>
<h2><a class="anchor" id="SppKF-measurmentModel-measurementNoise"></a>
Measurement noise covariance matrix</h2>
<p>See <a class="el" href="MeasurementErrors_8hpp.html#GNSS-MeasErrorModel">GNSS-MeasErrorModel</a></p>
<h1><a class="anchor" id="SppKF-init"></a>
Initialization</h1>
<ul>
<li>State <img class="formulaInl" alt="$ x $" src="form_150.svg" width="11" height="11"/>: from Single Point Positioning solution using weighted Least-squares estimation</li>
<li>Covariance matrix of state <img class="formulaInl" alt="$ P $" src="form_151.svg" width="14" height="14"/>:<ul>
<li>if more observations than unknowns: SPP solution using LSE</li>
<li>otherwise: GUI input</li>
</ul>
</li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0 </li>
  </ul>
</div>
</body>
</html>
