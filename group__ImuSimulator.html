<!-- HTML header for doxygen 1.9.2-->
<!DOCTYPE html
    PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=11" />
    <meta name="generator" content="Doxygen 1.9.5" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>INSTINCT: IMU Simulator</title>
    <link href="tabs.css" rel="stylesheet" type="text/css" />
    <script type="text/javascript" src="jquery.js"></script>
    <script type="text/javascript" src="dynsections.js"></script>
    <link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
    <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
    <link href="doxygen.css" rel="stylesheet" type="text/css" />
    <link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
    <script type="text/javascript" src="eigen_navtree_hacks.js"></script>
</head>
<body>
        <div id="top">
            <!-- do not remove this div, it is closed by doxygen! -->
            <div id="titlearea">
                <table cellspacing="0" cellpadding="0">
                    <tbody>
                        <tr style="height: 56px;">
                            <td id="projectlogo"><img alt="Logo" src="INSTINCT_Logo_Text.png" /></td>
                            <td id="projectalign" style="padding-left: 0.5em;">
                                <div id="projectname">
                                    <!-- INSTINCT -->
                                    <span id="projectnumber">&#160;1.0.2</span>
                                </div>
                            </td>
                            <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('group__ImuSimulator.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">IMU Simulator<div class="ingroups"><a class="el" href="group__DataProvider__chapter.html">DataProvider</a> &raquo; <a class="el" href="group__DataProvider__Imu__chapter.html">Imu</a></div></div></div>
</div><!--header-->
<div class="contents">
<h1><a class="anchor" id="ImuSimulator-Acceleration-Measurements"></a>
Acceleration Measurements</h1>
<p >The navigation equation for a local-navigation frame is (see <a class="el" href="citelist.html#CITEREF_Titterton2004">[32]</a> Titterton, ch. 3.7.1, eq. 3.69, p. 47f) <a class="anchor" id="eq-ImuSimulator-VelocityNav-equation-pre"></a> </p><p class="formulaDsp">
<picture><source srcset="form_394_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-ImuSimulator-VelocityNav-equation-pre}
  \boldsymbol{\dot{v}}^n = \boldsymbol{f}^n - \underbrace{(2 \boldsymbol{\omega}_{ie}^n + \boldsymbol{\omega}_{en}^n) \times \boldsymbol{v}^n}_{\text{coriolis acceleration}} +\ \mathbf{g}_l^n
\end{equation}" src="form_394.svg" width="1607" height="44"/></picture>
</p>
<p> where</p><ul>
<li><picture><source srcset="form_126_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \boldsymbol{v}^n = \begin{pmatrix} v_N &amp; v_E &amp; v_D \end{pmatrix}^T $" src="form_126.svg" width="168" height="26"/></picture> is the velocity with respect to the Earth in local-navigation frame coordinates,</li>
<li><picture><source srcset="form_127_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \boldsymbol{f}^n = \begin{pmatrix} f_N &amp; f_E &amp; f_D \end{pmatrix}^T $" src="form_127.svg" width="170" height="26"/></picture> is the specific force vector as measured by a triad of accelerometers and resolved into local-navigation frame coordinates</li>
<li><picture><source srcset="form_128_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \boldsymbol{\omega}_{ie}^n $" src="form_128.svg" width="25" height="18"/></picture> is the turn rate of the Earth expressed in local-navigation frame coordinates</li>
<li><picture><source srcset="form_129_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \boldsymbol{\omega}_{en}^n $" src="form_129.svg" width="28" height="18"/></picture> is the turn rate of the local frame with respect to the Earth-fixed frame, called the transport rate, expressed in local-navigation frame coordinates</li>
<li><picture><source srcset="form_395_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \mathbf{g}_l^n $" src="form_395.svg" width="19" height="18"/></picture> is the local gravity vector which is a combination of (see <a class="el" href="citelist.html#CITEREF_Titterton2004">[32]</a> Titterton, ch. 3.71, eq. 3.75, p. 48)<ul>
<li><picture><source srcset="form_355_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \mathbf{g}^n $" src="form_355.svg" width="19" height="18"/></picture> the local gravitation vector (caused by effects of mass attraction)</li>
<li><picture><source srcset="form_396_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \boldsymbol{\omega}_{ie}^e \times [ \boldsymbol{\omega}_{ie}^e \times \mathbf{x}^e ] $" src="form_396.svg" width="121" height="19"/></picture> the centrifugal acceleration caused by the Earth's rotation</li>
</ul>
</li>
</ul>
<p >Therefore equation <a class="el" href="group__ImuSimulator.html#eq-ImuSimulator-VelocityNav-equation-pre"><picture><source srcset="form_397_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="\eqref{eq:eq-ImuSimulator-VelocityNav-equation-pre}" src="form_397.svg" width="44" height="19"/></picture> </a> becomes <a class="anchor" id="eq-ImuSimulator-VelocityNav-equation"></a> </p><p class="formulaDsp">
<picture><source srcset="form_398_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-ImuSimulator-VelocityNav-equation}
  \underbrace{\boldsymbol{\dot{v}}^n}_{\hidewidth\text{trajectory}\hidewidth}
      = \overbrace{\boldsymbol{f}^n}^{\hidewidth\text{measured}\hidewidth}
        -\ \underbrace{(2 \boldsymbol{\omega}_{ie}^n + \boldsymbol{\omega}_{en}^n) \times \boldsymbol{v}^n}_{\text{coriolis acceleration}}
        +\ \overbrace{\mathbf{g}^n}^{\hidewidth\text{gravitation}\hidewidth}
        -\ \mathbf{C}_e^n \cdot \underbrace{\left(\boldsymbol{\omega}_{ie}^e \times [ \boldsymbol{\omega}_{ie}^e \times \mathbf{x}^e ] \right)}_{\text{centrifugal acceleration}}
\end{equation}" src="form_398.svg" width="1741" height="70"/></picture>
</p>
<p >which can be reordered to calculate the measured accelerations with <a class="anchor" id="eq-ImuSimulator-acceleration-measured"></a> </p><p class="formulaDsp">
<picture><source srcset="form_399_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-ImuSimulator-acceleration-measured}
  \underbrace{\boldsymbol{f}^n}_{\hidewidth\text{measured}\hidewidth}
      = \overbrace{\boldsymbol{\dot{v}}^n}^{\hidewidth\text{trajectory}\hidewidth}
        + \underbrace{(2 \boldsymbol{\omega}_{ie}^n + \boldsymbol{\omega}_{en}^n) \times \boldsymbol{v}^n}_{\text{coriolis acceleration}}
        -\ \overbrace{\mathbf{g}^n}^{\hidewidth\text{gravitation}\hidewidth}
        +\ \mathbf{C}_e^n \cdot \underbrace{\left(\boldsymbol{\omega}_{ie}^e \times [ \boldsymbol{\omega}_{ie}^e \times \mathbf{x}^e ] \right)}_{\text{centrifugal acceleration}}
\end{equation}" src="form_399.svg" width="1736" height="70"/></picture>
</p>
<p >The acceleration from the trajectory is derived as</p>
<p ><a class="anchor" id="eq-ImuSimulator-acceleration-navigation"></a> </p><p class="formulaDsp">
<picture><source srcset="form_400_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-ImuSimulator-acceleration-navigation}
  \boldsymbol{\dot{v}}^n = \frac{\partial}{\partial t} \left( \boldsymbol{\dot{x}}^n \right) = \frac{\partial}{\partial t} \left( \boldsymbol{C}_e^n \cdot \boldsymbol{\dot{x}}^e \right) = \boldsymbol{\dot{C}}_e^n \cdot \boldsymbol{\dot{x}}^e + \boldsymbol{C}_e^n \cdot \boldsymbol{\ddot{x}}^e
\end{equation}" src="form_400.svg" width="1661" height="39"/></picture>
</p>
<p> with <a class="anchor" id="eq-ImuSimulator-acceleration-C_ne_dot"></a> </p><p class="formulaDsp">
<picture><source srcset="form_401_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-ImuSimulator-acceleration-C_ne_dot}
  \boldsymbol{\dot{C}}_e^n = (\boldsymbol{\dot{C}}_n^e)^T = (\boldsymbol{C}_n^e \cdot \boldsymbol{\Omega}_{en}^n)^T
\end{equation}" src="form_401.svg" width="1579" height="25"/></picture>
</p>
<h1><a class="anchor" id="ImuSimulator-AngularRate-Measurements"></a>
Angular Rate Measurements</h1>
<p >Gyroscopes measure the turn rate of the platform frame with respect to an inertial frame expressed in platform coordinates <a class="anchor" id="eq-ImuSimulator-GyroMeas"></a> </p><p class="formulaDsp">
<picture><source srcset="form_402_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-ImuSimulator-GyroMeas}
\begin{aligned}
  \boldsymbol{\omega}_{ip}^p &amp;= \boldsymbol{\omega}_{in}^p + \boldsymbol{\omega}_{np}^p \\
                             &amp;= \mathbf{C}_n^p \cdot [ \boldsymbol{\omega}_{in}^n + \boldsymbol{\omega}_{np}^n ] \\
                             &amp;= \mathbf{C}_n^p \cdot [ ( \boldsymbol{\omega}_{ie}^n + \boldsymbol{\omega}_{en}^n ) + ( \boldsymbol{\omega}_{nb}^n + \overbrace{\boldsymbol{\omega}_{bp}^n}^{= 0} ) ] \\
                             &amp;= \mathbf{C}_n^p \cdot [ \boldsymbol{\omega}_{ie}^n + \boldsymbol{\omega}_{en}^n + \boldsymbol{\omega}_{nb}^n ] \\
                             &amp;= \mathbf{C}_n^p \cdot [ \boldsymbol{\omega}_{ie}^n + \boldsymbol{\omega}_{en}^n + \mathbf{C}_b^n \boldsymbol{\omega}_{nb}^b ]
\end{aligned}
\end{equation}" src="form_402.svg" width="1624" height="158"/></picture>
</p>
<p >The turn rate of the body frame with respect to the local-navigation frame expressed in body coordinates depends on the time derivation of the gimbal angles <picture><source srcset="form_26_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \phi $" src="form_26.svg" width="11" height="18"/></picture> (roll), <picture><source srcset="form_403_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \theta $" src="form_403.svg" width="9" height="14"/></picture> (pitch), <picture><source srcset="form_404_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \psi $" src="form_404.svg" width="12" height="18"/></picture> (yaw): <a class="anchor" id="eq-ImuSimulator-omega_nb_b"></a> </p><p class="formulaDsp">
<picture><source srcset="form_405_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-ImuSimulator-omega_nb_b}
  \boldsymbol{\omega}_{nb}^b
      = \begin{bmatrix} \dotup{R} \\ 0 \\ 0 \end{bmatrix}
        + \mathbf{C_3} \begin{bmatrix} 0 \\ \dotup{P} \\ 0 \end{bmatrix}
        + \mathbf{C_3} \mathbf{C_2} \begin{bmatrix} 0 \\ 0 \\ \dotup{Y} \end{bmatrix}
\end{equation}" src="form_405.svg" width="1614" height="65"/></picture>
</p>
<p> where</p><ul>
<li><picture><source srcset="form_114_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \mathbf{C_3} = \begin{bmatrix} 1 &amp;     0    &amp;    0    \\
                                     0 &amp;  \cos{R} &amp; \sin{R} \\
                                     0 &amp; -\sin{R} &amp; \cos{R} \end{bmatrix} $" src="form_114.svg" width="201" height="63"/></picture> is the rotation <picture><source srcset="form_110_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ R $" src="form_110.svg" width="14" height="14"/></picture> about the x-axis (see <a class="el" href="citelist.html#CITEREF_Titterton2004">[32]</a> Titterton, ch. 3.6.3.2, eq. 3.46, p. 41)</li>
<li><picture><source srcset="form_115_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \mathbf{C_2} = \begin{bmatrix} \cos{P} &amp; 0 &amp; -\sin{P} \\
                                        0    &amp; 1 &amp;     0    \\
                                     \sin{P} &amp; 0 &amp;  \cos{P} \end{bmatrix} $" src="form_115.svg" width="203" height="63"/></picture> is the rotation <picture><source srcset="form_111_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ P $" src="form_111.svg" width="14" height="14"/></picture> about the y-axis (see <a class="el" href="citelist.html#CITEREF_Titterton2004">[32]</a> Titterton, ch. 3.6.3.2, eq. 3.45, p. 41)</li>
</ul>
<p >see</p><ul>
<li><a class="el" href="citelist.html#CITEREF_Titterton2004">[32]</a> Titterton, ch. 3.6.3.3, eq. 3.52, p. 42</li>
<li><a class="el" href="citelist.html#CITEREF_Gleason2009">[8]</a> Gleason, ch. 6.2.3.1, eq. 6.7, p. 153 (top left term in eq. 6.8 should be <picture><source srcset="form_118_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \cos{\theta} $" src="form_118.svg" width="35" height="14"/></picture> instead of <picture><source srcset="form_119_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ 1 $" src="form_119.svg" width="9" height="14"/></picture>)</li>
</ul>
<p >The time derivative of the gimbal angles are calculated via spline derivatives.</p>
<h1><a class="anchor" id="ImuSimulator-Trajectory"></a>
Trajectory calculation</h1>
<p >All trajectories are calculated with a cubic spline. The spline points are calculated by the position formulas below with a certain spacing and then the velocity and acceleration is derived from it.</p>
<h2><a class="anchor" id="ImuSimulator-Trajectory-Fixed"></a>
Fixed</h2>
<p >The fixed trajectory describes a geostationary position on Earth.</p>
<h4><a class="anchor" id="autotoc_md9"></a>
Position</h4>
<p ><a class="anchor" id="eq-ImuSimulator-Trajectory-Fixed-position"></a> </p><p class="formulaDsp">
<picture><source srcset="form_406_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-ImuSimulator-Trajectory-Fixed-position}
  \mathbf{x}^n = \begin{pmatrix} \phi &amp; \lambda &amp; h \end{pmatrix}^T = \text{const}
\end{equation}" src="form_406.svg" width="1572" height="26"/></picture>
</p>
<h4><a class="anchor" id="autotoc_md10"></a>
Velocity</h4>
<p ><a class="anchor" id="eq-ImuSimulator-Trajectory-Fixed-velocity"></a> </p><p class="formulaDsp">
<picture><source srcset="form_407_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-ImuSimulator-Trajectory-Fixed-velocity}
  \boldsymbol{v}^n = \mathbf{\dot{x}}^n = 0
\end{equation}" src="form_407.svg" width="1521" height="19"/></picture>
</p>
<h4><a class="anchor" id="autotoc_md11"></a>
Acceleration</h4>
<p ><a class="anchor" id="eq-ImuSimulator-Trajectory-Fixed-acceleration"></a> </p><p class="formulaDsp">
<picture><source srcset="form_408_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-ImuSimulator-Trajectory-Fixed-acceleration}
  \mathbf{a}^n = \boldsymbol{\dot{v}}^n = 0
\end{equation}" src="form_408.svg" width="1519" height="19"/></picture>
</p>
<h2><a class="anchor" id="ImuSimulator-Trajectory-Linear"></a>
Linear</h2>
<p >The linear trajectory describes a vehicle moving with constant velocity in local-navigation coordinates.</p>
<h4><a class="anchor" id="autotoc_md12"></a>
Position</h4>
<p >The time derivative of the curvilinear position (lat, lon, alt) is given by (<a class="el" href="citelist.html#CITEREF_Groves2013">[10]</a> Groves, ch. 2.4.2, eq. 2.111, p. 61 or <a class="el" href="citelist.html#CITEREF_Titterton2004">[32]</a> Titterton, ch. 3.7, eq. 3.81,3.85,3.86, p. 48ff)</p>
<p ><a class="anchor" id="eq-ImuSimulator-Trajectory-Linear-curvilinearPositionDerivative"></a> </p><p class="formulaDsp">
<picture><source srcset="form_409_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-ImuSimulator-Trajectory-Linear-curvilinearPositionDerivative}
\begin{aligned}
  \dotup{\phi}    &amp;= \frac{v_N}{R_N + h} \\
  \dotup{\lambda} &amp;= \frac{v_E}{(R_E + h) \cos{\phi}} \\
  \dotup{h}       &amp;= -v_D
\end{aligned}
\end{equation}" src="form_409.svg" width="1545" height="105"/></picture>
</p>
<p >As the velocity in local-navigation coordinates is constant and neglecting the change in non velocity terms, the position can be expressed as</p>
<p ><a class="anchor" id="eq-ImuSimulator-Trajectory-Linear-position"></a> </p><p class="formulaDsp">
<picture><source srcset="form_410_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-ImuSimulator-Trajectory-Linear-position}
  \renewcommand*{\arraystretch}{2.0}
  \mathbf{x}^n =
  \begin{pmatrix} \phi \\ \lambda \\ h \end{pmatrix}
  \approx \begin{pmatrix} \phi_0 \\ \lambda_0 \\ h_0 \end{pmatrix}
  + \begin{pmatrix} \dfrac{v_N}{R_N + h} \\ \dfrac{v_E}{(R_E + h) \cos{\phi}} \\  -v_D \end{pmatrix}
  \cdot t
\end{equation}" src="form_410.svg" width="1643" height="128"/></picture>
</p>
<h4><a class="anchor" id="autotoc_md13"></a>
Velocity</h4>
<p ><a class="anchor" id="eq-ImuSimulator-Trajectory-Linear-velocity"></a> </p><p class="formulaDsp">
<picture><source srcset="form_411_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-ImuSimulator-Trajectory-Linear-velocity}
\boldsymbol{v}^n = \mathbf{\dot{x}}^n = const
\end{equation}" src="form_411.svg" width="1537" height="19"/></picture>
</p>
<h4><a class="anchor" id="autotoc_md14"></a>
Acceleration</h4>
<p ><a class="anchor" id="eq-ImuSimulator-Trajectory-Linear-acceleration"></a> </p><p class="formulaDsp">
<picture><source srcset="form_412_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-ImuSimulator-Trajectory-Linear-acceleration}
  \mathbf{a}^n = \boldsymbol{\dot{v}}^n = 0
\end{equation}" src="form_412.svg" width="1519" height="19"/></picture>
</p>
<h2><a class="anchor" id="ImuSimulator-Trajectory-Circular"></a>
Circular</h2>
<p >The circular or helical trajectory describes a vehicle moving with constant horizontal speed on a circular shaped path. <a class="anchor" id="eq-ImuSimulator-Trajectory-Circular-horizontal-speed"></a> </p><p class="formulaDsp">
<picture><source srcset="form_413_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-ImuSimulator-Trajectory-Circular-horizontal-speed}
\begin{aligned}
  \left|\boldsymbol{v}_{\text{h}}^n\right| &amp;= \text{const}
\end{aligned}
\end{equation}" src="form_413.svg" width="1526" height="19"/></picture>
</p>
<p> The vertical velocity is</p><ul>
<li>for the circular trajectory: <picture><source srcset="form_414_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ v_D = 0 $" src="form_414.svg" width="53" height="16"/></picture></li>
<li>for the helical trajectory: <picture><source srcset="form_415_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ v_D = \text{const} $" src="form_415.svg" width="84" height="16"/></picture></li>
</ul>
<h4><a class="anchor" id="autotoc_md15"></a>
Position</h4>
<p >In the local-navigation frame in a tangential plane to the Earth surface a circular path can be expressed as</p>
<p ><a class="anchor" id="eq-ImuSimulator-Trajectory-Circular-local-position-phi"></a> </p><p class="formulaDsp">
<picture><source srcset="form_416_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-ImuSimulator-Trajectory-Circular-local-position-phi}
  \mathbf{x}^n = \begin{pmatrix} x_N \\ x_E \end{pmatrix}
               = \mathbf{x}_M^n
                 + \begin{pmatrix} r \cdot \sin{\left( \varphi \right)} \\
                                   r \cdot \cos{\left( \varphi \right)}
                   \end{pmatrix}
\end{equation}" src="form_416.svg" width="1603" height="42"/></picture>
</p>
<p> where <picture><source srcset="form_417_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ x_M $" src="form_417.svg" width="25" height="12"/></picture> is the center of the circle.</p>
<p >The vertical position is <picture><source srcset="form_418_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ x_D = x_{M,D} - v_{UP} \cdot t $" src="form_418.svg" width="158" height="18"/></picture>.</p>
<p >The variable <picture><source srcset="form_419_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \varphi $" src="form_419.svg" width="12" height="14"/></picture> can be expressed due to the constant speed <a class="anchor" id="eq-ImuSimulator-Trajectory-Circular-phi-tilde"></a> </p><p class="formulaDsp">
<picture><source srcset="form_420_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-ImuSimulator-Trajectory-Circular-phi-tilde}
  \left|\boldsymbol{v}_{\text{h}}^n\right| = \frac{s}{t}
                                = \left( \frac{\tilde{\varphi}}{2\pi} \cdot U \right) \frac{1}{t}
                                = \left( \frac{\tilde{\varphi}}{2\pi} \cdot 2\pi r \right) \frac{1}{t}
                                = \frac{\tilde{\varphi} \cdot r}{t}
\end{equation}" src="form_420.svg" width="1656" height="42"/></picture>
</p>
<p >Also a starting angle <picture><source srcset="form_421_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \varphi_0 $" src="form_421.svg" width="19" height="14"/></picture> and direction term <picture><source srcset="form_422_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \text{dir} $" src="form_422.svg" width="21" height="14"/></picture> (-1 for CW and +1 for CCW) are added. <a class="anchor" id="eq-ImuSimulator-Trajectory-Circular-phi"></a> </p><p class="formulaDsp">
<picture><source srcset="form_423_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-ImuSimulator-Trajectory-Circular-phi}
  \varphi = \frac{\left|\boldsymbol{v}_{\text{h}}^n\right| \cdot t}{r} \cdot \text{dir} + \varphi_0
\end{equation}" src="form_423.svg" width="1554" height="39"/></picture>
</p>
<p >As perfekt circular trajectories are hard for Navigation algorithms to estimate, due to the lack of dynamic elements, a harmonic modulation is added to the position, which leads to</p>
<p ><a class="anchor" id="eq-ImuSimulator-Trajectory-Circular-local-position"></a> </p><p class="formulaDsp">
<picture><source srcset="form_424_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-ImuSimulator-Trajectory-Circular-local-position}
\begin{aligned}
  \mathbf{x}^n = \begin{pmatrix} x_N \\ x_E \\ x_D\end{pmatrix}
  = \mathbf{x}_M^n
    + \begin{pmatrix} r \cdot \sin{\left( \varphi \right)} \cdot \left( 1 + a_h \cdot \sin{\left( \varphi \cdot \omega_h \right)} \right) \\
                      r \cdot \cos{\left( \varphi \right)} \cdot \left( 1 + a_h \cdot \sin{\left( \varphi \cdot \omega_h \right)} \right) \\
                      - v_{UP} \cdot t
      \end{pmatrix}
\end{aligned}
\end{equation}" src="form_424.svg" width="1692" height="63"/></picture>
</p>
<p> where <picture><source srcset="form_425_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ a_h $" src="form_425.svg" width="18" height="12"/></picture> is an amplitude factor which scales the harmonic oscillation in relation to the radius and <picture><source srcset="form_426_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \omega_h $" src="form_426.svg" width="19" height="12"/></picture> is the harmonic oscillation frequency in units [cycles/revolution]. Note that only unsigned integer values are allowed for <picture><source srcset="form_426_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \omega_h $" src="form_426.svg" width="19" height="12"/></picture>.</p>
<p >The local position can then be added to the start position after rotating it into the Earth frame</p>
<p ><a class="anchor" id="eq-ImuSimulator-Trajectory-Circular-position"></a> </p><p class="formulaDsp">
<picture><source srcset="form_427_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-ImuSimulator-Trajectory-Circular-position}
  \renewcommand*{\arraystretch}{2.0}
  \mathbf{x}^e = \mathbf{x}_M^e + \mathbf{C}_n^e(\mathbf{x}_M) \cdot \mathbf{x}^n
\end{equation}" src="form_427.svg" width="1565" height="19"/></picture>
</p>
<h4><a class="anchor" id="autotoc_md16"></a>
Velocity</h4>
<p >The velocity is the first derivative of the position spline.</p>
<h4><a class="anchor" id="autotoc_md17"></a>
Acceleration</h4>
<p >The acceleration is the second derivative of the position spline.</p>
<h1><a class="anchor" id="ImuSimulator-Flight-Angles"></a>
Flight angles</h1>
<h2><a class="anchor" id="ImuSimulator-Flight-Angles-Roll"></a>
Roll angle</h2>
<p >When not flying on constant height, which is the case for our circular trajectory, there is a certain roll angle. The following image should explain this. <a class="anchor" id="ImuSimulator-roll-image"></a> </p><p class="formulaDsp">
<picture><source srcset="form_428_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{tikzpicture}
  \def\ellipseB{10.0};
  \def\ellipseA{14.0};
  \coordinate (origin) at (0.0, 0.0);
  \draw[thick, black] (0,0) [partial ellipse=45:120:\ellipseA cm and \ellipseB cm];
  \node[left] at (-5.0, \ellipseB-0.5) {Earth surface};

  \draw[black,thick] (8.0,\ellipseB) -- (5.0,\ellipseB);
  \draw[black,thick] (-5.0,\ellipseB) -- (-8.0,\ellipseB);
  \draw[blue,ultra thick] (5.0,\ellipseB) -- (-5.0,\ellipseB) node[left,yshift=10pt] {Flight plane};

  \coordinate (xE) at (5.0,\ellipseB);
  \coordinate (xM) at (0,\ellipseB);

  \def\tangentLength{100};
  \path let \p1=(xE) in coordinate (t1) at (\x1 + \tangentLength pt, \y1 - \tangentLength * \ellipseB/\ellipseA * \ellipseB/\ellipseA * \x1/\y1);
  \path let \p1=(xE) in coordinate (t2) at (\x1 - \tangentLength pt, \y1 + \tangentLength * \ellipseB/\ellipseA * \ellipseB/\ellipseA * \x1/\y1);
  \draw[brown,thick] (t1) -- (t2);

  \def\tangentLength{10};
  \path let \p1=(xE) in coordinate (nE) at (\x1 + \tangentLength pt, \y1 + \tangentLength * \ellipseA/\ellipseB * \ellipseA/\ellipseB * \y1/\x1);
  \draw[-&gt;,brown,thick] (xE) -- (nE) node[above] {$\vec{\mathbf{n}}^e$};

  \pgfmathanglebetweenpoints{\pgfpointanchor{xE}{center}}{\pgfpointanchor{t1}{center}}
  \edef\angleRoll{\pgfmathresult}
  \def\angleRadius{2.5};
  \centerarc[black,thick,-&gt;](xE)(-(360-\angleRoll):0:\angleRadius);
  \node[left,xshift=-5pt,yshift=-7pt] at ($(xE)+(\angleRadius,0)$) {$R$};

  \def\rightAngleRadius{0.5};
  \centerarc[black,thick](xE)(90-(360-\angleRoll):180-(360-\angleRoll):\rightAngleRadius);
  \node[left,xshift=1pt,yshift=7pt] at (xE) {$\boldsymbol{\cdot}$};

  \coordinate (nM) at ($(xM)+(0,1.5)$);
  \draw[-&gt;,brown,thick] (xM) -- (nM) node[left] {$\vec{\mathbf{n}}^e_M$};
  \centerarc[black,thick](xM)(90:180:\rightAngleRadius);
  \node[left,xshift=-1pt,yshift=7pt] at (xM) {$\boldsymbol{\cdot}$};

  \node[draw,cross=5pt,red,thick] (xMC) at (xM) {};
  \node[draw,cross=5pt,red,thick] (xEC) at (xE) {};

  \path [draw,-&gt;,thick] ($($(origin)!.8!(xEC)$)$) -- (xEC) node [pos=0.38,left] {$\vec{\mathbf{x}}^e$};
  \path [draw, thick] ($($(origin)!.8!(xEC)$)$) --pic[rotate=-45]{ext} ($($(origin)!.8!(xEC)$)$);

  \path [draw,-&gt;,thick] ($($(origin)!.8!(xMC)$)$) -- (xMC) node [pos=0.5,right] {$\vec{\mathbf{x}}_M^e$};
  \path [draw, thick] ($($(origin)!.8!(xMC)$)$) --pic{ext} ($($(origin)!.8!(xMC)$)$);
\end{tikzpicture}" src="form_428.svg" width="891" height="235"/></picture>
</p>
<p >The simulated position is at the position <picture><source srcset="form_429_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\vec{x}^e$" src="form_429.svg" width="18" height="16"/></picture> and its velocity vector is facing out of the plane. When facing into the plane, the roll angle runs into the other direction resulting in a minus in the formula.</p>
<p >The roll angle is the angle between the tangential planes to the Earth surface in the current position and the center of the flight path. <a class="anchor" id="eq-ImuSimulator-roll-with-norm"></a> </p><p class="formulaDsp">
<picture><source srcset="form_430_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-ImuSimulator-roll-with-norm}
  R = \text{dir} \cdot \arccos{\left(\frac{\vec{\mathbf{n}}_M^e \cdot \vec{\mathbf{n}}^e}{\left|\vec{\mathbf{n}}_M^e\right| \cdot \left|\vec{\mathbf{n}}^e\right|}\right)}
\end{equation}" src="form_430.svg" width="1586" height="44"/></picture>
</p>
<p> where <picture><source srcset="form_422_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \text{dir} $" src="form_422.svg" width="21" height="14"/></picture> is a sign (+1 for CW and -1 for CCW) determining the direction of the circle.</p>
<p >The normal of the tangential planes is however not the position vectors <picture><source srcset="form_431_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\vec{\mathbf{x}}^e$" src="form_431.svg" width="18" height="16"/></picture> and <picture><source srcset="form_432_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\vec{\mathbf{x}}^e_M$" src="form_432.svg" width="25" height="19"/></picture>, because Earth is an ellipsoid, but can be calculated with the geodetic latitude and longitude as (see <a href="https://en.wikipedia.org/wiki/N-vector">Wikipedia n-vector</a> ) <a class="anchor" id="eq-ImuSimulator-n-vector"></a> </p><p class="formulaDsp">
<picture><source srcset="form_433_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-ImuSimulator-n-vector}
  \vec{\mathbf{n}}^e = \begin{pmatrix} \cos{\phi} \cdot \cos{\lambda} \\ \cos{\phi} \cdot \sin{\lambda} \\ \sin{\phi} \end{pmatrix}
\end{equation}" src="form_433.svg" width="1551" height="63"/></picture>
</p>
<p >Especially it can be seen, that this vector has length one <a class="anchor" id="eq-ImuSimulator-n-vector-norm"></a> </p><p class="formulaDsp">
<picture><source srcset="form_434_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-ImuSimulator-n-vector-norm}
\begin{aligned}
  \left|\vec{\mathbf{n}}^e\right| &amp;= \sqrt{ \cos^2{\phi} \cdot \cos^2{\lambda} + \cos^2{\phi} \cdot \sin^2{\lambda} + \sin^2{\phi} } \\
                                  &amp;= \sqrt{ \cos^2{\phi} \cdot \underbrace{( \cos^2{\lambda} + \sin^2{\lambda})}_{=1} + \sin^2{\phi} } \\
                                  &amp;= \sqrt{ \cos^2{\phi} + \sin^2{\phi} } \\
                                  &amp;= 1
\end{aligned}
\end{equation}" src="form_434.svg" width="1649" height="154"/></picture>
</p>
<p >The roll angle therefore becomes <a class="anchor" id="eq-ImuSimulator-roll"></a> </p><p class="formulaDsp">
<picture><source srcset="form_435_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-ImuSimulator-roll}
  R = \text{dir} \cdot \arccos{\left( \vec{\mathbf{n}}_M^e \cdot \vec{\mathbf{n}}^e \right)}
\end{equation}" src="form_435.svg" width="1568" height="19"/></picture>
</p>
<h2><a class="anchor" id="ImuSimulator-Flight-Angles-Pitch"></a>
Pitch angle</h2>
<p >The pitch angle is calculated with the local navigation frame velocity after formula <a class="el" href="INS_2Functions_8hpp.html#eq-INS-Mechanization-Pitch"><picture><source srcset="form_436_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="\eqref{eq:eq-INS-Mechanization-Pitch}" src="form_436.svg" width="33" height="19"/></picture> </a> <a class="anchor" id="eq-ImuSimulator-pitch"></a> </p><p class="formulaDsp">
<picture><source srcset="form_437_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-ImuSimulator-pitch}
  P = \tan^{-1}\left(\frac{-v_D}{\sqrt{v_N^2 + v_E^2}}\right)
\end{equation}" src="form_437.svg" width="1570" height="53"/></picture>
</p>
<h2><a class="anchor" id="ImuSimulator-Flight-Angles-Yaw"></a>
Yaw angle</h2>
<p >The yaw angle is calculated with the local navigation frame velocity after formula <a class="el" href="INS_2Functions_8hpp.html#eq-INS-Mechanization-Yaw"><picture><source srcset="form_438_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="\eqref{eq:eq-INS-Mechanization-Yaw}" src="form_438.svg" width="33" height="19"/></picture> </a> <a class="anchor" id="eq-ImuSimulator-yaw"></a> </p><p class="formulaDsp">
<picture><source srcset="form_439_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-ImuSimulator-yaw}
  Y = \tan^{-1}\left(\frac{v_E}{v_N}\right)
\end{equation}" src="form_439.svg" width="1540" height="42"/></picture>
</p>
 </div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.2-->
<!-- start footer part -->
<div id="nav-path" class="navpath">
    <!-- id is needed for treeview function! -->
    <ul>
        <li class="footer">Generated on Mon Jan 16 2023 09:36:14 for INSTINCT by <a href="https://www.doxygen.org/index.html"><img class="footer"
                    src="doxygen.svg" width="104" height="31" alt="doxygen" /></a> 1.9.5 </li>
    </ul>
</div>
</body>
</html>
