<!-- HTML header for doxygen 1.9.2-->
<!DOCTYPE html
    PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=11" />
    <meta name="generator" content="Doxygen 1.9.6" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>INSTINCT: INS/GNSS Loosely-coupled Kalman Filter (local-navigation frame)</title>
    <link href="tabs.css" rel="stylesheet" type="text/css" />
    <script type="text/javascript" src="jquery.js"></script>
    <script type="text/javascript" src="dynsections.js"></script>
    <link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
    <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
    <link href="doxygen.css" rel="stylesheet" type="text/css" />
    <link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
    <script type="text/javascript" src="eigen_navtree_hacks.js"></script>
</head>
<body>
        <div id="top">
            <!-- do not remove this div, it is closed by doxygen! -->
            <div id="titlearea">
                <table cellspacing="0" cellpadding="0">
                    <tbody>
                        <tr style="height: 56px;">
                            <td id="projectlogo"><img alt="Logo" src="INSTINCT_Logo_Text.png" /></td>
                            <td id="projectalign" style="padding-left: 0.5em;">
                                <div id="projectname">
                                    <!-- INSTINCT -->
                                    <span id="projectnumber">&#160;1.0.2</span>
                                </div>
                            </td>
                            <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('group__LooselyCoupledKF__n.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">INS/GNSS Loosely-coupled Kalman Filter (local-navigation frame)<div class="ingroups"><a class="el" href="group__DataProcessor__chapter.html">DataProcessor</a> &raquo; <a class="el" href="group__DataProcessor__KalmanFilter__chapter.html">KalmanFilter</a></div></div></div>
</div><!--header-->
<div class="contents">
<h1><a class="anchor" id="LooselyCoupledKF_n-ErrorStateEquations-LocalLevelFrame"></a>
Local-Level Frame Error State Equations</h1>
<h2><a class="anchor" id="LooselyCoupledKF_n-ErrorStateEquations-LocalLevelFrame-ShortForm"></a>
Short form</h2>
<p><a class="anchor" id="eq-LCKF_n-stateMatrix-short"></a> </p><p class="formulaDsp">
<picture><source srcset="form_250_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-LCKF_n-stateMatrix-short}
  \begin{tikzpicture}[baseline=-\the\dimexpr\fontdimen22\textfont2\relax,decoration=brace]
    \matrix (m)[matrix of math nodes,left delimiter={(},right delimiter={)},nodes={rectangle,text width=1.8em,align=center},row sep=0.3em, column sep=0.4em] {
      \boldsymbol{\delta \dot{\psi}} \\
      \boldsymbol{\delta \dot{v}}^{n} \\
      \boldsymbol{\delta \dot{p}}_b \\
      \boldsymbol{\delta \dot{f}}^{\raise-0.45ex\hbox{$\scriptstyle b$}} \\
      \boldsymbol{\delta \dot{\omega}}_{ib}^b \\
    };
    \draw[decorate,transform canvas={yshift=.5em},thick] (m-1-1.north west) -- node[above=2pt] {$\boldsymbol{\delta} \mathbf{\dot{x}}$} (m-1-1.north east);

    \begin{pgfonlayer}{background}
      \fhighlight[green!20]{m-1-1}{m-1-1}
      \fhighlight[blue!20]{m-2-1}{m-2-1}
      \fhighlight[cyan!20]{m-3-1}{m-3-1}
      \fhighlight[red!20]{m-4-1}{m-4-1}
      \fhighlight[orange!20]{m-5-1}{m-5-1}
    \end{pgfonlayer}
  \end{tikzpicture}
  =
  \begin{tikzpicture}[baseline=-\the\dimexpr\fontdimen22\textfont2\relax,decoration=brace]
    \matrix (m)[matrix of math nodes,left delimiter={(},right delimiter={)},
                nodes={rectangle,text width=2.5em,align=center},row sep=0.3em, column sep=0.4em]
    {
      \mathbf{F}_{\delta \dotup{\psi},\delta \psi}^n &amp; \mathbf{F}_{\delta \dotup{\psi},\delta v}^n &amp; \mathbf{F}_{\delta \dotup{\psi},\delta r}^n &amp; \mathbf{0}_3   &amp; \mathbf{C}_b^n \\
      \mathbf{F}_{\delta \dotup{v},\delta \psi}^n    &amp; \mathbf{F}_{\delta \dotup{v},\delta v}^n    &amp; \mathbf{F}_{\delta \dotup{v},\delta r}^n    &amp; \mathbf{C}_b^n &amp; \mathbf{0}_3   \\
      \mathbf{0}_3                                   &amp; \mathbf{F}_{\delta \dotup{r},\delta v}^n    &amp; \mathbf{F}_{\delta \dotup{r},\delta r}^n    &amp; \mathbf{0}_3   &amp; \mathbf{0}_3   \\
      \mathbf{0}_3                                   &amp; \mathbf{0}_3                                &amp; \mathbf{0}_3                                &amp; \mathbf{0}_3   &amp; \mathbf{0}_3   \\
      \mathbf{0}_3                                   &amp; \mathbf{0}_3                                &amp; \mathbf{0}_3                                &amp; \mathbf{0}_3   &amp; \mathbf{0}_3   \\
    };
    \draw[decorate,transform canvas={yshift=.5em},thick] (m-1-1.north west) -- node[above=2pt] {$\mathbf{F}$} (m-1-5.north east);

    \begin{pgfonlayer}{background}
      \fhighlight[green!20]{m-1-1}{m-1-1}
      \fhighlight[yellow!20]{m-1-2}{m-1-2}
      \fhighlight[lime!20]{m-1-3}{m-1-3}
      \fhighlight[orange!20]{m-1-5}{m-1-5}
      \fhighlight[purple!20]{m-2-1}{m-2-1}
      \fhighlight[blue!20]{m-2-2}{m-2-2}
      \fhighlight[violet!20]{m-2-3}{m-2-3}
      \fhighlight[red!20]{m-2-4}{m-2-4}
      \fhighlight[teal!20]{m-3-2}{m-3-2}
      \fhighlight[cyan!20]{m-3-3}{m-3-3}
    \end{pgfonlayer}
  \end{tikzpicture}
  \cdot
  \begin{tikzpicture}[baseline=-\the\dimexpr\fontdimen22\textfont2\relax,decoration=brace]
    \matrix (m)[matrix of math nodes,left delimiter={(},right delimiter={)},
                nodes={rectangle,text width=1.8em,align=center},row sep=0.3em, column sep=0.4em] {
      \boldsymbol{\delta \psi} \\
      \boldsymbol{\delta v}^{n} \\
      \boldsymbol{\delta p}_b \\
      \boldsymbol{\delta f}^b \\
      \boldsymbol{\delta \omega}_{ib}^b \\
    };
    \draw[decorate,transform canvas={yshift=.5em},thick] (m-1-1.north west) -- node[above=2pt] {$\boldsymbol{\delta} \mathbf{x}$} (m-1-1.north east);

    \begin{pgfonlayer}{background}
      \fhighlight[green!20]{m-1-1}{m-1-1}
      \fhighlight[blue!20]{m-2-1}{m-2-1}
      \fhighlight[cyan!20]{m-3-1}{m-3-1}
      \fhighlight[red!20]{m-4-1}{m-4-1}
      \fhighlight[orange!20]{m-5-1}{m-5-1}
    \end{pgfonlayer}
  \end{tikzpicture}
\end{equation}" src="form_250.svg" width="1752" height="207"/></picture>
</p>
<h2><a class="anchor" id="LooselyCoupledKF_n-ErrorStateEquations-LocalLevelFrame-DetailledForm"></a>
Detailled form</h2>
<p><a class="anchor" id="eq-LCKF_n-stateMatrix"></a> </p><p class="formulaDsp">
<picture><source srcset="form_251_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-LCKF_n-stateMatrix}
  \begin{tikzpicture}[baseline=-\the\dimexpr\fontdimen22\textfont2\relax,decoration=brace]
    \matrix (m)[matrix of math nodes,left delimiter={(},right delimiter={)},
                nodes={rectangle,text width=1.5em,align=center,minimum height=2.3em,anchor=center},row sep=0.3em, column sep=0.4em,] {
      \delta \dotup{R}              \\ \delta \dotup{P}              \\ \delta \dotup{Y}              \\
      \delta \dotup{v}_{N}          \\ \delta \dotup{v}_{E}          \\ \delta \dotup{v}_{D}          \\
      \delta \dotup{\phi}           \\ \delta \dotup{\lambda}        \\ \delta \dotup{h}              \\
      \delta \dotup{f}_{x}^{b}      \\ \delta \dotup{f}_{y}^{b}      \\ \delta \dotup{f}_{z}^{b}      \\
      \delta \dotup{\omega}_{x}^{b} \\ \delta \dotup{\omega}_{y}^{b} \\ \delta \dotup{\omega}_{z}^{b} \\
    };
    \draw[decorate,transform canvas={yshift=.5em},thick] (m-1-1.north west) -- node[above=2pt] {$\boldsymbol{\delta} \mathbf{\dot{x}}$} (m-1-1.north east);

    \begin{pgfonlayer}{background}
      \fhighlight[green!20]{m-1-1}{m-3-1}
      \fhighlight[blue!20]{m-4-1}{m-6-1}
      \fhighlight[cyan!20]{m-7-1}{m-9-1}
      \fhighlight[red!20]{m-10-1}{m-12-1}
      \fhighlight[orange!20]{m-13-1}{m-15-1}
    \end{pgfonlayer}
  \end{tikzpicture}
  =
  \begin{tikzpicture}[baseline=-\the\dimexpr\fontdimen22\textfont2\relax,decoration=brace]
    \matrix (m)[matrix of math nodes,left delimiter={(},right delimiter={)},nodes in empty cells,
                row sep=0.3em, column sep=0.4em,
                nodes={rectangle,minimum height=2.3em,anchor=center},] {
               0         &amp;  \omega_{in,3}^{n} &amp; -\omega_{in,2}^{n} &amp;                             0                            &amp;                    -\frac{1}{R_E + h}                     &amp;                       0                      &amp;                                    \omega_{ie}\sin{\phi}                                    &amp;      0       &amp;                             \frac{v_E}{(R_E + h)^2}                            &amp;  &amp;                &amp;  &amp;  &amp;                &amp; \\
      -\omega_{in,3}^{n} &amp;          0         &amp;  \omega_{in,1}^{n} &amp;                    \frac{1}{R_N + h}                     &amp;                             0                             &amp;                       0                      &amp;                                             0                                               &amp;      0       &amp;                            -\frac{v_N}{(R_N + h)^2}                            &amp;  &amp;  \mathbf{0}_3  &amp;  &amp;  &amp; \mathbf{C}_b^n &amp; \\
       \omega_{in,2}^{n} &amp; -\omega_{in,1}^{n} &amp;          0         &amp;                             0                            &amp;                 \frac{\tan{\phi}}{R_E + h}                &amp;                       0                      &amp;                  \omega_{ie}\cos{\phi} + \frac{v_E}{(R_E + h)\cos^2{\phi}}                  &amp;      0       &amp;                       -\frac{v_E \tan{\phi}}{(R_E + h)^2}                      &amp;  &amp;                &amp;  &amp;  &amp;                &amp; \\
               0         &amp;         f_D        &amp;        -f_E        &amp;                    \frac{v_D}{R_N + h}                   &amp; -2\frac{v_E \tan{\phi}}{R_E + h} - 2\omega_{ie}\sin{\phi} &amp;              \frac{v_N}{R_N + h}             &amp;                -\frac{v_E^2}{(R_E+h)\cos^2{\phi}}-2v_E\omega_{ie}\cos{\phi}                 &amp;      0       &amp;          \frac{v_E^2\tan{\phi}}{(R_E+h)^2} - \frac{v_Nv_D}{(R_N+h)^2}          &amp;  &amp;                &amp;  &amp;  &amp;                &amp; \\
             -f_D        &amp;          0         &amp;         f_N        &amp;  \frac{v_E \tan{\phi}}{R_E + h} + 2\omega_{ie}\sin{\phi} &amp;            \frac{v_N \tan{\phi} + v_D}{R_E + h}           &amp; \frac{v_E}{R_E + h} + 2\omega_{ie}\cos{\phi} &amp; \frac{v_N v_E}{(R_E+h)\cos^2{\phi}} + 2v_N\omega_{ie}\cos{\phi} - 2v_D\omega_{ie}\sin{\phi} &amp;      0       &amp;                 -\frac{v_Nv_E\tan{\phi} + v_Ev_D}{(R_E + h)^2}                 &amp;  &amp; \mathbf{C}_b^n &amp;  &amp;  &amp;  \mathbf{0}_3  &amp; \\
              f_E        &amp;        -f_N        &amp;          0         &amp;                  -\frac{2v_N}{R_N + h}                   &amp;       -\frac{2v_E}{R_E + h} - 2\omega_{ie}\cos{\phi}      &amp;                       0                      &amp;                                  2v_E\omega_{ie}\sin{\phi}                                  &amp;      0       &amp; \frac{v_E^2}{(R_E + h)^2} + \frac{v_N^2}{(R_N + h)^2} - \frac{2 g_0}{r_{eS}^e} &amp;  &amp;                &amp;  &amp;  &amp;                &amp; \\
                         &amp;                    &amp;                    &amp;                      \frac{1}{R_N+h}                     &amp;                             0                             &amp;                       0                      &amp;                                             0                                               &amp;      0       &amp;                            -\frac{v_N}{(R_N + h)^2}                            &amp;  &amp;                &amp;  &amp;  &amp;                &amp; \\
                         &amp;    \mathbf{0}_3    &amp;                    &amp;                             0                            &amp;                \frac{1}{(R_E+h)\cos{\phi}}                &amp;                       0                      &amp;                           \frac{v_E\tan{\phi}}{(R_E+h)\cos{\phi}}                           &amp;      0       &amp;                       -\frac{v_E}{(R_E + h)^2\cos{\phi}}                       &amp;  &amp;  \mathbf{0}_3  &amp;  &amp;  &amp;  \mathbf{0}_3  &amp; \\
                         &amp;                    &amp;                    &amp;                             0                            &amp;                             0                             &amp;                      -1                      &amp;                                             0                                               &amp;      0       &amp;                                        0                                       &amp;  &amp;                &amp;  &amp;  &amp;                &amp; \\
                         &amp;                    &amp;                    &amp;                                                          &amp;                                                           &amp;                                              &amp;                                                                                             &amp;              &amp;                                                                                &amp;  &amp;                &amp;  &amp;  &amp;                &amp; \\
                         &amp;    \mathbf{0}_3    &amp;                    &amp;                                                          &amp;                       \mathbf{0}_3                        &amp;                                              &amp;                                                                                             &amp; \mathbf{0}_3 &amp;                                                                                &amp;  &amp;  \mathbf{0}_3  &amp;  &amp;  &amp;  \mathbf{0}_3  &amp; \\
                         &amp;                    &amp;                    &amp;                                                          &amp;                                                           &amp;                                              &amp;                                                                                             &amp;              &amp;                                                                                &amp;  &amp;                &amp;  &amp;  &amp;                &amp; \\
                         &amp;                    &amp;                    &amp;                                                          &amp;                                                           &amp;                                              &amp;                                                                                             &amp;              &amp;                                                                                &amp;  &amp;                &amp;  &amp;  &amp;                &amp; \\
                         &amp;    \mathbf{0}_3    &amp;                    &amp;                                                          &amp;                       \mathbf{0}_3                        &amp;                                              &amp;                                                                                             &amp; \mathbf{0}_3 &amp;                                                                                &amp;  &amp;  \mathbf{0}_3  &amp;  &amp;  &amp;  \mathbf{0}_3  &amp; \\
                         &amp;                    &amp;                    &amp;                                                          &amp;                                                           &amp;                                              &amp;                                                                                             &amp;              &amp;                                                                                &amp;  &amp;                &amp;  &amp;  &amp;                &amp; \\
    };

    \foreach \r in {1,3,4,6,7,9} {
      \foreach \c in {1,3,4,6,7,9,10,12,13,15} {
        \coordinate (m-\r-\c-nw) at (100,-100);
        \coordinate (m-\r-\c-se) at (-100,100);

        \foreach \row in {1,...,9} {
          \path let \p1=(m-\row-\c.west), \p2=(m-\r-\c-nw) in coordinate (m-\r-\c-nw) at ({min(\x1,\x2)},\y2);
          \path let \p1=(m-\row-\c.east), \p2=(m-\r-\c-se) in coordinate (m-\r-\c-se) at ({max(\x1,\x2)},\y2);
        }
        \foreach \col in {1,...,15} {
          \path let \p1=(m-\r-\col.north), \p2=(m-\r-\c-nw) in coordinate (m-\r-\c-nw) at (\x2,{max(\y1,\y2)});
          \path let \p1=(m-\r-\col.south), \p2=(m-\r-\c-se) in coordinate (m-\r-\c-se) at (\x2,{min(\y1,\y2)});
        }
      }
    }

    \path let \p1=(m-1-1-nw), \p2=(m-1-15-se) in coordinate (m-1-15-ne) at (\x2,\y1);
    \draw[decorate,transform canvas={yshift=.5em},thick] (m-1-1-nw) -- node[above=2pt] {$\mathbf{F}$} (m-1-15-ne);

    \begin{pgfonlayer}{background}
      \fhighlight[green!20]{m-1-1-nw}{m-3-3-se}
      \fhighlight[yellow!20]{m-1-4-nw}{m-3-6-se}
      \fhighlight[lime!20]{m-1-7-nw}{m-3-9-se}
      \fhighlight[orange!20]{m-1-13-nw}{m-3-15-se}
      \fhighlight[purple!20]{m-4-1-nw}{m-6-3-se}
      \fhighlight[blue!20]{m-4-4-nw}{m-6-6-se}
      \fhighlight[violet!20]{m-4-7-nw}{m-6-9-se}
      \fhighlight[red!20]{m-4-10-nw}{m-6-12-se}
      \fhighlight[teal!20]{m-7-4-nw}{m-9-6-se}
      \fhighlight[cyan!20]{m-7-7-nw}{m-9-9-se}
    \end{pgfonlayer}
  \end{tikzpicture}
  \cdot
  \begin{tikzpicture}[baseline=-\the\dimexpr\fontdimen22\textfont2\relax,decoration=brace]
    \matrix (m)[matrix of math nodes,left delimiter={(},right delimiter={)},row sep=0.3em, column sep=0.4em,
                nodes={rectangle,text width=1.5em,align=center,minimum height=2.3em,anchor=center},] {
      \delta R              \\ \delta P              \\ \delta Y              \\
      \delta v_{N}          \\ \delta v_{E}          \\ \delta v_{D}          \\
      \delta \phi           \\ \delta \lambda        \\ \delta h              \\
      \delta f_{x}^{b}      \\ \delta f_{y}^{b}      \\ \delta f_{z}^{b}      \\
      \delta \omega_{x}^{b} \\ \delta \omega_{y}^{b} \\ \delta \omega_{z}^{b} \\
    };
    \draw[decorate,transform canvas={yshift=.5em},thick] (m-1-1.north west) -- node[above=2pt] {$\boldsymbol{\delta} \mathbf{x}$} (m-1-1.north east);

    \begin{pgfonlayer}{background}
      \fhighlight[green!20]{m-1-1}{m-3-1}
      \fhighlight[blue!20]{m-4-1}{m-6-1}
      \fhighlight[cyan!20]{m-7-1}{m-9-1}
      \fhighlight[red!20]{m-10-1}{m-12-1}
      \fhighlight[orange!20]{m-13-1}{m-15-1}
    \end{pgfonlayer}
  \end{tikzpicture}
\end{equation}" src="form_251.svg" width="2319" height="716"/></picture>
</p>
<p>This form corresponds to</p><ul>
<li><a class="el" href="citelist.html#CITEREF_Groves2013">[10]</a> Groves, ch. 14.2.4, eq. 14.63, p. 587ff</li>
</ul>
<p>The following sources can be taken as reference, but have at least one deviation from the form presented here</p><ul>
<li><a class="el" href="citelist.html#CITEREF_Titterton2004">[32]</a> Titterton, ch. 12.3.1.3, eq. 12.28, p. 345<ul>
<li>Different <em>sign</em> in equations <picture><source srcset="form_252_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \highlight[yellow!20]{\mathbf{F}_{\delta \dotup{\psi},\delta v}^n} $" src="form_252.svg" width="61" height="33"/></picture>, <picture><source srcset="form_253_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \highlight[lime!20]{\mathbf{F}_{\delta \dotup{\psi},\delta r}^n} $" src="form_253.svg" width="61" height="33"/></picture>, <picture><source srcset="form_254_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \highlight[orange!20]{\mathbf{F}_{\delta \dotup{\psi},\delta \omega}^n} $" src="form_254.svg" width="63" height="33"/></picture>, <picture><source srcset="form_255_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \highlight[purple!20]{\mathbf{F}_{\delta \dotup{v},\delta \psi}^n} $" src="form_255.svg" width="61" height="32"/></picture></li>
</ul>
</li>
<li><a class="el" href="citelist.html#CITEREF_Noureldin2013">[21]</a> Noureldin, ch. 6.1.5, eq. 6.76, p. 219<ul>
<li>ENU-System</li>
<li>Yaw defined counterclockwise</li>
<li>Different <em>sign</em> for the DCM term</li>
</ul>
</li>
</ul>
<p>However in section <a class="el" href="group__LooselyCoupledKF__n.html#LooselyCoupledKF_n-Appendix-ErrorStateEquations-LocalLevelFrame-Comparison">Error Equations comparison</a> it is shown, that they can be transformed into each other.</p>
<h1><a class="anchor" id="LooselyCoupledKF_n-Noise"></a>
Augmented State with Noise</h1>
<p>The continuous linear dynamic system can be expressed as <a class="anchor" id="eq-LCKF_n-dynamicModel"></a> </p><p class="formulaDsp">
<picture><source srcset="form_256_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-LCKF_n-dynamicModel}
  \boldsymbol{\delta} \mathbf{\dot{x}} = \mathbf{F} \cdot \boldsymbol{\delta} \mathbf{x} + \mathbf{G} \cdot \mathbf{w}
\end{equation}" src="form_256.svg" width="1549" height="19"/></picture>
</p>
<p>Process noise is introduced into the <picture><source srcset="form_150_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \mathbf{F} $" src="form_150.svg" width="12" height="14"/></picture> and <picture><source srcset="form_151_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \mathbf{G} $" src="form_151.svg" width="16" height="14"/></picture> matrices in the accelerometer and gyroscope bias terms. Therefore the error equations can be extended as follows</p>
<p><a class="anchor" id="eq-LCKF_n-dynamicModel-short"></a> </p><p class="formulaDsp">
<picture><source srcset="form_257_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-LCKF_n-dynamicModel-short}
  \begin{tikzpicture}[baseline=-\the\dimexpr\fontdimen22\textfont2\relax,decoration=brace]
    \matrix (m)[matrix of math nodes,left delimiter={(},right delimiter={)},nodes={rectangle,text width=1.8em,align=center},row sep=0.3em, column sep=0.4em] {
      \boldsymbol{\delta \dot{\psi}} \\
      \boldsymbol{\delta \dot{v}}^{n} \\
      \boldsymbol{\delta \dot{p}}_b \\
      \boldsymbol{\delta \dot{f}}^{\raise-0.45ex\hbox{$\scriptstyle b$}} \\
      \boldsymbol{\delta \dot{\omega}}_{ib}^b \\
    };
    \draw[decorate,transform canvas={yshift=.5em},thick] (m-1-1.north west) -- node[above=2pt] {$\boldsymbol{\delta} \mathbf{\dot{x}}$} (m-1-1.north east);

    \begin{pgfonlayer}{background}
      \fhighlight[green!20]{m-1-1}{m-1-1}
      \fhighlight[blue!20]{m-2-1}{m-2-1}
      \fhighlight[cyan!20]{m-3-1}{m-3-1}
      \fhighlight[red!20]{m-4-1}{m-4-1}
      \fhighlight[orange!20]{m-5-1}{m-5-1}
    \end{pgfonlayer}
  \end{tikzpicture}
  =
  \begin{tikzpicture}[baseline=-\the\dimexpr\fontdimen22\textfont2\relax,decoration=brace]
    \matrix (m)[matrix of math nodes,left delimiter={(},right delimiter={)},
                nodes={rectangle,text width=2.5em,align=center},row sep=0.3em, column sep=0.4em]
    {
      \mathbf{F}_{\delta \dotup{\psi},\delta \psi}^n &amp; \mathbf{F}_{\delta \dotup{\psi},\delta v}^n &amp; \mathbf{F}_{\delta \dotup{\psi},\delta r}^n &amp;    \mathbf{0}_3      &amp;       \mathbf{C}_b^n      \\
      \mathbf{F}_{\delta \dotup{v},\delta \psi}^n    &amp; \mathbf{F}_{\delta \dotup{v},\delta v}^n    &amp; \mathbf{F}_{\delta \dotup{v},\delta r}^n    &amp;    \mathbf{C}_b^n    &amp;       \mathbf{0}_3        \\
      \mathbf{0}_3                                   &amp; \mathbf{F}_{\delta \dotup{r},\delta v}^n    &amp; \mathbf{F}_{\delta \dotup{r},\delta r}^n    &amp;    \mathbf{0}_3      &amp;       \mathbf{0}_3        \\
      \mathbf{0}_3                                   &amp; \mathbf{0}_3                                &amp; \mathbf{0}_3                                &amp; \boldsymbol{\beta}_f &amp;       \mathbf{0}_3        \\
      \mathbf{0}_3                                   &amp; \mathbf{0}_3                                &amp; \mathbf{0}_3                                &amp;    \mathbf{0}_3      &amp; \boldsymbol{\beta}_\omega \\
    };
    \draw[decorate,transform canvas={yshift=.5em},thick] (m-1-1.north west) -- node[above=2pt] {$\mathbf{F}$} (m-1-5.north east);

    \begin{pgfonlayer}{background}
      \fhighlight[green!20]{m-1-1}{m-1-1}
      \fhighlight[yellow!20]{m-1-2}{m-1-2}
      \fhighlight[lime!20]{m-1-3}{m-1-3}
      \fhighlight[orange!20]{m-1-5}{m-1-5}
      \fhighlight[purple!20]{m-2-1}{m-2-1}
      \fhighlight[blue!20]{m-2-2}{m-2-2}
      \fhighlight[violet!20]{m-2-3}{m-2-3}
      \fhighlight[red!20]{m-2-4}{m-2-4}
      \fhighlight[teal!20]{m-3-2}{m-3-2}
      \fhighlight[cyan!20]{m-3-3}{m-3-3}
      \fhighlight[magenta!20]{m-4-4}{m-4-4}
      \fhighlight[olive!20]{m-5-5}{m-5-5}
    \end{pgfonlayer}
  \end{tikzpicture}
  \cdot
  \begin{tikzpicture}[baseline=-\the\dimexpr\fontdimen22\textfont2\relax,decoration=brace]
    \matrix (m)[matrix of math nodes,left delimiter={(},right delimiter={)},
                nodes={rectangle,text width=1.8em,align=center},row sep=0.3em, column sep=0.4em] {
      \boldsymbol{\delta \psi} \\
      \boldsymbol{\delta v}^{n} \\
      \boldsymbol{\delta p}_b \\
      \boldsymbol{\delta f}^b \\
      \boldsymbol{\delta \omega}_{ib}^b \\
    };
    \draw[decorate,transform canvas={yshift=.5em},thick] (m-1-1.north west) -- node[above=2pt] {$\boldsymbol{\delta} \mathbf{x}$} (m-1-1.north east);

    \begin{pgfonlayer}{background}
      \fhighlight[green!20]{m-1-1}{m-1-1}
      \fhighlight[blue!20]{m-2-1}{m-2-1}
      \fhighlight[cyan!20]{m-3-1}{m-3-1}
      \fhighlight[red!20]{m-4-1}{m-4-1}
      \fhighlight[orange!20]{m-5-1}{m-5-1}
    \end{pgfonlayer}
  \end{tikzpicture}
  +
  \begin{tikzpicture}[baseline=-\the\dimexpr\fontdimen22\textfont2\relax,decoration=brace]
    \matrix (m)[matrix of math nodes,left delimiter={(},right delimiter={)},
                nodes={rectangle,text width=2em,align=center},row sep=0.3em, column sep=0.4em]
    {
       \mathbf{C}_b^n &amp; \mathbf{0}_3   &amp; \mathbf{0}_3 &amp; \mathbf{0}_3 \\
       \mathbf{0}_3   &amp; \mathbf{C}_b^n &amp; \mathbf{0}_3 &amp; \mathbf{0}_3 \\
       \mathbf{0}_3   &amp; \mathbf{0}_3   &amp; \mathbf{0}_3 &amp; \mathbf{0}_3 \\
       \mathbf{0}_3   &amp; \mathbf{0}_3   &amp; \mathbf{I}_3 &amp; \mathbf{0}_3 \\
       \mathbf{0}_3   &amp; \mathbf{0}_3   &amp; \mathbf{0}_3 &amp; \mathbf{I}_3 \\
    };
    \draw[decorate,transform canvas={yshift=.5em},thick] (m-1-1.north west) -- node[above=2pt] {$\mathbf{G}$} (m-1-4.north east);

    \begin{pgfonlayer}{background}
      \fhighlight[darkgray!20]{m-1-1}{m-1-1}
      \fhighlight[brown!20]{m-2-2}{m-2-2}
      \fhighlight[pink!20]{m-4-3}{m-4-3}
      \fhighlight[lightgray!20]{m-5-4}{m-5-4}
    \end{pgfonlayer}
  \end{tikzpicture}
  \cdot
  \mathbf{w}
\end{equation}" src="form_257.svg" width="1902" height="214"/></picture>
</p>
<h2><a class="anchor" id="LooselyCoupledKF_n-Noise-RW"></a>
Random Walk</h2>
<p>The random noise on the accelerometer and gyro measurements can be estimated as a Random Walk in the angle and velocity errors.</p>
<p><a class="anchor" id="eq-LCKF_n-random-walk"></a> </p><p class="formulaDsp">
<picture><source srcset="form_258_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-LCKF_n-random-walk}
  \dotup{x} = 0 + W(t)
\end{equation}" src="form_258.svg" width="1524" height="19"/></picture>
</p>
<p>The terms in the noise input matrix <picture><source srcset="form_151_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \mathbf{G} $" src="form_151.svg" width="16" height="14"/></picture> are not scaled and therefore need to be compensated with a noise scale matrix <picture><source srcset="form_69_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \mathbf{W} $" src="form_69.svg" width="21" height="14"/></picture> depending on the amplitude of the power spectral density (PSD) of the noise process.</p>
<p>White noise has a PSD of <picture><source srcset="form_154_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \sigma^2 $" src="form_154.svg" width="18" height="18"/></picture> and therefore the <b>PSDs of the accelerometer and gyro noise</b> are</p>
<p><a class="anchor" id="eq-LCKF_n-random-walk-S-noise"></a> </p><p class="formulaDsp">
<picture><source srcset="form_259_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-LCKF_n-random-walk-S-noise}
  \highlight[darkgray!20]{S_{ra,j}} = \sigma_{ra,j}^2 \tau_i, \qquad
  \highlight[brown!20]{S_{rg,j}} = \sigma_{rg,j}^2 \tau_i, \qquad\qquad j \in x,y,z
\end{equation}" src="form_259.svg" width="1689" height="28"/></picture>
</p>
<p> where</p><ul>
<li><picture><source srcset="form_156_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \sigma_{ra} $" src="form_156.svg" width="25" height="12"/></picture> is the standard deviation of the noise on the accelerometer specific-force measurements</li>
<li><picture><source srcset="form_157_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \sigma_{rg} $" src="form_157.svg" width="25" height="14"/></picture> is the standard deviation of the noise on the gyro angular-rate measurements</li>
<li><picture><source srcset="form_158_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \tau_i $" src="form_158.svg" width="12" height="12"/></picture> is the interval between the input of successive accelerometer and gyro outputs to the inertial navigation equations</li>
</ul>
<p>see <a class="el" href="citelist.html#CITEREF_Groves2013">[10]</a> Groves, ch. 14.2.6, eq. 14.83, p. 592</p>
<h2><a class="anchor" id="LooselyCoupledKF_n-Noise-GM1"></a>
Gauss-Markov 1. Order</h2>
<p>On the other hand, the dynamic bias of the accelerometer and gyro can be estimated with a Gauss-Markov 1. Order.</p>
<p><a class="anchor" id="eq-LCKF_n-gauss-markov-1"></a> </p><p class="formulaDsp">
<picture><source srcset="form_260_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-LCKF_n-gauss-markov-1}
  \dotup{x} = -\beta x + W(t)
\end{equation}" src="form_260.svg" width="1537" height="19"/></picture>
</p>
<p>The terms in the <picture><source srcset="form_150_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \mathbf{F} $" src="form_150.svg" width="12" height="14"/></picture> matrix are <a class="anchor" id="eq-LCKF_n-random-walk-beta"></a> </p><p class="formulaDsp">
<picture><source srcset="form_261_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-LCKF_n-random-walk-beta}
  \highlight[magenta!20]{\boldsymbol{\beta}_f} = \begin{pmatrix} -\beta_{f} &amp;      0     &amp;      0     \\
                                                                    0       &amp; -\beta_{f} &amp;      0     \\
                                                                    0       &amp;      0     &amp; -\beta_{f} \end{pmatrix}, \qquad
  \highlight[olive!20]{\boldsymbol{\beta}_\omega} = \begin{pmatrix} -\beta_{\omega} &amp;        0        &amp;        0        \\
                                                                           0        &amp; -\beta_{\omega} &amp;        0        \\
                                                                           0        &amp;        0        &amp; -\beta_{\omega} \end{pmatrix}
\end{equation}" src="form_261.svg" width="1715" height="63"/></picture>
</p>
<p> where</p><ul>
<li><picture><source srcset="form_161_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \beta_{f} $" src="form_161.svg" width="18" height="19"/></picture> is the Gauss-Markov constant for the accelerometer ùõΩ = 1 / ùúè (ùúè correlation length)</li>
<li><picture><source srcset="form_162_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \beta_{\omega} $" src="form_162.svg" width="19" height="18"/></picture> is the Gauss-Markov constant for the gyroscope ùõΩ = 1 / ùúè (ùúè correlation length)</li>
</ul>
<p>Like before, the scaling is done inside the noise scale matrix and the <b>Bias variation PSDs</b> are</p>
<p><a class="anchor" id="eq-LCKF_n-random-walk-S-bias"></a> </p><p class="formulaDsp">
<picture><source srcset="form_262_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-LCKF_n-random-walk-S-bias}
  \highlight[pink!20]{S_{bad,j}} = \frac{\sigma_{bad,j}^2}{\tau_{bad}} , \qquad
  \highlight[lightgray!20]{S_{bgd,j}} = \frac{\sigma_{bgd,j}^2}{\tau_{bgd}}, \qquad\qquad j \in x,y,z
\end{equation}" src="form_262.svg" width="1692" height="47"/></picture>
</p>
<p> where</p><ul>
<li><picture><source srcset="form_164_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \sigma_{bad} $" src="form_164.svg" width="32" height="12"/></picture> and <picture><source srcset="form_165_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \sigma_{bgd} $" src="form_165.svg" width="32" height="14"/></picture> are the standard deviations of the accelerometer and gyro dynamic biases</li>
<li><picture><source srcset="form_166_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \tau_{bad} $" src="form_166.svg" width="30" height="12"/></picture> and <picture><source srcset="form_167_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \tau_{bgd} $" src="form_167.svg" width="28" height="14"/></picture> are the correlation times of the dynamic accelerometer and gyro biases</li>
</ul>
<p>see <a class="el" href="citelist.html#CITEREF_Groves2013">[10]</a> Groves, ch. 14.2.6, eq. 14.84, p. 592</p>
<h2><a class="anchor" id="LooselyCoupledKF_n-Noise-Scale-matrix"></a>
Noise scale matrix W</h2>
<p><a class="anchor" id="eq-LCKF_n-random-walk-noise-scale-matrix-W"></a> </p><p class="formulaDsp">
<picture><source srcset="form_263_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-LCKF_n-random-walk-noise-scale-matrix-W}
  \mathbf{W} =
  \begin{tikzpicture}[baseline=-\the\dimexpr\fontdimen22\textfont2\relax,decoration=brace]
    \matrix (m)[matrix of math nodes,left delimiter={(},right delimiter={)},
                nodes={rectangle,text width=2em,align=center},row sep=0.3em, column sep=0.4em]
    {
      \mathbf{S}_{rg} &amp; \mathbf{0}_3    &amp; \mathbf{0}_3     &amp; \mathbf{0}_3     \\
      \mathbf{0}_3    &amp; \mathbf{S}_{ra} &amp; \mathbf{0}_3     &amp; \mathbf{0}_3     \\
      \mathbf{0}_3    &amp; \mathbf{0}_3    &amp; \mathbf{S}_{bad} &amp; \mathbf{0}_3     \\
      \mathbf{0}_3    &amp; \mathbf{0}_3    &amp; \mathbf{0}_3     &amp; \mathbf{S}_{bgd} \\
    };

    \begin{pgfonlayer}{background}
      \fhighlight[darkgray!20]{m-1-1}{m-1-1}
      \fhighlight[brown!20]{m-2-2}{m-2-2}
      \fhighlight[pink!20]{m-3-3}{m-3-3}
      \fhighlight[lightgray!20]{m-4-4}{m-4-4}
    \end{pgfonlayer}
  \end{tikzpicture}
\end{equation}" src="form_263.svg" width="1622" height="138"/></picture>
</p>
<p><picture><source srcset="form_169_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \mathbf{S}_{rg}, \mathbf{S}_{ra}, \mathbf{S}_{bad}, \mathbf{S}_{bgd} $" src="form_169.svg" width="140" height="18"/></picture> are diagonal matrices which entries are filled with the PSDs from <a class="el" href="group__LooselyCoupledKF__n.html#eq-LCKF_n-random-walk-S-noise"><picture><source srcset="form_264_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="\eqref{eq:eq-LCKF_n-random-walk-S-noise}" src="form_264.svg" width="44" height="19"/></picture> </a> and <a class="el" href="group__LooselyCoupledKF__n.html#eq-LCKF_n-random-walk-S-bias"><picture><source srcset="form_265_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="\eqref{eq:eq-LCKF_n-random-walk-S-bias}" src="form_265.svg" width="44" height="19"/></picture> </a>.</p>
<h1><a class="anchor" id="LooselyCoupledKF_n-KF-Matrices"></a>
Kalman-Filter Matrices</h1>
<h2><a class="anchor" id="LooselyCoupledKF_n-KF-Phi-Q"></a>
State transition matrix ùöΩ &amp; Process noise covariance matrix Q</h2>
<h3><a class="anchor" id="LooselyCoupledKF_n-KF-Phi"></a>
State transition matrix ùöΩ</h3>
<h4><a class="anchor" id="autotoc_md7"></a>
Exponential Matrix</h4>
<p>The state transition matrix is defined as</p>
<p><a class="anchor" id="eq-LCKF_n-Phi-exp"></a> </p><p class="formulaDsp">
<picture><source srcset="form_266_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-LCKF_n-Phi-exp}
  \boldsymbol{\Phi} = \exp{(\mathbf{F} \tau_s)}
\end{equation}" src="form_266.svg" width="1526" height="19"/></picture>
</p>
<p>see <a class="el" href="citelist.html#CITEREF_Groves2013">[10]</a> Groves, ch. 3.2.3, eq. 3.33, p. 97</p>
<h4><a class="anchor" id="autotoc_md8"></a>
Taylor series</h4>
<p>The exponential matrix cannot be calculated directly and numerical methods are computationally intensive. Therefore the transition matrix can be computed as a power-series expansion</p>
<p><a class="anchor" id="eq-LCKF_n-Phi-Taylor"></a> </p><p class="formulaDsp">
<picture><source srcset="form_267_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-LCKF_n-Phi-Taylor}
  \boldsymbol{\Phi} = \sum_{r=0}^{\infty} \frac{\mathbf{F}^r \tau_s^r}{r!} = \mathbf{I} + \mathbf{F} \tau_s + \frac{1}{2} \mathbf{F}^2 \tau^2 + \frac{1}{6} \mathbf{F}^3 \tau_s^3 + \dots
\end{equation}" src="form_267.svg" width="1659" height="51"/></picture>
</p>
<p>see <a class="el" href="citelist.html#CITEREF_Groves2013">[10]</a> Groves, ch. 3.2.3, eq. 3.34, p. 98</p>
<h3><a class="anchor" id="LooselyCoupledKF_n-KF-Q"></a>
Process noise covariance matrix Q</h3>
<p>The process noise covariance matrix is defined as</p>
<p><a class="anchor" id="eq-LCKF_n-Q-exact"></a> </p><p class="formulaDsp">
<picture><source srcset="form_268_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-LCKF_n-Q-exact}
  \mathbf{Q}_{k-1} = \int_{t_k - \tau_s}^{t_k} \exp{(\mathbf{F}_{k-1} (t_k-t'))} \mathbf{G}_{k-1} \mathbf{W}_{k-1} \mathbf{G}_{k-1}^T \exp{(\mathbf{F}_{k-1}^T (t_k-t'))} dt'
\end{equation}" src="form_268.svg" width="1750" height="47"/></picture>
</p>
<p>This matrix can be approximated and should be validated against the the exact version prior to use.</p>
<p><a class="anchor" id="eq-LCKF_n-Q-approx"></a> </p><p class="formulaDsp">
<picture><source srcset="form_269_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-LCKF_n-Q-approx}
  \mathbf{Q}_{k-1} \approx \mathbf{G}_{k-1} \mathbf{W}_{k-1} \mathbf{G}_{k-1}^T \tau_s
\end{equation}" src="form_269.svg" width="1577" height="21"/></picture>
</p>
<p>see <a class="el" href="citelist.html#CITEREF_Groves2013">[10]</a> Groves, ch. 3.2.3, eq. 3.43/3.45, p. 99</p>
<p>Taking the noise input and scale matrices from <a class="el" href="group__LooselyCoupledKF__n.html#eq-LCKF_n-dynamicModel-short"><picture><source srcset="form_176_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="\eqref{eq:eq-LCKF_n-dynamicModel-short}" src="form_176.svg" width="44" height="19"/></picture> </a> and <a class="el" href="group__LooselyCoupledKF__n.html#eq-LCKF_n-random-walk-noise-scale-matrix-W"><picture><source srcset="form_177_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="\eqref{eq:eq-LCKF_n-random-walk-noise-scale-matrix-W}" src="form_177.svg" width="44" height="19"/></picture> </a> and putting it into the exact form <a class="el" href="group__LooselyCoupledKF__n.html#eq-LCKF_n-Q-exact"><picture><source srcset="form_178_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="\eqref{eq:eq-LCKF_n-Q-exact}" src="form_178.svg" width="44" height="19"/></picture> </a>, it becomes</p>
<p><a class="anchor" id="eq-LCKF_n-Q-GWGT"></a> </p><p class="formulaDsp">
<picture><source srcset="form_270_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-LCKF_n-Q-GWGT}
\begin{aligned}
  \mathbf{Q}_{k-1} &amp;= \int_{t_k - \tau_s}^{t_k}
                           \exp{(\mathbf{F}_{k-1} (t_k-t'))}
                           \begin{tikzpicture}[baseline=-\the\dimexpr\fontdimen22\textfont2\relax,decoration=brace]
                             \matrix (m)[matrix of math nodes,left delimiter={(},right delimiter={)},
                                         nodes={rectangle,text width=4em,align=center},row sep=0.3em, column sep=0.4em]
                             {
                                \mathbf{C}_b^n \cdot \mathbf{S}_{rg} &amp;             \mathbf{0}_3             &amp;             \mathbf{0}_3            &amp;             \mathbf{0}_3            \\
                                            \mathbf{0}_3             &amp; \mathbf{C}_b^n \cdot \mathbf{S}_{ra} &amp;             \mathbf{0}_3            &amp;             \mathbf{0}_3            \\
                                            \mathbf{0}_3             &amp;             \mathbf{0}_3             &amp;             \mathbf{0}_3            &amp;             \mathbf{0}_3            \\
                                            \mathbf{0}_3             &amp;             \mathbf{0}_3             &amp; \mathbf{I}_3 \cdot \mathbf{S}_{bad} &amp;             \mathbf{0}_3            \\
                                            \mathbf{0}_3             &amp;             \mathbf{0}_3             &amp;             \mathbf{0}_3            &amp; \mathbf{I}_3 \cdot \mathbf{S}_{bgd} \\
                             };

                             \begin{pgfonlayer}{background}
                               \fhighlight[darkgray!20]{m-1-1}{m-1-1}
                               \fhighlight[brown!20]{m-2-2}{m-2-2}
                               \fhighlight[pink!20]{m-4-3}{m-4-3}
                               \fhighlight[lightgray!20]{m-5-4}{m-5-4}
                             \end{pgfonlayer}
                           \end{tikzpicture}
                           \begin{tikzpicture}[baseline=-\the\dimexpr\fontdimen22\textfont2\relax,decoration=brace]
                             \matrix (m)[matrix of math nodes,left delimiter={(},right delimiter={)},
                                         nodes={rectangle,text width=4em,align=center},row sep=0.3em, column sep=0.4em]
                             {
                                \mathbf{C}_n^b &amp; \mathbf{0}_3   &amp; \mathbf{0}_3 &amp; \mathbf{0}_3 &amp; \mathbf{0}_3 \\
                                \mathbf{0}_3   &amp; \mathbf{C}_n^b &amp; \mathbf{0}_3 &amp; \mathbf{0}_3 &amp; \mathbf{0}_3 \\
                                \mathbf{0}_3   &amp; \mathbf{0}_3   &amp; \mathbf{0}_3 &amp; \mathbf{I}_3 &amp; \mathbf{0}_3 \\
                                \mathbf{0}_3   &amp; \mathbf{0}_3   &amp; \mathbf{0}_3 &amp; \mathbf{0}_3 &amp; \mathbf{I}_3 \\
                             };

                             \begin{pgfonlayer}{background}
                               \fhighlight[darkgray!20]{m-1-1}{m-1-1}
                               \fhighlight[brown!20]{m-2-2}{m-2-2}
                               \fhighlight[pink!20]{m-3-4}{m-3-4}
                               \fhighlight[lightgray!20]{m-4-5}{m-4-5}
                             \end{pgfonlayer}
                           \end{tikzpicture}
                           \exp{(\mathbf{F}_{k-1}^T (t_k-t'))}
                      dt' \\
                   &amp;= \int_{t_k - \tau_s}^{t_k}
                           \exp{(\mathbf{F}_{k-1} (t_k-t'))}
                           \begin{tikzpicture}[baseline=-\the\dimexpr\fontdimen22\textfont2\relax,decoration=brace]
                             \matrix (m)[matrix of math nodes,left delimiter={(},right delimiter={)},
                                         nodes={rectangle,text width=5em,align=center},row sep=0.3em, column sep=0.4em]
                             {
                               \mathbf{C}_b^n \mathbf{S}_{rg} \mathbf{C}_n^b &amp;                \mathbf{0}_3                   &amp; \mathbf{0}_3 &amp; \mathbf{0}_3     &amp; \mathbf{0}_3     \\
                                              \mathbf{0}_3                   &amp; \mathbf{C}_b^n \mathbf{S}_{ra} \mathbf{C}_n^b &amp; \mathbf{0}_3 &amp; \mathbf{0}_3     &amp; \mathbf{0}_3     \\
                                              \mathbf{0}_3                   &amp;                \mathbf{0}_3                   &amp; \mathbf{0}_3 &amp; \mathbf{0}_3     &amp; \mathbf{0}_3     \\
                                              \mathbf{0}_3                   &amp;                \mathbf{0}_3                   &amp; \mathbf{0}_3 &amp; \mathbf{S}_{bad} &amp; \mathbf{0}_3     \\
                                              \mathbf{0}_3                   &amp;                \mathbf{0}_3                   &amp; \mathbf{0}_3 &amp; \mathbf{0}_3     &amp; \mathbf{S}_{bgd} \\
                             };

                             \begin{pgfonlayer}{background}
                               \fhighlight[darkgray!20]{m-1-1}{m-1-1}
                               \fhighlight[brown!20]{m-2-2}{m-2-2}
                               \fhighlight[pink!20]{m-4-4}{m-4-4}
                               \fhighlight[lightgray!20]{m-5-5}{m-5-5}
                             \end{pgfonlayer}
                           \end{tikzpicture}
                           \exp{(\mathbf{F}_{k-1}^T (t_k-t'))}
                      dt'
\end{aligned}
\end{equation}" src="form_270.svg" width="2121" height="357"/></picture>
</p>
<p>The exponential <picture><source srcset="form_150_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \mathbf{F} $" src="form_150.svg" width="12" height="14"/></picture> matrix shall be approximated by first order. This leads to:</p>
<p><a class="anchor" id="eq-LCKF_n-Q-GWGT-approx"></a> </p><p class="formulaDsp">
<picture><source srcset="form_271_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-LCKF_n-Q-GWGT-approx}
\begin{aligned}
  \mathbf{Q}_{k-1} &amp;\approx \int_{t_k - \tau_s}^{t_k}
                                 \begin{tikzpicture}[baseline=-\the\dimexpr\fontdimen22\textfont2\relax,decoration=brace]
                                   \matrix (m)[matrix of math nodes,left delimiter={(},right delimiter={)},
                                               nodes={rectangle,text width=5.5em,align=center},row sep=0.3em, column sep=0.4em]
                                   {
                                     \mathbf{I}_3 + \mathbf{F}_{\delta \dotup{\psi},\delta \psi}^n \tau_s &amp;                \mathbf{F}_{\delta \dotup{\psi},\delta v}^n \tau_s &amp;                \mathbf{F}_{\delta \dotup{\psi},\delta r}^n \tau_s &amp; \mathbf{0}_3          &amp; \mathbf{C}_b^n \tau_s \\
                                                    \mathbf{F}_{\delta \dotup{v},\delta \psi}^n    \tau_s &amp; \mathbf{I}_3 + \mathbf{F}_{\delta \dotup{v},\delta v}^n    \tau_s &amp;                \mathbf{F}_{\delta \dotup{v},\delta r}^n    \tau_s &amp; \mathbf{C}_b^n \tau_s &amp; \mathbf{0}_3          \\
                                                    \mathbf{0}_3                                          &amp;                \mathbf{F}_{\delta \dotup{r},\delta v}^n    \tau_s &amp; \mathbf{I}_3 + \mathbf{F}_{\delta \dotup{r},\delta r}^n    \tau_s &amp; \mathbf{0}_3          &amp; \mathbf{0}_3          \\
                                                    \mathbf{0}_3                                          &amp;                \mathbf{0}_3                                       &amp;                \mathbf{0}_3                                       &amp; \mathbf{I}_3          &amp; \mathbf{0}_3          \\
                                                    \mathbf{0}_3                                          &amp;                \mathbf{0}_3                                       &amp;                \mathbf{0}_3                                       &amp; \mathbf{0}_3          &amp; \mathbf{I}_3          \\
                                   };

                                   \begin{pgfonlayer}{background}
                                     \fhighlight[green!20]{m-1-1}{m-1-1}
                                     \fhighlight[yellow!20]{m-1-2}{m-1-2}
                                     \fhighlight[lime!20]{m-1-3}{m-1-3}
                                     \fhighlight[orange!20]{m-1-5}{m-1-5}
                                     \fhighlight[purple!20]{m-2-1}{m-2-1}
                                     \fhighlight[blue!20]{m-2-2}{m-2-2}
                                     \fhighlight[violet!20]{m-2-3}{m-2-3}
                                     \fhighlight[red!20]{m-2-4}{m-2-4}
                                     \fhighlight[teal!20]{m-3-2}{m-3-2}
                                     \fhighlight[cyan!20]{m-3-3}{m-3-3}
                                   \end{pgfonlayer}
                                 \end{tikzpicture}
                                 \begin{tikzpicture}[baseline=-\the\dimexpr\fontdimen22\textfont2\relax,decoration=brace]
                                   \matrix (m)[matrix of math nodes,left delimiter={(},right delimiter={)},
                                               nodes={rectangle,text width=5em,align=center},row sep=0.3em, column sep=0.4em]
                                   {
                                     \mathbf{C}_b^n \mathbf{S}_{rg} \mathbf{C}_n^b &amp;                \mathbf{0}_3                   &amp; \mathbf{0}_3 &amp; \mathbf{0}_3     &amp; \mathbf{0}_3     \\
                                                    \mathbf{0}_3                   &amp; \mathbf{C}_b^n \mathbf{S}_{ra} \mathbf{C}_n^b &amp; \mathbf{0}_3 &amp; \mathbf{0}_3     &amp; \mathbf{0}_3     \\
                                                    \mathbf{0}_3                   &amp;                \mathbf{0}_3                   &amp; \mathbf{0}_3 &amp; \mathbf{0}_3     &amp; \mathbf{0}_3     \\
                                                    \mathbf{0}_3                   &amp;                \mathbf{0}_3                   &amp; \mathbf{0}_3 &amp; \mathbf{S}_{bad} &amp; \mathbf{0}_3     \\
                                                    \mathbf{0}_3                   &amp;                \mathbf{0}_3                   &amp; \mathbf{0}_3 &amp; \mathbf{0}_3     &amp; \mathbf{S}_{bgd} \\
                                   };

                                   \begin{pgfonlayer}{background}
                                     \fhighlight[darkgray!20]{m-1-1}{m-1-1}
                                     \fhighlight[brown!20]{m-2-2}{m-2-2}
                                     \fhighlight[pink!20]{m-4-4}{m-4-4}
                                     \fhighlight[lightgray!20]{m-5-5}{m-5-5}
                                   \end{pgfonlayer}
                                 \end{tikzpicture}
                                 \begin{tikzpicture}[baseline=-\the\dimexpr\fontdimen22\textfont2\relax,decoration=brace]
                                   \matrix (m)[matrix of math nodes,left delimiter={(},right delimiter={)},
                                               nodes={rectangle,text width=5.5em,align=center},row sep=0.3em, column sep=0.4em]
                                   {
                                     \mathbf{I}_3 + \mathbf{F}_{\delta \dotup{\psi},\delta \psi}^n \tau_s &amp;                \mathbf{F}_{\delta \dotup{v},\delta \psi}^n \tau_s &amp;                \mathbf{0}_3                                       &amp; \mathbf{0}_3          &amp;  \mathbf{0}_3          \\
                                                    \mathbf{F}_{\delta \dotup{\psi},\delta v}^n    \tau_s &amp; \mathbf{I}_3 + \mathbf{F}_{\delta \dotup{v},\delta v}^n    \tau_s &amp;                \mathbf{F}_{\delta \dotup{r},\delta v}^n    \tau_s &amp; \mathbf{0}_3          &amp;  \mathbf{0}_3          \\
                                                    \mathbf{F}_{\delta \dotup{\psi},\delta r}^n    \tau_s &amp;                \mathbf{F}_{\delta \dotup{v},\delta r}^n    \tau_s &amp; \mathbf{I}_3 + \mathbf{F}_{\delta \dotup{r},\delta r}^n    \tau_s &amp; \mathbf{0}_3          &amp;  \mathbf{0}_3          \\
                                                    \mathbf{0}_3                                          &amp;                \mathbf{C}_b^n \tau_s                              &amp;                \mathbf{0}_3                                       &amp; \mathbf{I}_3          &amp;  \mathbf{0}_3          \\
                                                    \mathbf{C}_b^n \tau_s                                 &amp;                \mathbf{0}_3                                       &amp;                \mathbf{0}_3                                       &amp; \mathbf{0}_3          &amp;  \mathbf{I}_3          \\
                                   };

                                   \begin{pgfonlayer}{background}
                                     \fhighlight[green!20]{m-1-1}{m-1-1}
                                     \fhighlight[yellow!20]{m-2-1}{m-2-1}
                                     \fhighlight[lime!20]{m-3-1}{m-3-1}
                                     \fhighlight[orange!20]{m-5-1}{m-5-1}
                                     \fhighlight[purple!20]{m-1-2}{m-1-2}
                                     \fhighlight[blue!20]{m-2-2}{m-2-2}
                                     \fhighlight[violet!20]{m-3-2}{m-3-2}
                                     \fhighlight[red!20]{m-4-2}{m-4-2}
                                     \fhighlight[teal!20]{m-2-3}{m-2-3}
                                     \fhighlight[cyan!20]{m-3-3}{m-3-3}
                                   \end{pgfonlayer}
                                 \end{tikzpicture}
                            dt'
\end{aligned}
\end{equation}" src="form_271.svg" width="2445" height="191"/></picture>
</p>
<p>TODO: <picture><source srcset="form_272_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \textcolor{red}{\text{Documentation here}} $" src="form_272.svg" width="156" height="14"/></picture></p>
<p>The final equation is</p>
<p><a class="anchor" id="eq-LCKF_n-Q-final"></a> </p><p class="formulaDsp">
<picture><source srcset="form_273_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-LCKF_n-Q-final}
  \mathbf{Q} =
  \begin{tikzpicture}[baseline=-\the\dimexpr\fontdimen22\textfont2\relax,decoration=brace]
    \matrix (m)[matrix of math nodes,left delimiter={(},right delimiter={)},
                nodes={rectangle},row sep=0.3em, column sep=0.4em]
    {
      (\mathbf{S}_{rg}\tau_s + \frac{1}{3} \mathbf{S}_{bgd} \tau_s^3) \mathbf{I} &amp; (\frac{1}{2} \mathbf{S}_{rg} \tau_s^2 + \frac{1}{4} \mathbf{S}_{bgd} \tau_s^4) \mathbf{F}_{\delta \dotup{v},\delta \psi}^n &amp; \\
    };
  \end{tikzpicture}
\end{equation}" src="form_273.svg" width="1703" height="44"/></picture>
</p>
<p> TODO: <picture><source srcset="form_274_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \textcolor{red}{\text{Finish formula}} $" src="form_274.svg" width="112" height="14"/></picture></p>
<p>where</p><ul>
<li><picture><source srcset="form_275_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \tau_s $" src="form_275.svg" width="14" height="12"/></picture> is the propagation interval (as we trigger the prediction every time we get IMU measurements this corresponds to <picture><source srcset="form_158_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \tau_i $" src="form_158.svg" width="12" height="12"/></picture>, the time between measurements)</li>
</ul>
<p>see <a class="el" href="citelist.html#CITEREF_Groves2013">[10]</a> Groves, ch. 14.2.6, eq. 14.80/14.81, p. 591</p>
<h3><a class="anchor" id="LooselyCoupledKF_n-KF-Phi-Q-Van-Loan"></a>
Van Loan method</h3>
<p>The state transition matrix and the system/process noise covariance matrix can be calculated with the van Loan method <a class="el" href="citelist.html#CITEREF_Loan1978">[33]</a> . In short</p>
<ol type="1">
<li>Form a <picture><source srcset="form_65_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ 2n \times 2n $" src="form_65.svg" width="60" height="14"/></picture> matrix called <picture><source srcset="form_66_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \mathbf{A} $" src="form_66.svg" width="16" height="14"/></picture> ( <picture><source srcset="form_67_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ n $" src="form_67.svg" width="11" height="11"/></picture> is the dimension of <picture><source srcset="form_68_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \mathbf{x} $" src="form_68.svg" width="11" height="11"/></picture> and <picture><source srcset="form_69_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \mathbf{W} $" src="form_69.svg" width="21" height="14"/></picture> is the power spectral density of the noise <picture><source srcset="form_70_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ W(t) $" src="form_70.svg" width="39" height="19"/></picture>) <a class="anchor" id="eq-LCKF_n-Loan-A"></a> <p class="formulaDsp">
<picture><source srcset="form_276_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-LCKF_n-Loan-A}
  \mathbf{A} = \begin{bmatrix} -\mathbf{F} &amp; \mathbf{G} \mathbf{W} \mathbf{G}^T \\
                                \mathbf{0} &amp;            \mathbf{F}^T          \end{bmatrix} \Delta t
\end{equation}" src="form_276.svg" width="1566" height="42"/></picture>
</p>
</li>
<li>Calculate the exponential of <picture><source srcset="form_66_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \mathbf{A} $" src="form_66.svg" width="16" height="14"/></picture> <a class="anchor" id="eq-LCKF_n-Loan-B"></a> <p class="formulaDsp">
<picture><source srcset="form_277_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-LCKF_n-Loan-B}
  \mathbf{B} = \text{expm}(\mathbf{A}) = \left[ \begin{array}{c;{2pt/2pt}c}
                                            \dots          &amp; \mathbf{\Phi}^{-1} \mathbf{Q} \\[2mm]
                                            \hdashline[2pt/2pt] &amp;                                  \\[-2mm]
                                            \mathbf{0}          &amp; \mathbf{\Phi}^T                     \end{array} \right]
                                       = \begin{bmatrix} \mathbf{B}_{11} &amp; \mathbf{B}_{12} \\
                                                         \mathbf{B}_{21} &amp; \mathbf{B}_{22} \end{bmatrix}
\end{equation}" src="form_277.svg" width="1661" height="67"/></picture>
</p>
</li>
<li>Calculate the state transition matrix <picture><source srcset="form_73_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \mathbf{\Phi} $" src="form_73.svg" width="14" height="14"/></picture> as <a class="anchor" id="eq-LCKF_n-Loan-Phi"></a> <p class="formulaDsp">
<picture><source srcset="form_278_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-LCKF_n-Loan-Phi}
  \mathbf{\Phi} = \mathbf{B}_{22}^T
\end{equation}" src="form_278.svg" width="1505" height="21"/></picture>
</p>
</li>
<li>Calculate the process noise covariance matrix <picture><source srcset="form_75_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \mathbf{Q} $" src="form_75.svg" width="14" height="16"/></picture> as <a class="anchor" id="eq-LCKF_n-Loan-Q"></a> <p class="formulaDsp">
<picture><source srcset="form_279_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-LCKF_n-Loan-Q}
  \mathbf{Q} = \mathbf{\Phi} \mathbf{B}_{12}
\end{equation}" src="form_279.svg" width="1512" height="19"/></picture>
</p>
</li>
</ol>
<h2><a class="anchor" id="LooselyCoupledKF_n-KF-P"></a>
Error covariance matrix P</h2>
<p>The error covariance matrix is initialized as a diagonal matrix with the variance of the initial state as diagonal elements.</p>
<p><a class="anchor" id="eq-LCKF_n-P"></a> </p><p class="formulaDsp">
<picture><source srcset="form_280_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-LCKF_n-P}
  \mathbf{P}_0 =
  \begin{tikzpicture}[baseline=-\the\dimexpr\fontdimen22\textfont2\relax,decoration=brace]
    \matrix (m)[matrix of math nodes,left delimiter={(},right delimiter={)},row sep=0.3em, column sep=0.4em,
                nodes={rectangle,text width=2.5em,align=center,minimum height=2.3em,anchor=center},] {
      \boldsymbol{\sigma}_{\boldsymbol{\delta \psi}}^2 &amp;                                                 &amp;                      \dots                      &amp;                                                 &amp;                        \mathbf{0}_3                       \\
                                                       &amp; \boldsymbol{\sigma}_{\boldsymbol{\delta v^n}}^2 &amp;                                                 &amp;                    \iddots                      &amp;                                                           \\
                           \vdots                      &amp;                                                 &amp; \boldsymbol{\sigma}_{\boldsymbol{\delta p_b}}^2 &amp;                                                 &amp;                          \vdots                           \\
                                                       &amp;                    \iddots                      &amp;                                                 &amp; \boldsymbol{\sigma}_{\boldsymbol{\delta f^b}}^2 &amp;                                                           \\
                        \mathbf{0}_3                   &amp;                                                 &amp;                      \dots                      &amp;                                                 &amp; \boldsymbol{\sigma}_{\boldsymbol{\delta \omega^b_{ib}}}^2 \\
    };

    \begin{pgfonlayer}{background}
      \fhighlight[green!20]{m-1-1}{m-1-1}
      \fhighlight[blue!20]{m-2-2}{m-2-2}
      \fhighlight[cyan!20]{m-3-3}{m-3-3}
      \fhighlight[red!20]{m-4-4}{m-4-4}
      \fhighlight[orange!20]{m-5-5}{m-5-5}
    \end{pgfonlayer}
  \end{tikzpicture}
\end{equation}" src="form_280.svg" width="1670" height="233"/></picture>
</p>
<h2><a class="anchor" id="LooselyCoupledKF_n-deltaz"></a>
Measurement innovation ùõøz</h2>
<p><a class="anchor" id="eq-LCKF_n-deltaz"></a> </p><p class="formulaDsp">
<picture><source srcset="form_281_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-LCKF_n-deltaz}
  \boldsymbol{\delta} \mathbf{z}^n = \begin{pmatrix} \tilde{\mathbf{p}}_{b,G} - \hat{\mathbf{p}}_{b} - \mathbf{T}_{r(n)}^{p} \mathbf{C}_b^n \mathbf{l}_{ba}^b \\
                                      \tilde{\mathbf{v}}^n_{G} - \hat{\mathbf{v}}^n - \mathbf{C}_b^n (\boldsymbol{\omega}_{ib}^b \times \mathbf{l}_{ba}^b) + \boldsymbol{\Omega}_{ie}^n \mathbf{C}_b^n \mathbf{l}_{ba}^b \end{pmatrix}
\end{equation}" src="form_281.svg" width="1652" height="46"/></picture>
</p>
<p>where</p><ul>
<li><picture><source srcset="form_186_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ G $" src="form_186.svg" width="14" height="14"/></picture> denotes GNSS indicated measurements</li>
<li><picture><source srcset="form_187_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \mathbf{l}_{ba}^b $" src="form_187.svg" width="19" height="21"/></picture> is the lever arm from the INS to the GNSS antenna in [m]</li>
<li><picture><source srcset="form_282_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \mathbf{T}_{r(n)}^{p} = \begin{pmatrix} \frac{1}{R_N + h} &amp;               0               &amp;  0 \\
                                                       0        &amp; \frac{1}{(R_E + h)\cos{\phi}} &amp;  0 \\
                                                       0        &amp;               0               &amp; -1 \end{pmatrix} $" src="form_282.svg" width="278" height="67"/></picture> is the Cartesian-to-curvilinear position change transformation matrix (<a class="el" href="citelist.html#CITEREF_Groves2013">[10]</a> Groves, ch. 14.3.1, eq. 14.104, p. 598ff)</li>
</ul>
<p>This form corresponds to</p><ul>
<li><a class="el" href="citelist.html#CITEREF_Groves2013">[10]</a> Groves, ch. 14.3.1, eq. 14.103, p. 598</li>
</ul>
<h2><a class="anchor" id="LooselyCoupledKF_n-KF-H"></a>
Measurement sensitivity Matrix H</h2>
<p><a class="anchor" id="eq-LCKF_n-H-general"></a> </p><p class="formulaDsp">
<picture><source srcset="form_283_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-LCKF_n-H-general}
  \mathbf{H}_k = \left. \frac{\partial \mathbf{h} (\mathbf{x}, t_k)}{\partial \mathbf{x}} \right|_{x = \hat{x}_k^{-}}
               = \left. \frac{\partial \mathbf{z} (\mathbf{x}, t_k)}{\partial \mathbf{x}} \right|_{x = \hat{x}_k^{-}}
\end{equation}" src="form_283.svg" width="1624" height="49"/></picture>
</p>
<p>see</p><ul>
<li><a class="el" href="citelist.html#CITEREF_Groves2013">[10]</a> Groves, ch. 3.4.1, eq. 3.90, p. 119</li>
</ul>
<p><a class="anchor" id="eq-LCKF_n-H"></a> </p><p class="formulaDsp">
<picture><source srcset="form_284_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-LCKF_n-H}
  \mathbf{H}^n =
  \begin{tikzpicture}[baseline=-\the\dimexpr\fontdimen22\textfont2\relax,decoration=brace]
    \matrix (m)[matrix of math nodes,left delimiter={(},right delimiter={)},row sep=0.3em, column sep=0.4em,
                nodes={rectangle,text width=2.5em,align=center,minimum height=2.3em,anchor=center},] {
      \mathbf{H}_{r,\delta \psi}^n &amp;  \mathbf{0}_3 &amp; -\mathbf{I}_3 &amp; \mathbf{0}_3 &amp; \mathbf{0}_3                          \\
      \mathbf{H}_{v,\delta \psi}^n &amp; -\mathbf{I}_3 &amp;  \mathbf{0}_3 &amp; \mathbf{0}_3 &amp; \mathbf{H}_{\delta v,\omega_{ib}^b}^n \\
    };

    \begin{pgfonlayer}{background}
      \fhighlight[green!20]{m-1-1}{m-1-1}
      \fhighlight[green!20]{m-2-1}{m-2-1}
      \fhighlight[blue!20]{m-2-2}{m-2-2}
      \fhighlight[cyan!20]{m-1-3}{m-1-3}
      \fhighlight[orange!20]{m-2-5}{m-2-5}
    \end{pgfonlayer}
  \end{tikzpicture}
\end{equation}" src="form_284.svg" width="1671" height="96"/></picture>
</p>
<p>where <a class="anchor" id="eq-LCKF_n-H-sub"></a> </p><p class="formulaDsp">
<picture><source srcset="form_285_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-LCKF_n-H-sub}
\begin{aligned}
  \highlight[green!20]{\mathbf{H}_{r,\delta \psi}^n}    &amp;\approx \mathbf{T}_{r(n)}^{p} \left[ (\mathbf{C}_b^n \mathbf{l}_{ba}^b) \times \right] \\
  \highlight[green!20]{\mathbf{H}_{v,\delta \psi}^n}    &amp;\approx \left[ \left\{ \mathbf{C}_b^n (\boldsymbol{\omega}_{ib}^b \times \mathbf{l}_{ba}^b) - \boldsymbol{\Omega}_{ie}^n \mathbf{C}_b^n \mathbf{l}_{ba}^b \right\} \times \right] \\
  \highlight[orange!20]{\mathbf{H}_{v,\omega_{ib}^b}^n} &amp;\approx \mathbf{C}_b^n \left[ \mathbf{l}_{ba}^b \times \right] \\
\end{aligned}
\end{equation}" src="form_285.svg" width="1638" height="110"/></picture>
</p>
<p>See</p><ul>
<li><a class="el" href="citelist.html#CITEREF_Groves2013">[10]</a> Groves, ch. 14.3.1, eq. 14.113/14.114, p. 600</li>
</ul>
<h2><a class="anchor" id="LooselyCoupledKF_n-KF-R"></a>
Measurement noise covariance matrix R</h2>
<p>The measurement noise covariance matrix is a diagonal matrix with the variances of the measurements as diagonal elements.</p>
<p><a class="anchor" id="eq-LCKF_n-R"></a> </p><p class="formulaDsp">
<picture><source srcset="form_286_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-LCKF_n-R}
  \mathbf{R} = E \left( (\mathbf{z} - \mathbf{H} \mathbf{x})(\mathbf{z} - \mathbf{H} \mathbf{x})^T \right) =
  \begin{tikzpicture}[baseline=-\the\dimexpr\fontdimen22\textfont2\relax,decoration=brace]
    \matrix (m)[matrix of math nodes,left delimiter={(},right delimiter={)},row sep=0.3em, column sep=0.1em,
                nodes={rectangle,text width=2.2em,align=center,minimum height=2.3em,anchor=center},] {
      \sigma^2_{z_\phi} &amp;          0           &amp;       0        &amp;         0          &amp;         0          &amp;         0          \\
              0         &amp; \sigma^2_{z_\lambda} &amp;       0        &amp;         0          &amp;         0          &amp;         0          \\
              0         &amp;          0           &amp; \sigma^2_{z_h} &amp;         0          &amp;         0          &amp;         0          \\
              0         &amp;          0           &amp;       0        &amp; \sigma^2_{z_{v_N}} &amp;         0          &amp;         0          \\
              0         &amp;          0           &amp;       0        &amp;         0          &amp; \sigma^2_{z_{v_E}} &amp;         0          \\
              0         &amp;          0           &amp;       0        &amp;         0          &amp;         0          &amp; \sigma^2_{z_{v_D}} \\
    };

    \begin{pgfonlayer}{background}
      \fhighlight[cyan!20]{m-1-1}{m-1-1}
      \fhighlight[cyan!20]{m-2-2}{m-2-2}
      \fhighlight[cyan!20]{m-3-3}{m-3-3}
      \fhighlight[blue!20]{m-4-4}{m-4-4}
      \fhighlight[blue!20]{m-5-5}{m-5-5}
      \fhighlight[blue!20]{m-6-6}{m-6-6}
    \end{pgfonlayer}
  \end{tikzpicture}
\end{equation}" src="form_286.svg" width="1773" height="273"/></picture>
</p>
<p>This variances can be set static or ideally come from the GNSS receiver.</p>
<h1><a class="anchor" id="LooselyCoupledKF_n-Corrections"></a>
Corrections</h1>
<p>This section describes how the errors are applied to the total state.</p>
<h2><a class="anchor" id="LooselyCoupledKF_n-Corrections-State"></a>
Position, Velocity, Attitude</h2>
<p>The position and velocity errors get applied by simply subtracting them from the previous total state (see <a class="el" href="citelist.html#CITEREF_Groves2013">[10]</a> Groves, ch. 14.1.1, eq. 14.8, 14.10, p. 564)</p>
<p><a class="anchor" id="eq-LCKF_n-correction-position-velocity"></a> </p><p class="formulaDsp">
<picture><source srcset="form_287_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-LCKF_n-correction-position-velocity}
\begin{aligned}
  \boldsymbol{p}_b^{+} &amp;= \boldsymbol{p}_b^{-} - \boldsymbol{\delta p}_b \\
  \boldsymbol{v}^{n,+} &amp;= \boldsymbol{v}^{n,-} - \boldsymbol{\delta v}^{n}
\end{aligned}
\end{equation}" src="form_287.svg" width="1545" height="44"/></picture>
</p>
<p>The attitude correction can be derived from equation <a class="el" href="group__LooselyCoupledKF__n.html#eq-LCKF_n-Derivation-Attitude-estimate-errors"><picture><source srcset="form_288_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="\eqref{eq:eq-LCKF_n-Derivation-Attitude-estimate-errors}" src="form_288.svg" width="44" height="19"/></picture> </a> (see <a class="el" href="citelist.html#CITEREF_Groves2013">[10]</a> Groves, ch. 14.1.1, eq. 14.7, p. 564) <a class="anchor" id="eq-LCKF_n-correction-attitude"></a> </p><p class="formulaDsp">
<picture><source srcset="form_289_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-LCKF_n-correction-attitude}
  \mathbf{C}_b^{n,+} = (\mathbf{I}_3 - [\boldsymbol{\delta \psi} \times]) \mathbf{C}_b^{n,-}
\end{equation}" src="form_289.svg" width="1572" height="25"/></picture>
</p>
<p>After applying the errors to the total state, the errors have to be reset to zero (closed-loop).</p>
<h2><a class="anchor" id="LooselyCoupledKF_n-Corrections-Bias"></a>
Biases</h2>
<p>To correct the accelerometer and gyroscope measurements, we need to accumulate the error states. This has to be done, because contrary to the normal state, the expected value of the biases is not zero.</p>
<p><a class="anchor" id="eq-LCKF_n-correction-accel-gyro-accumulate"></a> </p><p class="formulaDsp">
<picture><source srcset="form_290_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-LCKF_n-correction-accel-gyro-accumulate}
\begin{aligned}
  \boldsymbol{\Delta f}^{b,+}           &amp;= \boldsymbol{\Delta f}^{b,-}           + \boldsymbol{\delta f}^b \\
  \boldsymbol{\Delta \omega}_{ib}^{b,+} &amp;= \boldsymbol{\Delta \omega}_{ib}^{b,-} + \boldsymbol{\delta \omega}_{ib}^b
\end{aligned}
\end{equation}" src="form_290.svg" width="1563" height="53"/></picture>
</p>
<p>Afterwards this accumulated value can be applied to the measurements by subtracting it</p>
<p><a class="anchor" id="eq-LCKF_n-correction-accel-gyro"></a> </p><p class="formulaDsp">
<picture><source srcset="form_291_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-LCKF_n-correction-accel-gyro}
\begin{aligned}
  \boldsymbol{f}^{p,+}           &amp;= \boldsymbol{f}^{p,-}           - \mathbf{C}_b^p \boldsymbol{\Delta f}^{b,+} \\
  \boldsymbol{\omega}_{ib}^{p,+} &amp;= \boldsymbol{\omega}_{ib}^{p,-} - \mathbf{C}_b^p \boldsymbol{\Delta \omega}_{ib}^{b,+}
\end{aligned}
\end{equation}" src="form_291.svg" width="1568" height="53"/></picture>
</p>
<p>Afterwards the bias in the error state gets reset to zero, as it is accounted for in the accumulated value.</p>
<h1><a class="anchor" id="LooselyCoupledKF_n-Units"></a>
Unit discussion</h1>
<h2><a class="anchor" id="LooselyCoupledKF_n-Units-F"></a>
System matrix F</h2>
<p>The units of the state vector <picture><source srcset="form_68_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \mathbf{x} $" src="form_68.svg" width="11" height="11"/></picture> and the <picture><source srcset="form_150_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \mathbf{F} $" src="form_150.svg" width="12" height="14"/></picture> matrix are as follows</p>
<p><a class="anchor" id="eq-LCKF_n-stateMatrix-units"></a> </p><p class="formulaDsp">
<picture><source srcset="form_292_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-LCKF_n-stateMatrix-units}
  \begin{tikzpicture}[baseline=-\the\dimexpr\fontdimen22\textfont2\relax,decoration=brace]
    \matrix (m)[matrix of math nodes,left delimiter={(},right delimiter={)},
                nodes={rectangle,text width=1.6em,align=center,minimum height=2.3em,anchor=center},row sep=0.3em, column sep=0.1em,] {
      \delta \dotup{R}              &amp; \left[ \frac{\text{rad}}{\text{s}} \right]   \\
      \delta \dotup{P}              &amp; \left[ \frac{\text{rad}}{\text{s}} \right]   \\
      \delta \dotup{Y}              &amp; \left[ \frac{\text{rad}}{\text{s}} \right]   \\
      \delta \dotup{v}_{N}          &amp; \left[ \frac{\text{m}}{\text{s}^2} \right]   \\
      \delta \dotup{v}_{E}          &amp; \left[ \frac{\text{m}}{\text{s}^2} \right]   \\
      \delta \dotup{v}_{D}          &amp; \left[ \frac{\text{m}}{\text{s}^2} \right]   \\
      \delta \dotup{\phi}           &amp; \left[ \frac{\text{rad}}{\text{s}} \right]   \\
      \delta \dotup{\lambda}        &amp; \left[ \frac{\text{rad}}{\text{s}} \right]   \\
      \delta \dotup{h}              &amp; \left[ \frac{\text{m}}{\text{s}} \right]     \\
      \delta \dotup{f}_{x}^{b}      &amp; \left[ \frac{\text{m}}{\text{s}^3} \right]   \\
      \delta \dotup{f}_{y}^{b}      &amp; \left[ \frac{\text{m}}{\text{s}^3} \right]   \\
      \delta \dotup{f}_{z}^{b}      &amp; \left[ \frac{\text{m}}{\text{s}^3} \right]   \\
      \delta \dotup{\omega}_{x}^{b} &amp; \left[ \frac{\text{rad}}{\text{s}^2} \right] \\
      \delta \dotup{\omega}_{y}^{b} &amp; \left[ \frac{\text{rad}}{\text{s}^2} \right] \\
      \delta \dotup{\omega}_{z}^{b} &amp; \left[ \frac{\text{rad}}{\text{s}^2} \right] \\
    };
    \draw[decorate,transform canvas={yshift=.5em},thick] (m-1-1.north west) -- node[above=2pt] {$\boldsymbol{\delta} \mathbf{\dot{x}}$} (m-1-2.north east);

    \begin{pgfonlayer}{background}
      \fhighlight[green!20]{m-1-1}{m-3-1}
      \fhighlight[blue!20]{m-4-1}{m-6-1}
      \fhighlight[cyan!20]{m-7-1}{m-9-1}
      \fhighlight[red!20]{m-10-1}{m-12-1}
      \fhighlight[orange!20]{m-13-1}{m-15-1}
    \end{pgfonlayer}
  \end{tikzpicture}
  =
  \begin{tikzpicture}[baseline=-\the\dimexpr\fontdimen22\textfont2\relax,decoration=brace]
    \matrix (m)[matrix of math nodes,left delimiter={(},right delimiter={)},nodes in empty cells,
                row sep=0.3em, column sep=0.4em,
                nodes={rectangle,minimum height=2.3em,anchor=center},] {
               0                                                    &amp;  \omega_{in,3}^{n} \left[ \frac{\text{rad}}{\text{s}} \right] &amp; -\omega_{in,2}^{n} \left[ \frac{\text{rad}}{\text{s}} \right] &amp;                             0                                                              &amp;                    -\frac{1}{R_E + h}                     \left[ \frac{1}{\text{m}} \right] &amp;                       0                                                        &amp;                                    \omega_{ie}\sin{\phi}                                    \left[ \frac{\text{rad}}{\text{s}} \right] &amp;      0       &amp;                    \frac{v_E}{(R_E + h)^2}                   \left[ \frac{1}{\text{m} \cdot \text{s}} \right] &amp;  &amp;                                 &amp;  &amp;  &amp;                                 &amp; \\
      -\omega_{in,3}^{n} \left[ \frac{\text{rad}}{\text{s}} \right] &amp;          0                                                    &amp;  \omega_{in,1}^{n} \left[ \frac{\text{rad}}{\text{s}} \right] &amp;                    \frac{1}{R_N + h}                     \left[ \frac{1}{\text{m}} \right] &amp;                             0                                                               &amp;                       0                                                        &amp;                                             0                                                                                          &amp;      0       &amp;                   -\frac{v_N}{(R_N + h)^2}                   \left[ \frac{1}{\text{m} \cdot \text{s}} \right] &amp;  &amp;  \mathbf{0}_3                   &amp;  &amp;  &amp; \mathbf{C}_b^n \left[ - \right] &amp; \\
       \omega_{in,2}^{n} \left[ \frac{\text{rad}}{\text{s}} \right] &amp; -\omega_{in,1}^{n} \left[ \frac{\text{rad}}{\text{s}} \right] &amp;          0                                                    &amp;                             0                                                              &amp;                 \frac{\tan{\phi}}{R_E + h}                \left[ \frac{1}{\text{m}} \right] &amp;                       0                                                        &amp;                  \omega_{ie}\cos{\phi} + \frac{v_E}{(R_E + h)\cos^2{\phi}}                  \left[ \frac{\text{rad}}{\text{s}} \right] &amp;      0       &amp;              -\frac{v_E \tan{\phi}}{(R_E + h)^2}             \left[ \frac{1}{\text{m} \cdot \text{s}} \right] &amp;  &amp;                                 &amp;  &amp;  &amp;                                 &amp; \\
               0                                                    &amp;         f_D        \left[ \frac{\text{m}}{\text{s}^2} \right] &amp;        -f_E        \left[ \frac{\text{m}}{\text{s}^2} \right] &amp;                    \frac{v_D}{R_N + h}                   \left[ \frac{1}{\text{s}} \right] &amp; -2\frac{v_E \tan{\phi}}{R_E + h} - 2\omega_{ie}\sin{\phi} \left[ \frac{1}{\text{s}} \right] &amp;              \frac{v_N}{R_N + h}             \left[ \frac{1}{\text{s}} \right] &amp;                -\frac{v_E^2}{(R_E+h)\cos^2{\phi}}-2v_E\omega_{ie}\cos{\phi}                 \left[ \frac{\text{m}}{\text{s}^2} \right] &amp;      0       &amp; \frac{v_E^2\tan{\phi}}{(R_E+h)^2} - \frac{v_Nv_D}{(R_N+h)^2} \left[ \frac{1}{\text{s}^2} \right]              &amp;  &amp;                                 &amp;  &amp;  &amp;                                 &amp; \\
             -f_D        \left[ \frac{\text{m}}{\text{s}^2} \right] &amp;          0                                                    &amp;         f_N        \left[ \frac{\text{m}}{\text{s}^2} \right] &amp;  \frac{v_E \tan{\phi}}{R_E + h} + 2\omega_{ie}\sin{\phi} \left[ \frac{1}{\text{s}} \right] &amp;            \frac{v_N \tan{\phi} + v_D}{R_E + h}           \left[ \frac{1}{\text{s}} \right] &amp; \frac{v_E}{R_E + h} + 2\omega_{ie}\cos{\phi} \left[ \frac{1}{\text{s}} \right] &amp; \frac{v_N v_E}{(R_E+h)\cos^2{\phi}} + 2v_N\omega_{ie}\cos{\phi} - 2v_D\omega_{ie}\sin{\phi} \left[ \frac{\text{m}}{\text{s}^2} \right] &amp;      0       &amp;        -\frac{v_Nv_E\tan{\phi} + v_Ev_D}{(R_E + h)^2}        \left[ \frac{1}{\text{s}^2} \right]              &amp;  &amp; \mathbf{C}_b^n \left[ - \right] &amp;  &amp;  &amp;  \mathbf{0}_3                   &amp; \\
              f_E        \left[ \frac{\text{m}}{\text{s}^2} \right] &amp;        -f_N        \left[ \frac{\text{m}}{\text{s}^2} \right] &amp;          0                                                    &amp;                  -\frac{2v_N}{R_N + h}                   \left[ \frac{1}{\text{s}} \right] &amp;       -\frac{2v_E}{R_E + h} - 2\omega_{ie}\cos{\phi}      \left[ \frac{1}{\text{s}} \right] &amp;                       0                                                        &amp;                                  2v_E\omega_{ie}\sin{\phi}                                  \left[ \frac{\text{m}}{\text{s}^2} \right] &amp;      0       &amp;     \frac{v_E^2}{(R_E + h)^2} + \frac{v_N^2}{(R_N + h)^2}    \left[ \frac{1}{\text{s}^2} \right]              &amp;  &amp;                                 &amp;  &amp;  &amp;                                 &amp; \\
                                                                    &amp;                                                               &amp;                                                               &amp;                      \frac{1}{R_N+h}                     \left[ \frac{1}{\text{m}} \right] &amp;                             0                                                               &amp;                       0                                                        &amp;                                             0                                                                                          &amp;      0       &amp;                   -\frac{v_N}{(R_N + h)^2}                   \left[ \frac{1}{\text{m} \cdot \text{s}} \right] &amp;  &amp;                                 &amp;  &amp;  &amp;                                 &amp; \\
                                                                    &amp;    \mathbf{0}_3                                               &amp;                                                               &amp;                             0                                                              &amp;                \frac{1}{(R_E+h)\cos{\phi}}                \left[ \frac{1}{\text{m}} \right] &amp;                       0                                                        &amp;                           \frac{v_E\tan{\phi}}{(R_E+h)\cos{\phi}}                           \left[ \frac{1}{\text{s}} \right]          &amp;      0       &amp;              -\frac{v_E}{(R_E + h)^2\cos{\phi}}              \left[ \frac{1}{\text{m} \cdot \text{s}} \right] &amp;  &amp;  \mathbf{0}_3                   &amp;  &amp;  &amp;  \mathbf{0}_3                   &amp; \\
                                                                    &amp;                                                               &amp;                                                               &amp;                             0                                                              &amp;                             0                                                               &amp;                      -1                      \left[ - \right]                  &amp;                                             0                                                                                          &amp;      0       &amp;                               0                                                                               &amp;  &amp;                                 &amp;  &amp;  &amp;                                 &amp; \\
                                                                    &amp;                                                               &amp;                                                               &amp;                                                                                            &amp;                                                                                             &amp;                                                                                &amp;                                                                                                                                        &amp;              &amp;                                                                                                               &amp;  &amp;                                 &amp;  &amp;  &amp;                                 &amp; \\
                                                                    &amp;    \mathbf{0}_3                                               &amp;                                                               &amp;                                                                                            &amp;                       \mathbf{0}_3                                                          &amp;                                                                                &amp;                                                                                                                                        &amp; \mathbf{0}_3 &amp;                                                                                                               &amp;  &amp;  \mathbf{0}_3                   &amp;  &amp;  &amp;  \mathbf{0}_3                   &amp; \\
                                                                    &amp;                                                               &amp;                                                               &amp;                                                                                            &amp;                                                                                             &amp;                                                                                &amp;                                                                                                                                        &amp;              &amp;                                                                                                               &amp;  &amp;                                 &amp;  &amp;  &amp;                                 &amp; \\
                                                                    &amp;                                                               &amp;                                                               &amp;                                                                                            &amp;                                                                                             &amp;                                                                                &amp;                                                                                                                                        &amp;              &amp;                                                                                                               &amp;  &amp;                                 &amp;  &amp;  &amp;                                 &amp; \\
                                                                    &amp;    \mathbf{0}_3                                               &amp;                                                               &amp;                                                                                            &amp;                       \mathbf{0}_3                                                          &amp;                                                                                &amp;                                                                                                                                        &amp; \mathbf{0}_3 &amp;                                                                                                               &amp;  &amp;  \mathbf{0}_3                   &amp;  &amp;  &amp;  \mathbf{0}_3                   &amp; \\
                                                                    &amp;                                                               &amp;                                                               &amp;                                                                                            &amp;                                                                                             &amp;                                                                                &amp;                                                                                                                                        &amp;              &amp;                                                                                                               &amp;  &amp;                                 &amp;  &amp;  &amp;                                 &amp; \\
    };

    \foreach \r in {1,3,4,6,7,9} {
      \foreach \c in {1,3,4,6,7,9,10,12,13,15} {
        \coordinate (m-\r-\c-nw) at (100,-100);
        \coordinate (m-\r-\c-se) at (-100,100);

        \foreach \row in {1,...,9} {
          \path let \p1=(m-\row-\c.west), \p2=(m-\r-\c-nw) in coordinate (m-\r-\c-nw) at ({min(\x1,\x2)},\y2);
          \path let \p1=(m-\row-\c.east), \p2=(m-\r-\c-se) in coordinate (m-\r-\c-se) at ({max(\x1,\x2)},\y2);
        }
        \foreach \col in {1,...,15} {
          \path let \p1=(m-\r-\col.north), \p2=(m-\r-\c-nw) in coordinate (m-\r-\c-nw) at (\x2,{max(\y1,\y2)});
          \path let \p1=(m-\r-\col.south), \p2=(m-\r-\c-se) in coordinate (m-\r-\c-se) at (\x2,{min(\y1,\y2)});
        }
      }
    }

    \path let \p1=(m-1-1-nw), \p2=(m-1-15-se) in coordinate (m-1-15-ne) at (\x2,\y1);
    \draw[decorate,transform canvas={yshift=.5em},thick] (m-1-1-nw) -- node[above=2pt] {$\mathbf{F}$} (m-1-15-ne);

    \begin{pgfonlayer}{background}
      \fhighlight[green!20]{m-1-1-nw}{m-3-3-se}
      \fhighlight[yellow!20]{m-1-4-nw}{m-3-6-se}
      \fhighlight[lime!20]{m-1-7-nw}{m-3-9-se}
      \fhighlight[orange!20]{m-1-13-nw}{m-3-15-se}
      \fhighlight[purple!20]{m-4-1-nw}{m-6-3-se}
      \fhighlight[blue!20]{m-4-4-nw}{m-6-6-se}
      \fhighlight[violet!20]{m-4-7-nw}{m-6-9-se}
      \fhighlight[red!20]{m-4-10-nw}{m-6-12-se}
      \fhighlight[teal!20]{m-7-4-nw}{m-9-6-se}
      \fhighlight[cyan!20]{m-7-7-nw}{m-9-9-se}
    \end{pgfonlayer}
  \end{tikzpicture}
  \cdot
  \begin{tikzpicture}[baseline=-\the\dimexpr\fontdimen22\textfont2\relax,decoration=brace]
    \matrix (m)[matrix of math nodes,left delimiter={(},right delimiter={)},row sep=0.3em, column sep=0.1em,
                nodes={rectangle,text width=1.6em,align=center,minimum height=2.3em,anchor=center},] {
      \delta R              &amp; \left[ \text{rad} \right]                  \\
      \delta P              &amp; \left[ \text{rad} \right]                  \\
      \delta Y              &amp; \left[ \text{rad} \right]                  \\
      \delta v_{N}          &amp; \left[ \frac{\text{m}}{\text{s}} \right]   \\
      \delta v_{E}          &amp; \left[ \frac{\text{m}}{\text{s}} \right]   \\
      \delta v_{D}          &amp; \left[ \frac{\text{m}}{\text{s}} \right]   \\
      \delta \phi           &amp; \left[ \text{rad} \right]                  \\
      \delta \lambda        &amp; \left[ \text{rad} \right]                  \\
      \delta h              &amp; \left[ \text{m} \right]                    \\
      \delta f_{x}^{b}      &amp; \left[ \frac{\text{m}}{\text{s}^2} \right] \\
      \delta f_{y}^{b}      &amp; \left[ \frac{\text{m}}{\text{s}^2} \right] \\
      \delta f_{z}^{b}      &amp; \left[ \frac{\text{m}}{\text{s}^2} \right] \\
      \delta \omega_{x}^{b} &amp; \left[ \frac{\text{rad}}{\text{s}} \right] \\
      \delta \omega_{y}^{b} &amp; \left[ \frac{\text{rad}}{\text{s}} \right] \\
      \delta \omega_{z}^{b} &amp; \left[ \frac{\text{rad}}{\text{s}} \right] \\
    };
    \draw[decorate,transform canvas={yshift=.5em},thick] (m-1-1.north west) -- node[above=2pt] {$\boldsymbol{\delta} x\mathbf{}$} (m-1-2.north east);

    \begin{pgfonlayer}{background}
      \fhighlight[green!20]{m-1-1}{m-3-1}
      \fhighlight[blue!20]{m-4-1}{m-6-1}
      \fhighlight[cyan!20]{m-7-1}{m-9-1}
      \fhighlight[red!20]{m-10-1}{m-12-1}
      \fhighlight[orange!20]{m-13-1}{m-15-1}
    \end{pgfonlayer}
  \end{tikzpicture}
\end{equation}" src="form_292.svg" width="2504" height="711"/></picture>
</p>
<p>When scaling elements in <picture><source srcset="form_293_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \boldsymbol{\delta} \mathbf{x} $" src="form_293.svg" width="21" height="16"/></picture> the relevant parts of the <picture><source srcset="form_150_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \mathbf{F} $" src="form_150.svg" width="12" height="14"/></picture> matrix have to be scaled as well.</p>
<p><a class="anchor" id="eq-LCKF_n-stateMatrix-units-scaled"></a> </p><p class="formulaDsp">
<picture><source srcset="form_294_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-LCKF_n-stateMatrix-units-scaled}
  \begin{tikzpicture}[baseline=-\the\dimexpr\fontdimen22\textfont2\relax,decoration=brace]
    \matrix (m)[matrix of math nodes,left delimiter={(},right delimiter={)},
                nodes={rectangle,text width=2.4em,align=center,minimum height=2.3em,anchor=center},row sep=0.3em, column sep=0.1em,] {
      \delta \dotup{R}              &amp; \left[ \highlight[red!60]{\frac{\text{deg}}{\text{s}}} \right]    \\
      \delta \dotup{P}              &amp; \left[ \highlight[red!60]{\frac{\text{deg}}{\text{s}}} \right]    \\
      \delta \dotup{Y}              &amp; \left[ \highlight[red!60]{\frac{\text{deg}}{\text{s}}} \right]    \\
      \delta \dotup{v}_{N}          &amp; \left[ \frac{\text{m}}{\text{s}^2} \right]                        \\
      \delta \dotup{v}_{E}          &amp; \left[ \frac{\text{m}}{\text{s}^2} \right]                        \\
      \delta \dotup{v}_{D}          &amp; \left[ \frac{\text{m}}{\text{s}^2} \right]                        \\
      \delta \dotup{\phi}           &amp; \left[ \highlight[red!60]{\frac{\text{m'}}{\text{s}}} \right]     \\
      \delta \dotup{\lambda}        &amp; \left[ \highlight[red!60]{\frac{\text{m'}}{\text{s}}} \right]     \\
      \delta \dotup{h}              &amp; \left[ \frac{\text{m}}{\text{s}} \right]                          \\
      \delta \dotup{f}_{x}^{b}      &amp; \left[ \highlight[red!60]{\frac{\text{mg}}{\text{s}}} \right]     \\
      \delta \dotup{f}_{y}^{b}      &amp; \left[ \highlight[red!60]{\frac{\text{mg}}{\text{s}}} \right]     \\
      \delta \dotup{f}_{z}^{b}      &amp; \left[ \highlight[red!60]{\frac{\text{mg}}{\text{s}}} \right]     \\
      \delta \dotup{\omega}_{x}^{b} &amp; \left[ \highlight[red!60]{\frac{\text{mrad}}{\text{s}^2}} \right] \\
      \delta \dotup{\omega}_{y}^{b} &amp; \left[ \highlight[red!60]{\frac{\text{mrad}}{\text{s}^2}} \right] \\
      \delta \dotup{\omega}_{z}^{b} &amp; \left[ \highlight[red!60]{\frac{\text{mrad}}{\text{s}^2}} \right] \\
    };
    \draw[decorate,transform canvas={yshift=.5em},thick] (m-1-1.north west) -- node[above=2pt] {$\boldsymbol{\delta} \mathbf{\dot{x}}$} (m-1-2.north east);

    \begin{pgfonlayer}{background}
      \fhighlight[green!20]{m-1-1}{m-3-1}
      \fhighlight[blue!20]{m-4-1}{m-6-1}
      \fhighlight[cyan!20]{m-7-1}{m-9-1}
      \fhighlight[red!20]{m-10-1}{m-12-1}
      \fhighlight[orange!20]{m-13-1}{m-15-1}
    \end{pgfonlayer}
  \end{tikzpicture}
  =
  \quad
  \begin{tikzpicture}[baseline=-\the\dimexpr\fontdimen22\textfont2\relax,decoration=brace]
    \matrix (m)[matrix of math nodes,left delimiter={(},right delimiter={)},nodes in empty cells,
                row sep=0.3em, column sep=0.4em,
                nodes={rectangle,minimum height=2.3em,anchor=center},] {
               0                                                    &amp;  \omega_{in,3}^{n} \left[ \frac{\text{rad}}{\text{s}} \right] &amp; -\omega_{in,2}^{n} \left[ \frac{\text{rad}}{\text{s}} \right] &amp;                             0                                                              &amp;                    -\frac{1}{R_E + h}                     \left[ \frac{1}{\text{m}} \right] &amp;                       0                                                        &amp;                                    \omega_{ie}\sin{\phi}                                    \left[ \frac{\text{rad}}{\text{s}} \right] &amp;      0       &amp;                    \frac{v_E}{(R_E + h)^2}                   \left[ \frac{1}{\text{m} \cdot \text{s}} \right] &amp;  &amp;                                 &amp;  &amp;  &amp;                                 &amp; \\
      -\omega_{in,3}^{n} \left[ \frac{\text{rad}}{\text{s}} \right] &amp;          0                                                    &amp;  \omega_{in,1}^{n} \left[ \frac{\text{rad}}{\text{s}} \right] &amp;                    \frac{1}{R_N + h}                     \left[ \frac{1}{\text{m}} \right] &amp;                             0                                                               &amp;                       0                                                        &amp;                                             0                                                                                          &amp;      0       &amp;                   -\frac{v_N}{(R_N + h)^2}                   \left[ \frac{1}{\text{m} \cdot \text{s}} \right] &amp;  &amp;  \mathbf{0}_3                   &amp;  &amp;  &amp; \mathbf{C}_b^n \left[ - \right] &amp; \\
       \omega_{in,2}^{n} \left[ \frac{\text{rad}}{\text{s}} \right] &amp; -\omega_{in,1}^{n} \left[ \frac{\text{rad}}{\text{s}} \right] &amp;          0                                                    &amp;                             0                                                              &amp;                 \frac{\tan{\phi}}{R_E + h}                \left[ \frac{1}{\text{m}} \right] &amp;                       0                                                        &amp;                  \omega_{ie}\cos{\phi} + \frac{v_E}{(R_E + h)\cos^2{\phi}}                  \left[ \frac{\text{rad}}{\text{s}} \right] &amp;      0       &amp;              -\frac{v_E \tan{\phi}}{(R_E + h)^2}             \left[ \frac{1}{\text{m} \cdot \text{s}} \right] &amp;  &amp;                                 &amp;  &amp;  &amp;                                 &amp; \\
               0                                                    &amp;         f_D        \left[ \frac{\text{m}}{\text{s}^2} \right] &amp;        -f_E        \left[ \frac{\text{m}}{\text{s}^2} \right] &amp;                    \frac{v_D}{R_N + h}                   \left[ \frac{1}{\text{s}} \right] &amp; -2\frac{v_E \tan{\phi}}{R_E + h} - 2\omega_{ie}\sin{\phi} \left[ \frac{1}{\text{s}} \right] &amp;              \frac{v_N}{R_N + h}             \left[ \frac{1}{\text{s}} \right] &amp;                -\frac{v_E^2}{(R_E+h)\cos^2{\phi}}-2v_E\omega_{ie}\cos{\phi}                 \left[ \frac{\text{m}}{\text{s}^2} \right] &amp;      0       &amp; \frac{v_E^2\tan{\phi}}{(R_E+h)^2} - \frac{v_Nv_D}{(R_N+h)^2} \left[ \frac{1}{\text{s}^2} \right]              &amp;  &amp;                                 &amp;  &amp;  &amp;                                 &amp; \\
             -f_D        \left[ \frac{\text{m}}{\text{s}^2} \right] &amp;          0                                                    &amp;         f_N        \left[ \frac{\text{m}}{\text{s}^2} \right] &amp;  \frac{v_E \tan{\phi}}{R_E + h} + 2\omega_{ie}\sin{\phi} \left[ \frac{1}{\text{s}} \right] &amp;            \frac{v_N \tan{\phi} + v_D}{R_E + h}           \left[ \frac{1}{\text{s}} \right] &amp; \frac{v_E}{R_E + h} + 2\omega_{ie}\cos{\phi} \left[ \frac{1}{\text{s}} \right] &amp; \frac{v_N v_E}{(R_E+h)\cos^2{\phi}} + 2v_N\omega_{ie}\cos{\phi} - 2v_D\omega_{ie}\sin{\phi} \left[ \frac{\text{m}}{\text{s}^2} \right] &amp;      0       &amp;        -\frac{v_Nv_E\tan{\phi} + v_Ev_D}{(R_E + h)^2}        \left[ \frac{1}{\text{s}^2} \right]              &amp;  &amp; \mathbf{C}_b^n \left[ - \right] &amp;  &amp;  &amp;  \mathbf{0}_3                   &amp; \\
              f_E        \left[ \frac{\text{m}}{\text{s}^2} \right] &amp;        -f_N        \left[ \frac{\text{m}}{\text{s}^2} \right] &amp;          0                                                    &amp;                  -\frac{2v_N}{R_N + h}                   \left[ \frac{1}{\text{s}} \right] &amp;       -\frac{2v_E}{R_E + h} - 2\omega_{ie}\cos{\phi}      \left[ \frac{1}{\text{s}} \right] &amp;                       0                                                        &amp;                                  2v_E\omega_{ie}\sin{\phi}                                  \left[ \frac{\text{m}}{\text{s}^2} \right] &amp;      0       &amp;     \frac{v_E^2}{(R_E + h)^2} + \frac{v_N^2}{(R_N + h)^2}    \left[ \frac{1}{\text{s}^2} \right]              &amp;  &amp;                                 &amp;  &amp;  &amp;                                 &amp; \\
                                                                    &amp;                                                               &amp;                                                               &amp;                      \frac{1}{R_N+h}                     \left[ \frac{1}{\text{m}} \right] &amp;                             0                                                               &amp;                       0                                                        &amp;                                             0                                                                                          &amp;      0       &amp;                   -\frac{v_N}{(R_N + h)^2}                   \left[ \frac{1}{\text{m} \cdot \text{s}} \right] &amp;  &amp;                                 &amp;  &amp;  &amp;                                 &amp; \\
                                                                    &amp;    \mathbf{0}_3                                               &amp;                                                               &amp;                             0                                                              &amp;                \frac{1}{(R_E+h)\cos{\phi}}                \left[ \frac{1}{\text{m}} \right] &amp;                       0                                                        &amp;                           \frac{v_E\tan{\phi}}{(R_E+h)\cos{\phi}}                           \left[ \frac{1}{\text{s}} \right]          &amp;      0       &amp;              -\frac{v_E}{(R_E + h)^2\cos{\phi}}              \left[ \frac{1}{\text{m} \cdot \text{s}} \right] &amp;  &amp;  \mathbf{0}_3                   &amp;  &amp;  &amp;  \mathbf{0}_3                   &amp; \\
                                                                    &amp;                                                               &amp;                                                               &amp;                             0                                                              &amp;                             0                                                               &amp;                      -1                      \left[ - \right]                  &amp;                                             0                                                                                          &amp;      0       &amp;                               0                                                                               &amp;  &amp;                                 &amp;  &amp;  &amp;                                 &amp; \\
                                                                    &amp;                                                               &amp;                                                               &amp;                                                                                            &amp;                                                                                             &amp;                                                                                &amp;                                                                                                                                        &amp;              &amp;                                                                                                               &amp;  &amp;                                 &amp;  &amp;  &amp;                                 &amp; \\
                                                                    &amp;    \mathbf{0}_3                                               &amp;                                                               &amp;                                                                                            &amp;                       \mathbf{0}_3                                                          &amp;                                                                                &amp;                                                                                                                                        &amp; \mathbf{0}_3 &amp;                                                                                                               &amp;  &amp;  \mathbf{0}_3                   &amp;  &amp;  &amp;  \mathbf{0}_3                   &amp; \\
                                                                    &amp;                                                               &amp;                                                               &amp;                                                                                            &amp;                                                                                             &amp;                                                                                &amp;                                                                                                                                        &amp;              &amp;                                                                                                               &amp;  &amp;                                 &amp;  &amp;  &amp;                                 &amp; \\
                                                                    &amp;                                                               &amp;                                                               &amp;                                                                                            &amp;                                                                                             &amp;                                                                                &amp;                                                                                                                                        &amp;              &amp;                                                                                                               &amp;  &amp;                                 &amp;  &amp;  &amp;                                 &amp; \\
                                                                    &amp;    \mathbf{0}_3                                               &amp;                                                               &amp;                                                                                            &amp;                       \mathbf{0}_3                                                          &amp;                                                                                &amp;                                                                                                                                        &amp; \mathbf{0}_3 &amp;                                                                                                               &amp;  &amp;  \mathbf{0}_3                   &amp;  &amp;  &amp;  \mathbf{0}_3                   &amp; \\
                                                                    &amp;                                                               &amp;                                                               &amp;                                                                                            &amp;                                                                                             &amp;                                                                                &amp;                                                                                                                                        &amp;              &amp;                                                                                                               &amp;  &amp;                                 &amp;  &amp;  &amp;                                 &amp; \\
    };

    \foreach \r in {1,3,4,6,7,8,9,10,12,13,15} {
      \foreach \c in {1,3,4,6,7,8,9,10,12,13,15} {
        \coordinate (m-\r-\c-nw) at (100,-100);
        \coordinate (m-\r-\c-ne) at (-100,-100);
        \coordinate (m-\r-\c-se) at (-100,100);
        \coordinate (m-\r-\c-sw) at (100,100);

        \foreach \row in {1,...,9} {
          \path let \p1=(m-\row-\c.west), \p2=(m-\r-\c-nw) in coordinate (m-\r-\c-nw) at ({min(\x1,\x2)},\y2);
          \path let \p1=(m-\row-\c.east), \p2=(m-\r-\c-ne) in coordinate (m-\r-\c-ne) at ({max(\x1,\x2)},\y2);
          \path let \p1=(m-\row-\c.east), \p2=(m-\r-\c-se) in coordinate (m-\r-\c-se) at ({max(\x1,\x2)},\y2);
          \path let \p1=(m-\row-\c.west), \p2=(m-\r-\c-sw) in coordinate (m-\r-\c-sw) at ({min(\x1,\x2)},\y2);
        }
        \foreach \col in {1,...,15} {
          \path let \p1=(m-\r-\col.north), \p2=(m-\r-\c-nw) in coordinate (m-\r-\c-nw) at (\x2,{max(\y1,\y2)});
          \path let \p1=(m-\r-\col.north), \p2=(m-\r-\c-ne) in coordinate (m-\r-\c-ne) at (\x2,{max(\y1,\y2)});
          \path let \p1=(m-\r-\col.south), \p2=(m-\r-\c-se) in coordinate (m-\r-\c-se) at (\x2,{min(\y1,\y2)});
          \path let \p1=(m-\r-\col.south), \p2=(m-\r-\c-sw) in coordinate (m-\r-\c-sw) at (\x2,{min(\y1,\y2)});
        }
      }
    }

    \draw[decorate,transform canvas={yshift=.5em},thick] (m-1-1-nw) -- node[above=2pt] {$\mathbf{F}$} (m-1-15-ne);

    \draw[decorate,transform canvas={xshift=-1.4em},thick,red] (m-3-1-sw) -- node[left=2pt] {$ \times \frac{180}{\pi} $} (m-1-1-nw);
    \draw[decorate,transform canvas={xshift=-1.4em},thick,red] (m-8-1-sw) -- node[left=2pt] {$ \times R_0 $} (m-7-1-nw);
    \draw[decorate,transform canvas={xshift=-1.4em},thick,red] (m-12-1-sw) -- node[left=2pt] {$ \times \frac{10^3}{g} $} (m-10-1-nw);
    \draw[decorate,transform canvas={xshift=-1.4em},thick,red] (m-15-1-sw) -- node[left=2pt] {$ \times 10^3 $} (m-13-1-nw);

    \draw[decorate,transform canvas={yshift=1.1em},thick,red] (m-1-1-nw) -- node[above=2pt] {$ \times \frac{\pi}{180} $} (m-1-3-ne);
    \draw[decorate,transform canvas={yshift=1.1em},thick,red] (m-1-7-nw) -- node[above=2pt] {$ \times \frac{1}{R_0} $} (m-1-8-ne);
    \draw[decorate,transform canvas={yshift=1.1em},thick,red] (m-1-10-nw) -- node[above=2pt] {$ \times \frac{g}{10^3} $} (m-1-12-ne);
    \draw[decorate,transform canvas={yshift=1.1em},thick,red] (m-1-13-nw) -- node[above=2pt] {$ \times 10^{-3} $} (m-1-15-ne);

    \begin{pgfonlayer}{background}
      \fhighlight[green!20]{m-1-1-nw}{m-3-3-se}
      \fhighlight[yellow!20]{m-1-4-nw}{m-3-6-se}
      \fhighlight[lime!20]{m-1-7-nw}{m-3-9-se}
      \fhighlight[orange!20]{m-1-13-nw}{m-3-15-se}
      \fhighlight[purple!20]{m-4-1-nw}{m-6-3-se}
      \fhighlight[blue!20]{m-4-4-nw}{m-6-6-se}
      \fhighlight[violet!20]{m-4-7-nw}{m-6-9-se}
      \fhighlight[red!20]{m-4-10-nw}{m-6-12-se}
      \fhighlight[teal!20]{m-7-4-nw}{m-9-6-se}
      \fhighlight[cyan!20]{m-7-7-nw}{m-9-9-se}
    \end{pgfonlayer}
  \end{tikzpicture}
  \cdot
  \begin{tikzpicture}[baseline=-\the\dimexpr\fontdimen22\textfont2\relax,decoration=brace]
    \matrix (m)[matrix of math nodes,left delimiter={(},right delimiter={)},row sep=0.3em, column sep=0.1em,
                nodes={rectangle,text width=2.4em,align=center,minimum height=2.3em,anchor=center},] {
      \delta R              &amp; \left[ \highlight[red!60]{\text{deg}} \right]                   \\
      \delta P              &amp; \left[ \highlight[red!60]{\text{deg}} \right]                   \\
      \delta Y              &amp; \left[ \highlight[red!60]{\text{deg}} \right]                   \\
      \delta v_{N}          &amp; \left[ \frac{\text{m}}{\text{s}} \right]                        \\
      \delta v_{E}          &amp; \left[ \frac{\text{m}}{\text{s}} \right]                        \\
      \delta v_{D}          &amp; \left[ \frac{\text{m}}{\text{s}} \right]                        \\
      \delta \phi           &amp; \left[ \highlight[red!60]{\text{m'}} \right]                    \\
      \delta \lambda        &amp; \left[ \highlight[red!60]{\text{m'}} \right]                    \\
      \delta h              &amp; \left[ \text{m} \right]                                         \\
      \delta f_{x}^{b}      &amp; \left[ \highlight[red!60]{\text{mg}} \right]                    \\
      \delta f_{y}^{b}      &amp; \left[ \highlight[red!60]{\text{mg}} \right]                    \\
      \delta f_{z}^{b}      &amp; \left[ \highlight[red!60]{\text{mg}} \right]                    \\
      \delta \omega_{x}^{b} &amp; \left[ \highlight[red!60]{\frac{\text{mrad}}{\text{s}}} \right] \\
      \delta \omega_{y}^{b} &amp; \left[ \highlight[red!60]{\frac{\text{mrad}}{\text{s}}} \right] \\
      \delta \omega_{z}^{b} &amp; \left[ \highlight[red!60]{\frac{\text{mrad}}{\text{s}}} \right] \\
    };
    \draw[decorate,transform canvas={yshift=.5em},thick] (m-1-1.north west) -- node[above=2pt] {$\boldsymbol{\delta} \mathbf{x}$} (m-1-2.north east);

    \begin{pgfonlayer}{background}
      \fhighlight[green!20]{m-1-1}{m-3-1}
      \fhighlight[blue!20]{m-4-1}{m-6-1}
      \fhighlight[cyan!20]{m-7-1}{m-9-1}
      \fhighlight[red!20]{m-10-1}{m-12-1}
      \fhighlight[orange!20]{m-13-1}{m-15-1}
    \end{pgfonlayer}
  \end{tikzpicture}
\end{equation}" src="form_294.svg" width="2555" height="753"/></picture>
</p>
<p>The unit <picture><source srcset="form_295_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ m' $" src="form_295.svg" width="19" height="16"/></picture> is [pseudometre] and is latitude or longitude converted from radian into metre by multiplying it with the Earth radius. However the radius is assumed as a constant for the conversion.</p>
<h2><a class="anchor" id="LooselyCoupledKF_n-Units-beta-G"></a>
Gauss-Markov constant ùõΩ &amp; Noise scale matrix G</h2>
<p><a class="anchor" id="eq-LCKF_n-Units-noise"></a> </p><p class="formulaDsp">
<picture><source srcset="form_296_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-LCKF_n-Units-noise}
  \begin{tikzpicture}[baseline=-\the\dimexpr\fontdimen22\textfont2\relax,decoration=brace]
    \matrix (m)[matrix of math nodes,nodes in empty cells,left delimiter={(},right delimiter={)},
                nodes={rectangle,text width=1.8em,align=center},row sep=0.3em, column sep=0.1em] {
      \boldsymbol{\delta \dot{\psi}}                                     &amp; \left[ \frac{\text{rad}}{\text{s}} \right]   \\
      \boldsymbol{\delta \dot{v}}^{n}                                    &amp; \left[ \frac{\text{m}}{\text{s}^2} \right]   \\
      \boldsymbol{\delta \dot{p}}_b                                      &amp; \dots                                        \\
      \boldsymbol{\delta \dot{f}}^{\raise-0.45ex\hbox{$\scriptstyle b$}} &amp; \left[ \frac{\text{m}}{\text{s}^3} \right]   \\
      \boldsymbol{\delta \dot{\omega}}_{ib}^b                            &amp; \left[ \frac{\text{rad}}{\text{s}^2} \right] \\
    };
    \draw[decorate,transform canvas={yshift=0.6em},thick] (m-1-1.north west) -- node[above=2pt] {$\boldsymbol{\delta} \mathbf{\dot{x}}$} ($ (m-1-2.north east) + (0,1pt) $);

    \begin{pgfonlayer}{background}
      \fhighlight[green!20]{m-1-1}{m-1-1}
      \fhighlight[blue!20]{m-2-1}{m-2-1}
      \fhighlight[cyan!20]{m-3-1}{m-3-1}
      \fhighlight[red!20]{m-4-1}{m-4-1}
      \fhighlight[orange!20]{m-5-1}{m-5-1}
    \end{pgfonlayer}
  \end{tikzpicture}
  =
  \begin{tikzpicture}[baseline=-\the\dimexpr\fontdimen22\textfont2\relax,decoration=brace]
    \matrix (m)[matrix of math nodes,left delimiter={(},right delimiter={)},
                nodes={rectangle,text width=3em,align=center},row sep=0.3em, column sep=0.4em]
    {
          \dots    &amp;     \dots    &amp;     \dots    &amp;        \dots                                           &amp;           \dots                                              \\
          \dots    &amp;     \dots    &amp;     \dots    &amp;        \dots                                           &amp;           \dots                                              \\
          \dots    &amp;     \dots    &amp;     \dots    &amp;        \dots                                           &amp;           \dots                                              \\
      \mathbf{0}_3 &amp; \mathbf{0}_3 &amp; \mathbf{0}_3 &amp; \boldsymbol{\beta}_f \left[ \frac{1}{\text{s}} \right] &amp;        \mathbf{0}_3                                          \\
      \mathbf{0}_3 &amp; \mathbf{0}_3 &amp; \mathbf{0}_3 &amp;    \mathbf{0}_3                                        &amp;  \boldsymbol{\beta}_\omega \left[ \frac{1}{\text{s}} \right] \\
    };
    \draw[decorate,transform canvas={yshift=.5em},thick] (m-1-1.north west) -- node[above=2pt] {$\mathbf{F}$} (m-1-5.north east);

    \begin{pgfonlayer}{background}
      \fhighlight[magenta!20]{m-4-4}{m-4-4}
      \fhighlight[olive!20]{m-5-5}{m-5-5}
    \end{pgfonlayer}
  \end{tikzpicture}
  \cdot
  \begin{tikzpicture}[baseline=-\the\dimexpr\fontdimen22\textfont2\relax,decoration=brace]
    \matrix (m)[matrix of math nodes,nodes in empty cells,left delimiter={(},right delimiter={)},
                nodes={rectangle,text width=1.8em,align=center},row sep=0.3em, column sep=0.1em] {
      \boldsymbol{\delta \psi}          &amp; \left[ \text{rad} \right]                  \\
      \boldsymbol{\delta v}^{n}         &amp; \left[ \frac{\text{m}}{\text{s}} \right]   \\
      \boldsymbol{\delta p}_b           &amp; \dots                                      \\
      \boldsymbol{\delta f}^b           &amp; \left[ \frac{\text{m}}{\text{s}^2} \right] \\
      \boldsymbol{\delta \omega}_{ib}^b &amp; \left[ \frac{\text{rad}}{\text{s}} \right] \\
    };
    \draw[decorate,transform canvas={yshift=.5em},thick] (m-1-1.north west) -- node[above=2pt] {$\boldsymbol{\delta} \mathbf{x}$} (m-1-2.north east);

    \begin{pgfonlayer}{background}
      \fhighlight[green!20]{m-1-1}{m-1-1}
      \fhighlight[blue!20]{m-2-1}{m-2-1}
      \fhighlight[cyan!20]{m-3-1}{m-3-1}
      \fhighlight[red!20]{m-4-1}{m-4-1}
      \fhighlight[orange!20]{m-5-1}{m-5-1}
    \end{pgfonlayer}
  \end{tikzpicture}
  +
  \begin{tikzpicture}[baseline=-\the\dimexpr\fontdimen22\textfont2\relax,decoration=brace]
    \matrix (m)[matrix of math nodes,left delimiter={(},right delimiter={)},
                nodes={rectangle,text width=4.8em,align=center},row sep=0.3em, column sep=0.4em]
    {
      \mathbf{C}_b^n &amp; \mathbf{0}_3   &amp; \mathbf{0}_3 &amp; \mathbf{0}_3 \\
       \mathbf{0}_3   &amp; \mathbf{C}_b^n &amp; \mathbf{0}_3 &amp; \mathbf{0}_3 \\
       \mathbf{0}_3   &amp; \mathbf{0}_3   &amp; \mathbf{0}_3 &amp; \mathbf{0}_3 \\
       \mathbf{0}_3   &amp; \mathbf{0}_3   &amp; \mathbf{I}_3 &amp; \mathbf{0}_3 \\
       \mathbf{0}_3   &amp; \mathbf{0}_3   &amp; \mathbf{0}_3 &amp; \mathbf{I}_3 \\
    };
    \draw[decorate,transform canvas={yshift=.5em},thick] (m-1-1.north west) -- node[above=2pt] {$\mathbf{G}$} (m-1-2.north east);

    \begin{pgfonlayer}{background}
      \fhighlight[darkgray!20]{m-1-1}{m-1-1}
      \fhighlight[brown!20]{m-2-2}{m-2-2}
      \fhighlight[pink!20]{m-4-3}{m-4-3}
      \fhighlight[lightgray!20]{m-5-4}{m-5-4}
    \end{pgfonlayer}
  \end{tikzpicture}
  \cdot
  \mathbf{w} \left[ \frac{1}{\sqrt{\text{s}}} \right]
\end{equation}" src="form_296.svg" width="2090" height="221"/></picture>
</p>
<p>When scaling the biases in <picture><source srcset="form_293_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \boldsymbol{\delta} \mathbf{x} $" src="form_293.svg" width="21" height="16"/></picture> the <picture><source srcset="form_297_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \mathbf{\beta} $" src="form_297.svg" width="11" height="18"/></picture> factors stay unscaled. However the <picture><source srcset="form_151_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \mathbf{G} $" src="form_151.svg" width="16" height="14"/></picture> matrix has to be adapted.</p>
<p><a class="anchor" id="eq-LCKF_n-Units-noise-scaled"></a> </p><p class="formulaDsp">
<picture><source srcset="form_298_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-LCKF_n-Units-noise-scaled}
  \begin{tikzpicture}[baseline=-\the\dimexpr\fontdimen22\textfont2\relax,decoration=brace]
    \matrix (m)[matrix of math nodes,nodes in empty cells,left delimiter={(},right delimiter={)},
                nodes={rectangle,text width=2.4em,align=center},row sep=0.3em, column sep=0.1em] {
      \boldsymbol{\delta \dot{\psi}}                                     &amp; \left[ \highlight[red!60]{\text{deg}} \right]                     \\
      \boldsymbol{\delta \dot{v}}^{n}                                    &amp; \left[ \frac{\text{m}}{\text{s}^2} \right]                        \\
      \boldsymbol{\delta \dot{p}}_b                                      &amp; \dots                                                             \\
      \boldsymbol{\delta \dot{f}}^{\raise-0.45ex\hbox{$\scriptstyle b$}} &amp; \left[ \highlight[red!60]{\frac{\text{mg}}{\text{s}}} \right]     \\
      \boldsymbol{\delta \dot{\omega}}_{ib}^b                            &amp; \left[ \highlight[red!60]{\frac{\text{mrad}}{\text{s}^2}} \right] \\
    };
    \draw[decorate,transform canvas={yshift=0.5em},thick] (m-1-1.north west) -- node[above=2pt] {$\boldsymbol{\delta} \mathbf{\dot{x}}$} ($ (m-1-2.north east) - (0,2pt) $);

    \begin{pgfonlayer}{background}
      \fhighlight[green!20]{m-1-1}{m-1-1}
      \fhighlight[blue!20]{m-2-1}{m-2-1}
      \fhighlight[cyan!20]{m-3-1}{m-3-1}
      \fhighlight[red!20]{m-4-1}{m-4-1}
      \fhighlight[orange!20]{m-5-1}{m-5-1}
    \end{pgfonlayer}
  \end{tikzpicture}
  =
  \begin{tikzpicture}[baseline=-\the\dimexpr\fontdimen22\textfont2\relax,decoration=brace]
    \matrix (m)[matrix of math nodes,left delimiter={(},right delimiter={)},
                nodes={rectangle,text width=3em,align=center},row sep=0.3em, column sep=0.4em]
    {
          \dots    &amp;     \dots    &amp;     \dots    &amp;        \dots                                           &amp;           \dots                                              \\
          \dots    &amp;     \dots    &amp;     \dots    &amp;        \dots                                           &amp;           \dots                                              \\
          \dots    &amp;     \dots    &amp;     \dots    &amp;        \dots                                           &amp;           \dots                                              \\
      \mathbf{0}_3 &amp; \mathbf{0}_3 &amp; \mathbf{0}_3 &amp; \boldsymbol{\beta}_f \left[ \frac{1}{\text{s}} \right] &amp;        \mathbf{0}_3                                          \\
      \mathbf{0}_3 &amp; \mathbf{0}_3 &amp; \mathbf{0}_3 &amp;    \mathbf{0}_3                                        &amp;  \boldsymbol{\beta}_\omega \left[ \frac{1}{\text{s}} \right] \\
    };
    \draw[decorate,transform canvas={yshift=.5em},thick] (m-1-1.north west) -- node[above=2pt] {$\mathbf{F}$} (m-1-5.north east);

    \begin{pgfonlayer}{background}
      \fhighlight[magenta!20]{m-4-4}{m-4-4}
      \fhighlight[olive!20]{m-5-5}{m-5-5}
    \end{pgfonlayer}
  \end{tikzpicture}
  \cdot
  \begin{tikzpicture}[baseline=-\the\dimexpr\fontdimen22\textfont2\relax,decoration=brace]
    \matrix (m)[matrix of math nodes,nodes in empty cells,left delimiter={(},right delimiter={)},
                nodes={rectangle,text width=2.4em,align=center},row sep=0.3em, column sep=0.1em] {
      \boldsymbol{\delta \dot{\psi}}    &amp; \left[ \highlight[red!60]{\frac{\text{deg}}{\text{s}}} \right]  \\
      \boldsymbol{\delta \dot{v}}^{n}   &amp; \left[ \frac{\text{m}}{\text{s}^2} \right]   \\
      \boldsymbol{\delta \dot{p}}_b     &amp; \dots                                        \\
      \boldsymbol{\delta f}^b           &amp; \left[ \highlight[red!60]{\text{mg}} \right]                    \\
      \boldsymbol{\delta \omega}_{ib}^b &amp; \left[ \highlight[red!60]{\frac{\text{mrad}}{\text{s}}} \right] \\
    };
    \draw[decorate,transform canvas={yshift=.5em},thick] (m-1-1.north west) -- node[above=2pt] {$\boldsymbol{\delta} \mathbf{x}$} ($ (m-1-2.north east) - (0,3pt) $);

    \begin{pgfonlayer}{background}
      \fhighlight[green!20]{m-1-1}{m-1-1}
      \fhighlight[blue!20]{m-2-1}{m-2-1}
      \fhighlight[cyan!20]{m-3-1}{m-3-1}
      \fhighlight[red!20]{m-4-1}{m-4-1}
      \fhighlight[orange!20]{m-5-1}{m-5-1}
    \end{pgfonlayer}
  \end{tikzpicture}
  +
  \qquad
  \begin{tikzpicture}[baseline=-\the\dimexpr\fontdimen22\textfont2\relax,decoration=brace]
    \matrix (m)[matrix of math nodes,left delimiter={(},right delimiter={)},
                nodes={rectangle,text width=4.8em,align=center},row sep=0.3em, column sep=0.4em]
    {
      \mathbf{C}_b^n &amp; \mathbf{0}_3   &amp; \mathbf{0}_3 &amp; \mathbf{0}_3 \\
       \mathbf{0}_3   &amp; \mathbf{C}_b^n &amp; \mathbf{0}_3 &amp; \mathbf{0}_3 \\
       \mathbf{0}_3   &amp; \mathbf{0}_3   &amp; \mathbf{0}_3 &amp; \mathbf{0}_3 \\
       \mathbf{0}_3   &amp; \mathbf{0}_3   &amp; \mathbf{I}_3 &amp; \mathbf{0}_3 \\
       \mathbf{0}_3   &amp; \mathbf{0}_3   &amp; \mathbf{0}_3 &amp; \mathbf{I}_3 \\
    };
    \draw[decorate,transform canvas={yshift=.5em},thick] (m-1-1.north west) -- node[above=2pt] {$\mathbf{G}$} (m-1-4.north east);

    \draw[decorate,transform canvas={xshift=-1.4em},thick,red] (m-1-1.south west) -- node[left=2pt] {$ \times \frac{180}{\pi} $} (m-1-1.north west);
    \draw[decorate,transform canvas={xshift=-1.4em},thick,red] (m-4-1.south west) -- node[left=2pt] {$ \times \frac{10^3}{g} $} (m-4-1.north west);
    \draw[decorate,transform canvas={xshift=-1.4em},thick,red] (m-5-1.south west) -- node[left=2pt] {$ \times 10^3 $} (m-5-1.north west);

    \begin{pgfonlayer}{background}
      \fhighlight[darkgray!20]{m-1-1}{m-1-1}
      \fhighlight[brown!20]{m-2-2}{m-2-2}
      \fhighlight[pink!20]{m-4-3}{m-4-3}
      \fhighlight[lightgray!20]{m-5-4}{m-5-4}
    \end{pgfonlayer}
  \end{tikzpicture}
  \cdot
  \mathbf{w} \left[ \frac{1}{\sqrt{\text{s}}} \right]
\end{equation}" src="form_298.svg" width="2144" height="245"/></picture>
</p>
<p>If the noise input matrix <picture><source srcset="form_151_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \mathbf{G} $" src="form_151.svg" width="16" height="14"/></picture> is scaled, then the noise scale matrix <picture><source srcset="form_69_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \mathbf{W} $" src="form_69.svg" width="21" height="14"/></picture> does not have to be scaled.</p>
<h2><a class="anchor" id="LooselyCoupledKF_n-Units-Q"></a>
Process noise covariance matrix Q</h2>
<p>If the alternative process noise covariance matrix <picture><source srcset="form_75_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \mathbf{Q} $" src="form_75.svg" width="14" height="16"/></picture> is used, it also has to be scaled.</p>
<h2><a class="anchor" id="LooselyCoupledKF_n-Units-P"></a>
Error covariance matrix P</h2>
<p>The error covariance matrix is initialized as a diagonal matrix with the variance of the initial state as diagonal elements. Therefore the units are the squared units of the state vector.</p>
<p><a class="anchor" id="eq-LCKF_n-Units-P"></a> </p><p class="formulaDsp">
<picture><source srcset="form_299_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-LCKF_n-Units-P}
  \mathbf{P}_0 =
  \begin{tikzpicture}[baseline=-\the\dimexpr\fontdimen22\textfont2\relax,decoration=brace]
    \matrix (m)[matrix of math nodes,nodes in empty cells,left delimiter={(},right delimiter={)},
                nodes={rectangle,text width=4.8em,align=center},row sep=0.3em, column sep=0.4em]
    {
      \sigma_{\delta R}^2 \left[ \text{rad}^2 \right] &amp;                                                 &amp;                                                 &amp;                                                                    &amp;                                                                    &amp;                                                                    &amp;                                                    &amp;           \dots                                       &amp;                                               &amp;                                                                          &amp;                                                                          &amp;                                                                          &amp;                                                                                 &amp;                                                                                 &amp;                 0                                                               \\
                                                      &amp; \sigma_{\delta P}^2 \left[ \text{rad}^2 \right] &amp;                                                 &amp;                                                                    &amp;                                                                    &amp;                                                                    &amp;                                                    &amp;                                                       &amp;                                               &amp;                                                                          &amp;                                                                          &amp;                                                                          &amp;                                                                                 &amp;                                                                                 &amp;                                                                                 \\
                                                      &amp;                                                 &amp; \sigma_{\delta Y}^2 \left[ \text{rad}^2 \right] &amp;                                                                    &amp;                                                                    &amp;                                                                    &amp;                                                    &amp;                                                       &amp;                                               &amp;                                                                          &amp;                                                                          &amp;                                                                          &amp;                                                                                 &amp;                                                                                 &amp;                                                                                 \\
                                                      &amp;                                                 &amp;                                                 &amp; \sigma_{\delta v_N}^2 \left[ \frac{\text{m}^2}{\text{s}^2} \right] &amp;                                                                    &amp;                                                                    &amp;                                                    &amp;                                                       &amp;                                               &amp;                                                                          &amp;                                                                          &amp;                                                                          &amp;                                                                                 &amp;                                                                                 &amp;                                                                                 \\
                                                      &amp;                                                 &amp;                                                 &amp;                                                                    &amp; \sigma_{\delta v_E}^2 \left[ \frac{\text{m}^2}{\text{s}^2} \right] &amp;                                                                    &amp;                                                    &amp;                                                       &amp;                                               &amp;                                                                          &amp;                                                                          &amp;          \iddots                                                         &amp;                                                                                 &amp;                                                                                 &amp;                                                                                 \\
                                                      &amp;                                                 &amp;                                                 &amp;                                                                    &amp;                                                                    &amp; \sigma_{\delta v_D}^2 \left[ \frac{\text{m}^2}{\text{s}^2} \right] &amp;                                                    &amp;                                                       &amp;                                               &amp;                                                                          &amp;                                                                          &amp;                                                                          &amp;                                                                                 &amp;                                                                                 &amp;                                                                                 \\
                                                      &amp;                                                 &amp;                                                 &amp;                                                                    &amp;                                                                    &amp;                                                                    &amp; \sigma_{\delta \phi}^2 \left[ \text{rad}^2 \right] &amp;                                                       &amp;                                               &amp;                                                                          &amp;                                                                          &amp;                                                                          &amp;                                                                                 &amp;                                                                                 &amp;                                                                                 \\
             \vdots                                   &amp;                                                 &amp;                                                 &amp;                                                                    &amp;                                                                    &amp;                                                                    &amp;                                                    &amp; \sigma_{\delta \lambda}^2 \left[ \text{rad}^2 \right] &amp;                                               &amp;                                                                          &amp;                                                                          &amp;                                                                          &amp;                                                                                 &amp;                                                                                 &amp;              \vdots                                                             \\
                                                      &amp;                                                 &amp;                                                 &amp;                                                                    &amp;                                                                    &amp;                                                                    &amp;                                                    &amp;                                                       &amp; \sigma_{\delta h}^2 \left[ \text{m}^2 \right] &amp;                                                                          &amp;                                                                          &amp;                                                                          &amp;                                                                                 &amp;                                                                                 &amp;                                                                                 \\
                                                      &amp;                                                 &amp;                                                 &amp;                                                                    &amp;                                                                    &amp;                                                                    &amp;                                                    &amp;                                                       &amp;                                               &amp; \sigma_{\delta f_{x}^{b}}^2 \left[ \frac{\text{m}^2}{\text{s}^4} \right] &amp;                                                                          &amp;                                                                          &amp;                                                                                 &amp;                                                                                 &amp;                                                                                 \\
                                                      &amp;                                                 &amp;                                                 &amp;       \iddots                                                      &amp;                                                                    &amp;                                                                    &amp;                                                    &amp;                                                       &amp;                                               &amp;                                                                          &amp; \sigma_{\delta f_{y}^{b}}^2 \left[ \frac{\text{m}^2}{\text{s}^4} \right] &amp;                                                                          &amp;                                                                                 &amp;                                                                                 &amp;                                                                                 \\
                                                      &amp;                                                 &amp;                                                 &amp;                                                                    &amp;                                                                    &amp;                                                                    &amp;                                                    &amp;                                                       &amp;                                               &amp;                                                                          &amp;                                                                          &amp; \sigma_{\delta f_{z}^{b}}^2 \left[ \frac{\text{m}^2}{\text{s}^4} \right] &amp;                                                                                 &amp;                                                                                 &amp;                                                                                 \\
                                                      &amp;                                                 &amp;                                                 &amp;                                                                    &amp;                                                                    &amp;                                                                    &amp;                                                    &amp;                                                       &amp;                                               &amp;                                                                          &amp;                                                                          &amp;                                                                          &amp; \sigma_{\delta \omega_{x}^{b}}^2 \left[ \frac{\text{rad}^2}{\text{s}^2} \right] &amp;                                                                                 &amp;                                                                                 \\
                                                      &amp;                                                 &amp;                                                 &amp;                                                                    &amp;                                                                    &amp;                                                                    &amp;                                                    &amp;                                                       &amp;                                               &amp;                                                                          &amp;                                                                          &amp;                                                                          &amp;                                                                                 &amp; \sigma_{\delta \omega_{y}^{b}}^2 \left[ \frac{\text{rad}^2}{\text{s}^2} \right] &amp;                                                                                 \\
               0                                      &amp;                                                 &amp;                                                 &amp;                                                                    &amp;                                                                    &amp;                                                                    &amp;                                                    &amp;           \dots                                       &amp;                                               &amp;                                                                          &amp;                                                                          &amp;                                                                          &amp;                                                                                 &amp;                                                                                 &amp; \sigma_{\delta \omega_{z}^{b}}^2 \left[ \frac{\text{rad}^2}{\text{s}^2} \right] \\
    };

    \begin{pgfonlayer}{background}
      \fhighlight[green!20]{m-1-1}{m-1-1}
      \fhighlight[green!20]{m-2-2}{m-2-2}
      \fhighlight[green!20]{m-3-3}{m-3-3}
      \fhighlight[blue!20]{m-4-4}{m-4-4}
      \fhighlight[blue!20]{m-5-5}{m-5-5}
      \fhighlight[blue!20]{m-6-6}{m-6-6}
      \fhighlight[cyan!20]{m-7-7}{m-7-7}
      \fhighlight[cyan!20]{m-8-8}{m-8-8}
      \fhighlight[cyan!20]{m-9-9}{m-9-9}
      \fhighlight[red!20]{m-10-10}{m-10-10}
      \fhighlight[red!20]{m-11-11}{m-11-11}
      \fhighlight[red!20]{m-12-12}{m-12-12}
      \fhighlight[orange!20]{m-13-13}{m-13-13}
      \fhighlight[orange!20]{m-14-14}{m-14-14}
      \fhighlight[orange!20]{m-15-15}{m-15-15}
    \end{pgfonlayer}
  \end{tikzpicture}
\end{equation}" src="form_299.svg" width="2282" height="693"/></picture>
</p>
<p>When scaling elements in <picture><source srcset="form_293_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \boldsymbol{\delta} \mathbf{x} $" src="form_293.svg" width="21" height="16"/></picture> the relevant parts of the <picture><source srcset="form_300_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \mathbf{P} $" src="form_300.svg" width="14" height="14"/></picture> matrix have to be adapted. This means the scale factors have to be multiplied with the correct rows and columns. As <picture><source srcset="form_300_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \mathbf{P} $" src="form_300.svg" width="14" height="14"/></picture> is a diagonal matrix, this means only the diagonal terms have to be scaled.</p>
<p><a class="anchor" id="eq-LCKF_n-Units-P-scaled"></a> </p><p class="formulaDsp">
<picture><source srcset="form_301_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-LCKF_n-Units-P-scaled}
  \mathbf{P}_0 =
  \begin{tikzpicture}[baseline=-\the\dimexpr\fontdimen22\textfont2\relax,decoration=brace]
    \matrix (m)[matrix of math nodes,nodes in empty cells,left delimiter={(},right delimiter={)},
                nodes={rectangle,text width=4.8em,align=center},row sep=0.3em, column sep=0.4em]
    {
      \sigma_{\delta R}^2 \left[ \text{rad}^2 \right] &amp;                                                 &amp;                                                 &amp;                                                                    &amp;                                                                    &amp;                                                                    &amp;                                                    &amp;           \dots                                       &amp;                                               &amp;                                                                          &amp;                                                                          &amp;                                                                          &amp;                                                                                 &amp;                                                                                 &amp;                 0                                                               \\
                                                      &amp; \sigma_{\delta P}^2 \left[ \text{rad}^2 \right] &amp;                                                 &amp;                                                                    &amp;                                                                    &amp;                                                                    &amp;                                                    &amp;                                                       &amp;                                               &amp;                                                                          &amp;                                                                          &amp;                                                                          &amp;                                                                                 &amp;                                                                                 &amp;                                                                                 \\
                                                      &amp;                                                 &amp; \sigma_{\delta Y}^2 \left[ \text{rad}^2 \right] &amp;                                                                    &amp;                                                                    &amp;                                                                    &amp;                                                    &amp;                                                       &amp;                                               &amp;                                                                          &amp;                                                                          &amp;                                                                          &amp;                                                                                 &amp;                                                                                 &amp;                                                                                 \\
                                                      &amp;                                                 &amp;                                                 &amp; \sigma_{\delta v_N}^2 \left[ \frac{\text{m}^2}{\text{s}^2} \right] &amp;                                                                    &amp;                                                                    &amp;                                                    &amp;                                                       &amp;                                               &amp;                                                                          &amp;                                                                          &amp;                                                                          &amp;                                                                                 &amp;                                                                                 &amp;                                                                                 \\
                                                      &amp;                                                 &amp;                                                 &amp;                                                                    &amp; \sigma_{\delta v_E}^2 \left[ \frac{\text{m}^2}{\text{s}^2} \right] &amp;                                                                    &amp;                                                    &amp;                                                       &amp;                                               &amp;                                                                          &amp;                                                                          &amp;          \iddots                                                         &amp;                                                                                 &amp;                                                                                 &amp;                                                                                 \\
                                                      &amp;                                                 &amp;                                                 &amp;                                                                    &amp;                                                                    &amp; \sigma_{\delta v_D}^2 \left[ \frac{\text{m}^2}{\text{s}^2} \right] &amp;                                                    &amp;                                                       &amp;                                               &amp;                                                                          &amp;                                                                          &amp;                                                                          &amp;                                                                                 &amp;                                                                                 &amp;                                                                                 \\
                                                      &amp;                                                 &amp;                                                 &amp;                                                                    &amp;                                                                    &amp;                                                                    &amp; \sigma_{\delta \phi}^2 \left[ \text{rad}^2 \right] &amp;                                                       &amp;                                               &amp;                                                                          &amp;                                                                          &amp;                                                                          &amp;                                                                                 &amp;                                                                                 &amp;                                                                                 \\
             \vdots                                   &amp;                                                 &amp;                                                 &amp;                                                                    &amp;                                                                    &amp;                                                                    &amp;                                                    &amp; \sigma_{\delta \lambda}^2 \left[ \text{rad}^2 \right] &amp;                                               &amp;                                                                          &amp;                                                                          &amp;                                                                          &amp;                                                                                 &amp;                                                                                 &amp;              \vdots                                                             \\
                                                      &amp;                                                 &amp;                                                 &amp;                                                                    &amp;                                                                    &amp;                                                                    &amp;                                                    &amp;                                                       &amp; \sigma_{\delta h}^2 \left[ \text{m}^2 \right] &amp;                                                                          &amp;                                                                          &amp;                                                                          &amp;                                                                                 &amp;                                                                                 &amp;                                                                                 \\
                                                      &amp;                                                 &amp;                                                 &amp;                                                                    &amp;                                                                    &amp;                                                                    &amp;                                                    &amp;                                                       &amp;                                               &amp; \sigma_{\delta f_{x}^{b}}^2 \left[ \frac{\text{m}^2}{\text{s}^4} \right] &amp;                                                                          &amp;                                                                          &amp;                                                                                 &amp;                                                                                 &amp;                                                                                 \\
                                                      &amp;                                                 &amp;                                                 &amp;       \iddots                                                      &amp;                                                                    &amp;                                                                    &amp;                                                    &amp;                                                       &amp;                                               &amp;                                                                          &amp; \sigma_{\delta f_{y}^{b}}^2 \left[ \frac{\text{m}^2}{\text{s}^4} \right] &amp;                                                                          &amp;                                                                                 &amp;                                                                                 &amp;                                                                                 \\
                                                      &amp;                                                 &amp;                                                 &amp;                                                                    &amp;                                                                    &amp;                                                                    &amp;                                                    &amp;                                                       &amp;                                               &amp;                                                                          &amp;                                                                          &amp; \sigma_{\delta f_{z}^{b}}^2 \left[ \frac{\text{m}^2}{\text{s}^4} \right] &amp;                                                                                 &amp;                                                                                 &amp;                                                                                 \\
                                                      &amp;                                                 &amp;                                                 &amp;                                                                    &amp;                                                                    &amp;                                                                    &amp;                                                    &amp;                                                       &amp;                                               &amp;                                                                          &amp;                                                                          &amp;                                                                          &amp; \sigma_{\delta \omega_{x}^{b}}^2 \left[ \frac{\text{rad}^2}{\text{s}^2} \right] &amp;                                                                                 &amp;                                                                                 \\
                                                      &amp;                                                 &amp;                                                 &amp;                                                                    &amp;                                                                    &amp;                                                                    &amp;                                                    &amp;                                                       &amp;                                               &amp;                                                                          &amp;                                                                          &amp;                                                                          &amp;                                                                                 &amp; \sigma_{\delta \omega_{y}^{b}}^2 \left[ \frac{\text{rad}^2}{\text{s}^2} \right] &amp;                                                                                 \\
               0                                      &amp;                                                 &amp;                                                 &amp;                                                                    &amp;                                                                    &amp;                                                                    &amp;                                                    &amp;           \dots                                       &amp;                                               &amp;                                                                          &amp;                                                                          &amp;                                                                          &amp;                                                                                 &amp;                                                                                 &amp; \sigma_{\delta \omega_{z}^{b}}^2 \left[ \frac{\text{rad}^2}{\text{s}^2} \right] \\
    };

    \foreach \r in {1,3,4,6,7,8,9,10,12,13,15} {
      \foreach \c in {1,3,4,6,7,8,9,10,12,13,15} {
        \coordinate (m-\r-\c-nw) at (100,-100);
        \coordinate (m-\r-\c-ne) at (-100,-100);
        \coordinate (m-\r-\c-se) at (-100,100);
        \coordinate (m-\r-\c-sw) at (100,100);

        \foreach \row in {\c} {
          \path let \p1=(m-\row-\c.west), \p2=(m-\r-\c-nw) in coordinate (m-\r-\c-nw) at ({min(\x1,\x2)},\y2);
          \path let \p1=(m-\row-\c.east), \p2=(m-\r-\c-ne) in coordinate (m-\r-\c-ne) at ({max(\x1,\x2)},\y2);
          \path let \p1=(m-\row-\c.east), \p2=(m-\r-\c-se) in coordinate (m-\r-\c-se) at ({max(\x1,\x2)},\y2);
          \path let \p1=(m-\row-\c.west), \p2=(m-\r-\c-sw) in coordinate (m-\r-\c-sw) at ({min(\x1,\x2)},\y2);
        }
        \foreach \col in {\r} {
          \path let \p1=(m-\r-\col.north), \p2=(m-\r-\c-nw) in coordinate (m-\r-\c-nw) at (\x2,{max(\y1,\y2)});
          \path let \p1=(m-\r-\col.north), \p2=(m-\r-\c-ne) in coordinate (m-\r-\c-ne) at (\x2,{max(\y1,\y2)});
          \path let \p1=(m-\r-\col.south), \p2=(m-\r-\c-se) in coordinate (m-\r-\c-se) at (\x2,{min(\y1,\y2)});
          \path let \p1=(m-\r-\col.south), \p2=(m-\r-\c-sw) in coordinate (m-\r-\c-sw) at (\x2,{min(\y1,\y2)});
        }
      }
    }

    \draw[decorate,transform canvas={xshift=-1.4em},thick,red] (m-3-1-sw) -- node[left=2pt] {$ \times \frac{180}{\pi} $} (m-1-1-nw);
    \draw[decorate,transform canvas={yshift= 0.5em},thick,red] (m-1-1-nw) -- node[above=2pt] {$ \times \frac{180}{\pi} $} (m-1-3-ne);

    \draw[decorate,transform canvas={xshift=-1.4em},thick,red] (m-8-1-sw) -- node[left=2pt] {$ \times R_0 $} (m-7-1-nw);
    \draw[decorate,transform canvas={yshift= 0.5em},thick,red] (m-1-7-nw) -- node[above=2pt] {$ \times R_0 $} (m-1-8-ne);

    \draw[decorate,transform canvas={xshift=-1.4em},thick,red] (m-12-1-sw) -- node[left=2pt] {$ \times \frac{10^3}{g} $} (m-10-1-nw);
    \draw[decorate,transform canvas={yshift= 0.5em},thick,red] (m-1-10-nw) -- node[above=2pt] {$ \times \frac{10^3}{g} $} (m-1-12-ne);

    \draw[decorate,transform canvas={xshift=-1.4em},thick,red] (m-15-1-sw) -- node[left=2pt] {$ \times 10^3 $} (m-13-1-nw);
    \draw[decorate,transform canvas={yshift= 0.5em},thick,red] (m-1-13-nw) -- node[above=2pt] {$ \times 10^3 $} (m-1-15-ne);

    \begin{pgfonlayer}{background}
      \fhighlight[green!20]{m-1-1}{m-1-1}
      \fhighlight[green!20]{m-2-2}{m-2-2}
      \fhighlight[green!20]{m-3-3}{m-3-3}
      \fhighlight[blue!20]{m-4-4}{m-4-4}
      \fhighlight[blue!20]{m-5-5}{m-5-5}
      \fhighlight[blue!20]{m-6-6}{m-6-6}
      \fhighlight[cyan!20]{m-7-7}{m-7-7}
      \fhighlight[cyan!20]{m-8-8}{m-8-8}
      \fhighlight[cyan!20]{m-9-9}{m-9-9}
      \fhighlight[red!20]{m-10-10}{m-10-10}
      \fhighlight[red!20]{m-11-11}{m-11-11}
      \fhighlight[red!20]{m-12-12}{m-12-12}
      \fhighlight[orange!20]{m-13-13}{m-13-13}
      \fhighlight[orange!20]{m-14-14}{m-14-14}
      \fhighlight[orange!20]{m-15-15}{m-15-15}

      \bhighlight[red!60]{m-1-1}{m-3-3}
      \bhighlight[red!60]{m-7-7}{m-8-8}
      \bhighlight[red!60]{m-10-10}{m-12-12}
      \bhighlight[red!60]{m-13-13}{m-15-15}
    \end{pgfonlayer}
  \end{tikzpicture}
\end{equation}" src="form_301.svg" width="2298" height="733"/></picture>
</p>
<h2><a class="anchor" id="LooselyCoupledKF_n-Units-deltaz"></a>
Measurement innovation ùõøz</h2>
<p><a class="anchor" id="eq-LCKF_n-Units-deltaz"></a> </p><p class="formulaDsp">
<picture><source srcset="form_302_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-LCKF_n-Units-deltaz}
  \boldsymbol{\delta} \mathbf{z} =
  \begin{tikzpicture}[baseline=-\the\dimexpr\fontdimen22\textfont2\relax,decoration=brace]
    \matrix (m)[matrix of math nodes,left delimiter={(},right delimiter={)},row sep=0.3em, column sep=0.1em,
                nodes={rectangle,text width=1.8em,align=center,minimum height=2.3em,anchor=center},] {
      \delta \phi           &amp; \left[ \text{rad} \right]                  \\
      \delta \lambda        &amp; \left[ \text{rad} \right]                  \\
      \delta h              &amp; \left[ \text{m} \right]                    \\
      \delta v_{N}          &amp; \left[ \frac{\text{m}}{\text{s}} \right]   \\
      \delta v_{E}          &amp; \left[ \frac{\text{m}}{\text{s}} \right]   \\
      \delta v_{D}          &amp; \left[ \frac{\text{m}}{\text{s}} \right]   \\
    };

    \begin{pgfonlayer}{background}
      \fhighlight[cyan!20]{m-1-1}{m-3-1}
      \fhighlight[blue!20]{m-4-1}{m-6-1}
    \end{pgfonlayer}
  \end{tikzpicture}
  =
  \begin{tikzpicture}[baseline=-\the\dimexpr\fontdimen22\textfont2\relax,decoration=brace]
    \matrix (m)[matrix of math nodes,left delimiter={(},right delimiter={)},row sep=0.3em, column sep=2.5em,
                nodes={rectangle,text width=1.8em,align=center,minimum height=2.0em,anchor=center},] {
       \tilde{\phi}_G    - \hat{\phi}    &amp; \left[ \text{rad} \right]                \\
       \tilde{\lambda}_G - \hat{\lambda} &amp; \left[ \text{rad} \right]                \\
       \tilde{h}_G       - \hat{h}       &amp; \left[ \text{m} \right]                  \\
       \tilde{v}_{N,G}   - \hat{v}_{N}   &amp; \left[ \frac{\text{m}}{\text{s}} \right] \\
       \tilde{v}_{E,G}   - \hat{v}_{E}   &amp; \left[ \frac{\text{m}}{\text{s}} \right] \\
       \tilde{v}_{D,G}   - \hat{v}_{D}   &amp; \left[ \frac{\text{m}}{\text{s}} \right] \\
    };
  \end{tikzpicture}
  +
  \begin{tikzpicture}[baseline=-\the\dimexpr\fontdimen22\textfont2\relax,decoration=brace]
    \matrix (m)[matrix of math nodes,left delimiter={(},right delimiter={)},row sep=0.3em, column sep=0.0em,
                nodes={rectangle,text width=26em,align=center,minimum height=6.0em,anchor=center},] {
        - \begin{pmatrix} \frac{1}{R_N + h} \left[ \frac{1}{\text{m}} \right] &amp;               0                                                 &amp;  0                  \\[1.2em]
                                   0                                          &amp; \frac{1}{(R_E + h)\cos{\phi}} \left[ \frac{1}{\text{m}} \right] &amp;  0                  \\[1.2em]
                                   0                                          &amp;               0                                                 &amp; -1 \left[ - \right] \end{pmatrix}
          \mathbf{C}_b^n \left[ - \right] \mathbf{l}_{ba}^b \left[ \text{m} \right] \\
        - \mathbf{C}_b^n \left[ - \right] (\boldsymbol{\omega}_{ib}^b  \left[ \frac{\text{rad}}{\text{s}} \right] \times \mathbf{l}_{ba}^b  \left[ \text{m} \right]) + \boldsymbol{\Omega}_{ie}^n \left[ \frac{\text{rad}}{\text{s}} \right] \mathbf{C}_b^n  \left[ - \right] \mathbf{l}_{ba}^b  \left[ \text{m} \right] \\
    };
  \end{tikzpicture}
\end{equation}" src="form_302.svg" width="1927" height="273"/></picture>
</p>
<p>When scaling elements in <picture><source srcset="form_293_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \boldsymbol{\delta} \mathbf{x} $" src="form_293.svg" width="21" height="16"/></picture> the relevant parts of the measurement innovation <picture><source srcset="form_303_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \boldsymbol{\delta} \mathbf{z} $" src="form_303.svg" width="19" height="16"/></picture> have to be adapted</p>
<p><a class="anchor" id="eq-LCKF_n-Units-deltaz-scaled"></a> </p><p class="formulaDsp">
<picture><source srcset="form_304_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-LCKF_n-Units-deltaz-scaled}
  \boldsymbol{\delta} \mathbf{z} =
  \begin{tikzpicture}[baseline=-\the\dimexpr\fontdimen22\textfont2\relax,decoration=brace]
    \matrix (m)[matrix of math nodes,left delimiter={(},right delimiter={)},row sep=0.3em, column sep=0.1em,
                nodes={rectangle,text width=1.8em,align=center,minimum height=2.3em,anchor=center},] {
      \delta \phi           &amp; \left[ \highlight[red!60]{\text{m'}} \right] \\
      \delta \lambda        &amp; \left[ \highlight[red!60]{\text{m'}} \right] \\
      \delta h              &amp; \left[ \text{m} \right]                      \\
      \delta v_{N}          &amp; \left[ \frac{\text{m}}{\text{s}} \right]     \\
      \delta v_{E}          &amp; \left[ \frac{\text{m}}{\text{s}} \right]     \\
      \delta v_{D}          &amp; \left[ \frac{\text{m}}{\text{s}} \right]     \\
    };

    \begin{pgfonlayer}{background}
      \fhighlight[cyan!20]{m-1-1}{m-3-1}
      \fhighlight[blue!20]{m-4-1}{m-6-1}
    \end{pgfonlayer}
  \end{tikzpicture}
  =
  \quad
  \begin{tikzpicture}[baseline=-\the\dimexpr\fontdimen22\textfont2\relax,decoration=brace]
    \matrix (m)[matrix of math nodes,left delimiter={(},right delimiter={)},row sep=0.3em, column sep=2.5em,
                nodes={rectangle,text width=1.8em,align=center,minimum height=2.0em,anchor=center},] {
       \tilde{\phi}_G    - \hat{\phi}    &amp; \left[ \text{rad} \right]                \\
       \tilde{\lambda}_G - \hat{\lambda} &amp; \left[ \text{rad} \right]                \\
       \tilde{h}_G       - \hat{h}       &amp; \left[ \text{m} \right]                  \\
       \tilde{v}_{N,G}   - \hat{v}_{N}   &amp; \left[ \frac{\text{m}}{\text{s}} \right] \\
       \tilde{v}_{E,G}   - \hat{v}_{E}   &amp; \left[ \frac{\text{m}}{\text{s}} \right] \\
       \tilde{v}_{D,G}   - \hat{v}_{D}   &amp; \left[ \frac{\text{m}}{\text{s}} \right] \\
    };
    \draw[decorate,transform canvas={xshift=-1.4em},thick,red] (m-2-1.south west) -- node[left=2pt] {$ \times R_0 $} (m-1-1.north west);
  \end{tikzpicture}
  +
  \quad
  \begin{tikzpicture}[baseline=-\the\dimexpr\fontdimen22\textfont2\relax,decoration=brace]
    \matrix (m)[matrix of math nodes,left delimiter={(},right delimiter={)},row sep=0.3em, column sep=0.0em,
                nodes={rectangle,text width=26em,align=center,minimum height=6.0em,anchor=center},] {
        - \begin{pmatrix} \frac{1}{R_N + h} \left[ \frac{1}{\text{m}} \right] &amp;               0                                                 &amp;  0                  \\[1.2em]
                                   0                                          &amp; \frac{1}{(R_E + h)\cos{\phi}} \left[ \frac{1}{\text{m}} \right] &amp;  0                  \\[1.2em]
                                   0                                          &amp;               0                                                 &amp; -1 \left[ - \right] \end{pmatrix}
          \mathbf{C}_b^n \left[ - \right] \mathbf{l}_{ba}^b \left[ \text{m} \right] \\
        - \mathbf{C}_b^n \left[ - \right] (\boldsymbol{\omega}_{ib}^b  \left[ \frac{\text{rad}}{\text{s}} \right] \times \mathbf{l}_{ba}^b  \left[ \text{m} \right]) + \boldsymbol{\Omega}_{ie}^n \left[ \frac{\text{rad}}{\text{s}} \right] \mathbf{C}_b^n  \left[ - \right] \mathbf{l}_{ba}^b  \left[ \text{m} \right] \\
    };
    \draw[decorate,transform canvas={xshift=-1.4em},thick,red] ($(m-1-1.south west) + (0,2.5em) $) -- node[left=2pt] {$ \times R_0 $} (m-1-1.north west);
  \end{tikzpicture}
\end{equation}" src="form_304.svg" width="1972" height="285"/></picture>
</p>
<h2><a class="anchor" id="LooselyCoupledKF_n-Units-H"></a>
Measurement sensitivity Matrix H</h2>
<p><a class="anchor" id="eq-LCKF_n-Units-H"></a> </p><p class="formulaDsp">
<picture><source srcset="form_305_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-LCKF_n-Units-H}
  \begin{tikzpicture}[baseline=-\the\dimexpr\fontdimen22\textfont2\relax,decoration=brace]
    \matrix (m)[matrix of math nodes,left delimiter={(},right delimiter={)},row sep=0.3em, column sep=0.1em,
                nodes={rectangle,text width=1.8em,align=center,minimum height=2.3em,anchor=center},] {
      \delta \phi           &amp; \left[ \text{rad} \right]                  \\
      \delta \lambda        &amp; \left[ \text{rad} \right]                  \\
      \delta h              &amp; \left[ \text{m} \right]                    \\
      \delta v_{N}          &amp; \left[ \frac{\text{m}}{\text{s}} \right]   \\
      \delta v_{E}          &amp; \left[ \frac{\text{m}}{\text{s}} \right]   \\
      \delta v_{D}          &amp; \left[ \frac{\text{m}}{\text{s}} \right]   \\
    };
    \draw[decorate,transform canvas={yshift=.5em},thick] (m-1-1.north west) -- node[above=2pt] {$\boldsymbol{\delta} \mathbf{z}$} (m-1-2.north east);

    \begin{pgfonlayer}{background}
      \fhighlight[blue!20]{m-4-1}{m-6-1}
      \fhighlight[cyan!20]{m-1-1}{m-3-1}
    \end{pgfonlayer}
  \end{tikzpicture}
  =
  \begin{tikzpicture}[baseline=-\the\dimexpr\fontdimen22\textfont2\relax,decoration=brace]
    \matrix (m)[matrix of math nodes,nodes in empty cells,left delimiter={(},right delimiter={)},row sep=0.3em, column sep=0.4em,
                nodes={rectangle,text width=2.8em,align=center,minimum height=2.3em,anchor=center},] {
      &amp;                                                                       &amp; &amp;                     &amp;                     &amp;                     &amp; -1 \left[ - \right] &amp;  0                  &amp;  0                  &amp; &amp;              &amp; &amp; &amp;                                                               &amp;  \\
      &amp; \mathbf{H}_{r,\delta \psi}^n \left[ \text{rad} \right]                &amp; &amp;                     &amp;     \mathbf{0}_3    &amp;                     &amp;  0                  &amp; -1 \left[ - \right] &amp;  0                  &amp; &amp; \mathbf{0}_3 &amp; &amp; &amp;          \mathbf{0}_3                                         &amp;  \\
      &amp;                                                                       &amp; &amp;                     &amp;                     &amp;                     &amp;  0                  &amp;  0                  &amp; -1 \left[ - \right] &amp; &amp;              &amp; &amp; &amp;                                                               &amp;  \\
      &amp;                                                                       &amp; &amp; -1 \left[ - \right] &amp;  0                  &amp;  0                  &amp;                     &amp;                     &amp;                     &amp; &amp;              &amp; &amp; &amp;                                                               &amp;  \\
      &amp; \mathbf{H}_{v,\delta \psi}^n \left[ \frac{\text{m}}{\text{s}} \right] &amp; &amp;  0                  &amp; -1 \left[ - \right] &amp;  0                  &amp;                     &amp;     \mathbf{0}_3    &amp;                     &amp; &amp; \mathbf{0}_3 &amp; &amp; &amp; \mathbf{H}_{\delta v,\omega_{ib}^b}^n \left[ \text{m} \right] &amp;  \\
      &amp;                                                                       &amp; &amp;  0                  &amp;  0                  &amp; -1 \left[ - \right] &amp;                     &amp;                     &amp;                     &amp; &amp;              &amp; &amp; &amp;                                                               &amp;  \\
    };
    \draw[decorate,transform canvas={yshift=.5em},thick] (m-1-1.north west) -- node[above=2pt] {$\mathbf{H}$} (m-1-15.north east);

    \begin{pgfonlayer}{background}
      \fhighlight[green!20]{m-1-1}{m-3-3}
      \fhighlight[green!20]{m-4-1}{m-6-3}
      \fhighlight[blue!20]{m-4-4}{m-6-6}
      \fhighlight[cyan!20]{m-1-7}{m-3-9}
      \fhighlight[orange!20]{m-4-13}{m-6-15}
    \end{pgfonlayer}
  \end{tikzpicture}
  \cdot
  \begin{tikzpicture}[baseline=-\the\dimexpr\fontdimen22\textfont2\relax,decoration=brace]
    \matrix (m)[matrix of math nodes,left delimiter={(},right delimiter={)},row sep=0.3em, column sep=0.1em,
                nodes={rectangle,text width=1.6em,align=center,minimum height=2.3em,anchor=center},] {
      \delta R              &amp; \left[ \text{rad} \right]                  \\
      \delta P              &amp; \left[ \text{rad} \right]                  \\
      \delta Y              &amp; \left[ \text{rad} \right]                  \\
      \delta v_{N}          &amp; \left[ \frac{\text{m}}{\text{s}} \right]   \\
      \delta v_{E}          &amp; \left[ \frac{\text{m}}{\text{s}} \right]   \\
      \delta v_{D}          &amp; \left[ \frac{\text{m}}{\text{s}} \right]   \\
      \delta \phi           &amp; \left[ \text{rad} \right]                  \\
      \delta \lambda        &amp; \left[ \text{rad} \right]                  \\
      \delta h              &amp; \left[ \text{m} \right]                    \\
      \delta f_{x}^{b}      &amp; \left[ \frac{\text{m}}{\text{s}^2} \right] \\
      \delta f_{y}^{b}      &amp; \left[ \frac{\text{m}}{\text{s}^2} \right] \\
      \delta f_{z}^{b}      &amp; \left[ \frac{\text{m}}{\text{s}^2} \right] \\
      \delta \omega_{x}^{b} &amp; \left[ \frac{\text{rad}}{\text{s}} \right] \\
      \delta \omega_{y}^{b} &amp; \left[ \frac{\text{rad}}{\text{s}} \right] \\
      \delta \omega_{z}^{b} &amp; \left[ \frac{\text{rad}}{\text{s}} \right] \\
    };
    \draw[decorate,transform canvas={yshift=.5em},thick] (m-1-1.north west) -- node[above=2pt] {$\boldsymbol{\delta} \mathbf{x}$} (m-1-2.north east);

    \begin{pgfonlayer}{background}
      \fhighlight[green!20]{m-1-1}{m-3-1}
      \fhighlight[blue!20]{m-4-1}{m-6-1}
      \fhighlight[cyan!20]{m-7-1}{m-9-1}
      \fhighlight[red!20]{m-10-1}{m-12-1}
      \fhighlight[orange!20]{m-13-1}{m-15-1}
    \end{pgfonlayer}
  \end{tikzpicture}
\end{equation}" src="form_305.svg" width="2142" height="711"/></picture>
</p>
<p>When scaling elements in <picture><source srcset="form_293_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \boldsymbol{\delta} \mathbf{x} $" src="form_293.svg" width="21" height="16"/></picture> the relevant parts of the measurement innovation <picture><source srcset="form_303_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \boldsymbol{\delta} \mathbf{z} $" src="form_303.svg" width="19" height="16"/></picture> have to be adapted. The <picture><source srcset="form_306_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \mathbf{H} $" src="form_306.svg" width="16" height="14"/></picture> matrix stays unscaled.</p>
<p><a class="anchor" id="eq-LCKF_n-Units-H-scaled"></a> </p><p class="formulaDsp">
<picture><source srcset="form_307_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-LCKF_n-Units-H-scaled}
  \begin{tikzpicture}[baseline=-\the\dimexpr\fontdimen22\textfont2\relax,decoration=brace]
    \matrix (m)[matrix of math nodes,left delimiter={(},right delimiter={)},row sep=0.3em, column sep=0.1em,
                nodes={rectangle,text width=1.8em,align=center,minimum height=2.3em,anchor=center},] {
      \delta \phi           &amp; \left[ \highlight[red!60]{\text{m'}} \right] \\
      \delta \lambda        &amp; \left[ \highlight[red!60]{\text{m'}} \right] \\
      \delta h              &amp; \left[ \text{m} \right]                      \\
      \delta v_{N}          &amp; \left[ \frac{\text{m}}{\text{s}} \right]     \\
      \delta v_{E}          &amp; \left[ \frac{\text{m}}{\text{s}} \right]     \\
      \delta v_{D}          &amp; \left[ \frac{\text{m}}{\text{s}} \right]     \\
    };
    \draw[decorate,transform canvas={yshift=.5em},thick] (m-1-1.north west) -- node[above=2pt] {$\boldsymbol{\delta} \mathbf{z}$} (m-1-2.north east);

    \begin{pgfonlayer}{background}
      \fhighlight[blue!20]{m-4-1}{m-6-1}
      \fhighlight[cyan!20]{m-1-1}{m-3-1}
    \end{pgfonlayer}
  \end{tikzpicture}
  =
  \begin{tikzpicture}[baseline=-\the\dimexpr\fontdimen22\textfont2\relax,decoration=brace]
    \matrix (m)[matrix of math nodes,nodes in empty cells,left delimiter={(},right delimiter={)},row sep=0.3em, column sep=0.4em,
                nodes={rectangle,text width=2.8em,align=center,minimum height=2.3em,anchor=center},] {
      &amp;                                                                       &amp; &amp;                     &amp;                     &amp;                     &amp; -1 \left[ - \right] &amp;  0                  &amp;  0                  &amp; &amp;              &amp; &amp; &amp;                                                               &amp;  \\
      &amp; \mathbf{H}_{r,\delta \psi}^n \left[ \text{rad} \right]                &amp; &amp;                     &amp;     \mathbf{0}_3    &amp;                     &amp;  0                  &amp; -1 \left[ - \right] &amp;  0                  &amp; &amp; \mathbf{0}_3 &amp; &amp; &amp;          \mathbf{0}_3                                         &amp;  \\
      &amp;                                                                       &amp; &amp;                     &amp;                     &amp;                     &amp;  0                  &amp;  0                  &amp; -1 \left[ - \right] &amp; &amp;              &amp; &amp; &amp;                                                               &amp;  \\
      &amp;                                                                       &amp; &amp; -1 \left[ - \right] &amp;  0                  &amp;  0                  &amp;                     &amp;                     &amp;                     &amp; &amp;              &amp; &amp; &amp;                                                               &amp;  \\
      &amp; \mathbf{H}_{v,\delta \psi}^n \left[ \frac{\text{m}}{\text{s}} \right] &amp; &amp;  0                  &amp; -1 \left[ - \right] &amp;  0                  &amp;                     &amp;     \mathbf{0}_3    &amp;                     &amp; &amp; \mathbf{0}_3 &amp; &amp; &amp; \mathbf{H}_{\delta v,\omega_{ib}^b}^n \left[ \text{m} \right] &amp;  \\
      &amp;                                                                       &amp; &amp;  0                  &amp;  0                  &amp; -1 \left[ - \right] &amp;                     &amp;                     &amp;                     &amp; &amp;              &amp; &amp; &amp;                                                               &amp;  \\
    };
    \draw[decorate,transform canvas={yshift=.5em},thick] (m-1-1.north west) -- node[above=2pt] {$\mathbf{H}$} (m-1-15.north east);

    \draw[decorate,transform canvas={xshift=-1.4em},thick,red] (m-2-1.south west) -- node[left=2pt] {$ \times R_0 $} (m-1-1.north west);

    \draw[decorate,transform canvas={yshift=1.1em},thick,red] (m-1-1.north west) -- node[above=2pt] {$ \times \frac{\pi}{180} $} (m-1-3.north east);
    \draw[decorate,transform canvas={yshift=2.0em},thick,red] (m-1-7.north west) -- node[above=2pt] {$ \times \frac{1}{R_0} $} (m-1-8.north east);
    \draw[decorate,transform canvas={yshift=1.1em},thick,red] (m-1-10.north west) -- node[above=2pt] {$ \times \frac{g}{10^3} $} (m-1-12.north east);
    \draw[decorate,transform canvas={yshift=1.1em},thick,red] (m-1-13.north west) -- node[above=2pt] {$ \times 10^{-3} $} (m-1-15.north east);

    \begin{pgfonlayer}{background}
      \fhighlight[green!20]{m-1-1}{m-3-3}
      \fhighlight[green!20]{m-4-1}{m-6-3}
      \fhighlight[blue!20]{m-4-4}{m-6-6}
      \fhighlight[cyan!20]{m-1-7}{m-3-9}
      \fhighlight[orange!20]{m-4-13}{m-6-15}
    \end{pgfonlayer}
  \end{tikzpicture}
  \cdot
  \begin{tikzpicture}[baseline=-\the\dimexpr\fontdimen22\textfont2\relax,decoration=brace]
    \matrix (m)[matrix of math nodes,left delimiter={(},right delimiter={)},row sep=0.3em, column sep=0.1em,
                nodes={rectangle,text width=2.4em,align=center,minimum height=2.3em,anchor=center},] {
      \delta R              &amp; \left[ \highlight[red!60]{\text{deg}} \right]                   \\
      \delta P              &amp; \left[ \highlight[red!60]{\text{deg}} \right]                   \\
      \delta Y              &amp; \left[ \highlight[red!60]{\text{deg}} \right]                   \\
      \delta v_{N}          &amp; \left[ \frac{\text{m}}{\text{s}} \right]                        \\
      \delta v_{E}          &amp; \left[ \frac{\text{m}}{\text{s}} \right]                        \\
      \delta v_{D}          &amp; \left[ \frac{\text{m}}{\text{s}} \right]                        \\
      \delta \phi           &amp; \left[ \highlight[red!60]{\text{m'}} \right]                    \\
      \delta \lambda        &amp; \left[ \highlight[red!60]{\text{m'}} \right]                    \\
      \delta h              &amp; \left[ \text{m} \right]                                         \\
      \delta f_{x}^{b}      &amp; \left[ \highlight[red!60]{\text{mg}} \right]                    \\
      \delta f_{y}^{b}      &amp; \left[ \highlight[red!60]{\text{mg}} \right]                    \\
      \delta f_{z}^{b}      &amp; \left[ \highlight[red!60]{\text{mg}} \right]                    \\
      \delta \omega_{x}^{b} &amp; \left[ \highlight[red!60]{\frac{\text{mrad}}{\text{s}}} \right] \\
      \delta \omega_{y}^{b} &amp; \left[ \highlight[red!60]{\frac{\text{mrad}}{\text{s}}} \right] \\
      \delta \omega_{z}^{b} &amp; \left[ \highlight[red!60]{\frac{\text{mrad}}{\text{s}}} \right] \\
    };
    \draw[decorate,transform canvas={yshift=.5em},thick] (m-1-1.north west) -- node[above=2pt] {$\boldsymbol{\delta} \mathbf{x}$} (m-1-2.north east);

    \begin{pgfonlayer}{background}
      \fhighlight[green!20]{m-1-1}{m-3-1}
      \fhighlight[blue!20]{m-4-1}{m-6-1}
      \fhighlight[cyan!20]{m-7-1}{m-9-1}
      \fhighlight[red!20]{m-10-1}{m-12-1}
      \fhighlight[orange!20]{m-13-1}{m-15-1}
    \end{pgfonlayer}
  \end{tikzpicture}
\end{equation}" src="form_307.svg" width="2170" height="746"/></picture>
</p>
<h2><a class="anchor" id="LooselyCoupledKF_n-Units-R"></a>
Measurement noise covariance matrix R</h2>
<p><a class="anchor" id="eq-LCKF_n-Units-R"></a> </p><p class="formulaDsp">
<picture><source srcset="form_308_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-LCKF_n-Units-R}
  \mathbf{R} = E \left( (\mathbf{z} - \mathbf{H} \mathbf{x})(\mathbf{z} - \mathbf{H} \mathbf{x})^T \right) =
  \begin{tikzpicture}[baseline=-\the\dimexpr\fontdimen22\textfont2\relax,decoration=brace]
    \matrix (m)[matrix of math nodes,left delimiter={(},right delimiter={)},row sep=0.3em, column sep=0.1em,
                nodes={rectangle,text width=4.2em,align=center,minimum height=2.3em,anchor=center},] {
      \sigma^2_{z_\phi} \left[ \text{rad}^2 \right] &amp;          0                                       &amp;       0                                  &amp;         0                                                       &amp;         0                                                       &amp;         0                                                       \\
              0                                     &amp; \sigma^2_{z_\lambda} \left[ \text{rad}^2 \right] &amp;       0                                  &amp;         0                                                       &amp;         0                                                       &amp;         0                                                       \\
              0                                     &amp;          0                                       &amp; \sigma^2_{z_h} \left[ \text{m}^2 \right] &amp;         0                                                       &amp;         0                                                       &amp;         0                                                       \\
              0                                     &amp;          0                                       &amp;       0                                  &amp; \sigma^2_{z_{v_N}} \left[ \frac{\text{m}^2}{\text{s}^2} \right] &amp;         0                                                       &amp;         0                                                       \\
              0                                     &amp;          0                                       &amp;       0                                  &amp;         0                                                       &amp; \sigma^2_{z_{v_E}} \left[ \frac{\text{m}^2}{\text{s}^2} \right] &amp;         0                                                       \\
              0                                     &amp;          0                                       &amp;       0                                  &amp;         0                                                       &amp;         0                                                       &amp; \sigma^2_{z_{v_D}} \left[ \frac{\text{m}^2}{\text{s}^2} \right] \\
    };

    \begin{pgfonlayer}{background}
      \fhighlight[cyan!20]{m-1-1}{m-1-1}
      \fhighlight[cyan!20]{m-2-2}{m-2-2}
      \fhighlight[cyan!20]{m-3-3}{m-3-3}
      \fhighlight[blue!20]{m-4-4}{m-4-4}
      \fhighlight[blue!20]{m-5-5}{m-5-5}
      \fhighlight[blue!20]{m-6-6}{m-6-6}
    \end{pgfonlayer}
  \end{tikzpicture}
\end{equation}" src="form_308.svg" width="1878" height="284"/></picture>
</p>
<p>When scaling elements in <picture><source srcset="form_293_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \boldsymbol{\delta} \mathbf{x} $" src="form_293.svg" width="21" height="16"/></picture> the measurement innovation <picture><source srcset="form_303_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \boldsymbol{\delta} \mathbf{z} $" src="form_303.svg" width="19" height="16"/></picture> is scaled and therefore the relevant parts of the <picture><source srcset="form_309_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \mathbf{R} $" src="form_309.svg" width="16" height="14"/></picture> matrix have to be adapted.</p>
<p><a class="anchor" id="eq-LCKF_n-Units-R-scaled"></a> </p><p class="formulaDsp">
<picture><source srcset="form_310_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-LCKF_n-Units-R-scaled}
  \mathbf{R} = E \left( (\mathbf{z} - \mathbf{H} \mathbf{x})(\mathbf{z} - \mathbf{H} \mathbf{x})^T \right) =
  \begin{tikzpicture}[baseline=-\the\dimexpr\fontdimen22\textfont2\relax,decoration=brace]
    \matrix (m)[matrix of math nodes,left delimiter={(},right delimiter={)},row sep=0.3em, column sep=0.1em,
                nodes={rectangle,text width=4.2em,align=center,minimum height=2.3em,anchor=center},] {
      \sigma^2_{z_\phi} \left[ \text{rad}^2 \right] &amp;          0                                       &amp;       0                                  &amp;         0                                                       &amp;         0                                                       &amp;         0                                                       \\
              0                                     &amp; \sigma^2_{z_\lambda} \left[ \text{rad}^2 \right] &amp;       0                                  &amp;         0                                                       &amp;         0                                                       &amp;         0                                                       \\
              0                                     &amp;          0                                       &amp; \sigma^2_{z_h} \left[ \text{m}^2 \right] &amp;         0                                                       &amp;         0                                                       &amp;         0                                                       \\
              0                                     &amp;          0                                       &amp;       0                                  &amp; \sigma^2_{z_{v_N}} \left[ \frac{\text{m}^2}{\text{s}^2} \right] &amp;         0                                                       &amp;         0                                                       \\
              0                                     &amp;          0                                       &amp;       0                                  &amp;         0                                                       &amp; \sigma^2_{z_{v_E}} \left[ \frac{\text{m}^2}{\text{s}^2} \right] &amp;         0                                                       \\
              0                                     &amp;          0                                       &amp;       0                                  &amp;         0                                                       &amp;         0                                                       &amp; \sigma^2_{z_{v_D}} \left[ \frac{\text{m}^2}{\text{s}^2} \right] \\
    };

    \foreach \r in {1,...,6} {
      \foreach \c in {1,...,6} {
        \coordinate (m-\r-\c-nw) at (100,-100);
        \coordinate (m-\r-\c-ne) at (-100,-100);
        \coordinate (m-\r-\c-se) at (-100,100);
        \coordinate (m-\r-\c-sw) at (100,100);

        \foreach \row in {\c} {
          \path let \p1=(m-\row-\c.west), \p2=(m-\r-\c-nw) in coordinate (m-\r-\c-nw) at ({min(\x1,\x2)},\y2);
          \path let \p1=(m-\row-\c.east), \p2=(m-\r-\c-ne) in coordinate (m-\r-\c-ne) at ({max(\x1,\x2)},\y2);
          \path let \p1=(m-\row-\c.east), \p2=(m-\r-\c-se) in coordinate (m-\r-\c-se) at ({max(\x1,\x2)},\y2);
          \path let \p1=(m-\row-\c.west), \p2=(m-\r-\c-sw) in coordinate (m-\r-\c-sw) at ({min(\x1,\x2)},\y2);
        }
        \foreach \col in {\r} {
          \path let \p1=(m-\r-\col.north), \p2=(m-\r-\c-nw) in coordinate (m-\r-\c-nw) at (\x2,{max(\y1,\y2)});
          \path let \p1=(m-\r-\col.north), \p2=(m-\r-\c-ne) in coordinate (m-\r-\c-ne) at (\x2,{max(\y1,\y2)});
          \path let \p1=(m-\r-\col.south), \p2=(m-\r-\c-se) in coordinate (m-\r-\c-se) at (\x2,{min(\y1,\y2)});
          \path let \p1=(m-\r-\col.south), \p2=(m-\r-\c-sw) in coordinate (m-\r-\c-sw) at (\x2,{min(\y1,\y2)});
        }
      }
    }

    \draw[decorate,transform canvas={xshift=-1.4em},thick,red] (m-2-1-sw) -- node[left=2pt] {$ \times R_0^2 $} (m-1-1-nw);

    \begin{pgfonlayer}{background}
      \fhighlight[cyan!20]{m-1-1}{m-1-1}
      \fhighlight[cyan!20]{m-2-2}{m-2-2}
      \fhighlight[cyan!20]{m-3-3}{m-3-3}
      \fhighlight[blue!20]{m-4-4}{m-4-4}
      \fhighlight[blue!20]{m-5-5}{m-5-5}
      \fhighlight[blue!20]{m-6-6}{m-6-6}

      \bhighlight[red!60]{m-1-1}{m-2-2}
    \end{pgfonlayer}
  \end{tikzpicture}
\end{equation}" src="form_310.svg" width="1892" height="284"/></picture>
</p>
<h1><a class="anchor" id="LooselyCoupledKF_n-Appendix"></a>
Appendix</h1>
<h2><a class="anchor" id="LooselyCoupledKF_n-ErrorStateEquations-LocalLevelFrame-Derivation"></a>
Derivation</h2>
<h3><a class="anchor" id="LooselyCoupledKF_n-ErrorStateEquations-LocalLevelFrame-Derivation-Position"></a>
Position Equations</h3>
<p>The time derivative of curvilinear position as a function of the Earth-referenced velocity in local navigation frame axes (see <a class="el" href="citelist.html#CITEREF_Groves2013">[10]</a> Groves, ch. 2.4.2, eq. 2.111, p. 61 or <a class="el" href="citelist.html#CITEREF_Titterton2004">[32]</a> Titterton, ch. 3.7, eq. 3.81,3.85,3.86, p. 48ff):</p>
<p><a class="anchor" id="eq-LCKF_n-Derivation-Position-timeDerivative"></a> </p><p class="formulaDsp">
<picture><source srcset="form_311_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-LCKF_n-Derivation-Position-timeDerivative}
\begin{aligned}
  \dotup{\phi}    &amp;= \frac{v_N}{R_N + h}             \\
  \dotup{\lambda} &amp;= \frac{v_E}{(R_E + h)\cos{\phi}} \\
  \dotup{h}       &amp;= -v_D                            \\
\end{aligned}
\end{equation}" src="form_311.svg" width="1545" height="105"/></picture>
</p>
<p>Differential of left and right side neglecting errors in <picture><source srcset="form_312_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$R_N $" src="form_312.svg" width="26" height="16"/></picture> and <picture><source srcset="form_313_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$R_E $" src="form_313.svg" width="25" height="16"/></picture> ( <picture><source srcset="form_314_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \nicefrac{\partial R_N}{\partial p_i} = 0 $" src="form_314.svg" width="89" height="19"/></picture> and <picture><source srcset="form_315_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \quad \nicefrac{\partial R_E}{\partial p_i} = 0$" src="form_315.svg" width="88" height="19"/></picture>)</p>
<p><a class="anchor" id="eq-LCKF_n-Derivation-Position-differential"></a> </p><p class="formulaDsp">
<picture><source srcset="form_316_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-LCKF_n-Derivation-Position-differential}
\begin{aligned}
  \delta\dotup{\phi}    &amp;= \frac{\partial \dotup{\phi}}{\partial v_N} \delta v_N + \frac{\partial \dotup{\phi}}{\partial h} \delta h = \highlight[teal!20]{\dfrac{1}{R_N + h}} \delta v_N \highlight[cyan!20]{- \dfrac{v_N}{(R_N + h)^2}} \delta h \\
  \delta\dotup{\lambda} &amp;= \frac{\partial \dotup{\lambda}}{\partial v_E} \delta v_E + \frac{\partial \dotup{\lambda}}{\partial h} \delta h + \frac{\partial \dotup{\lambda}}{\partial \phi} \delta \phi = \highlight[teal!20]{\dfrac{1}{(R_E + h)\cos{\phi}}} \delta v_E \highlight[cyan!20]{- \dfrac{v_E}{(R_E + h)^2\cos{\phi}}} \delta h + \highlight[cyan!20]{\dfrac{v_E \tan{\phi}}{(R_E + h)\cos{\phi}}} \delta \phi \\
  \delta\dotup{h}       &amp;= \frac{\partial \dotup{h}}{\partial v_D} \delta v_D = \highlight[teal!20]{-1} \cdot \delta v_D \\
\end{aligned}
\end{equation}" src="form_316.svg" width="1841" height="159"/></picture>
</p>
<h3><a class="anchor" id="LooselyCoupledKF_n-ErrorStateEquations-LocalLevelFrame-Derivation-Attitude"></a>
Attitude Equations</h3>
<p>The equations here mainly follow <a class="el" href="citelist.html#CITEREF_Titterton2004">[32]</a> Titterton, ch. 12.3.1.1, p. 342f</p>
<p>The estimated attitude <picture><source srcset="form_317_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \mathbf{\hat{C}}_b^n $" src="form_317.svg" width="23" height="23"/></picture> can be written in terms of true direction cosine matrix <picture><source srcset="form_318_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \mathbf{C}_b^n $" src="form_318.svg" width="23" height="18"/></picture> <a class="anchor" id="eq-LCKF_n-Derivation-Attitude-estimate-true"></a> </p><p class="formulaDsp">
<picture><source srcset="form_319_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-LCKF_n-Derivation-Attitude-estimate-true}
  \mathbf{\hat{C}}_b^n = \mathbf{B} \mathbf{C}_b^n
\end{equation}" src="form_319.svg" width="1514" height="23"/></picture>
</p>
<p> where <picture><source srcset="form_202_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \mathbf{B} $" src="form_202.svg" width="14" height="14"/></picture> is the transformation from true reference axes to estimated reference axes and it can be approximated for small angle misalignments as <a class="anchor" id="eq-LCKF_n-Derivation-Attitude-transformation"></a> </p><p class="formulaDsp">
<picture><source srcset="form_320_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-LCKF_n-Derivation-Attitude-transformation}
  \mathbf{B} = [\mathbf{I} - \mathbf{\Psi}], \quad \text{with}~ \mathbf{\Psi} = \begin{pmatrix} \delta\alpha \\ \delta\beta \\ \delta\gamma \end{pmatrix} \times
\end{equation}" src="form_320.svg" width="1603" height="63"/></picture>
</p>
<p> with <picture><source srcset="form_204_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \mathbf{\Psi} $" src="form_204.svg" width="16" height="14"/></picture> being a skew symmetric matrix and <picture><source srcset="form_205_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \delta\alpha, \delta\beta, \delta\gamma $" src="form_205.svg" width="74" height="19"/></picture> being the attitude errors (e.g. roll, pitch, yaw for small euler angles).</p>
<p>Substituting <a class="el" href="group__LooselyCoupledKF__n.html#eq-LCKF_n-Derivation-Attitude-transformation"><picture><source srcset="form_321_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="\eqref{eq:eq-LCKF_n-Derivation-Attitude-transformation}" src="form_321.svg" width="44" height="19"/></picture> </a> into <a class="el" href="group__LooselyCoupledKF__n.html#eq-LCKF_n-Derivation-Attitude-estimate-true"><picture><source srcset="form_322_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="\eqref{eq:eq-LCKF_n-Derivation-Attitude-estimate-true}" src="form_322.svg" width="44" height="19"/></picture> </a> gives <a class="anchor" id="eq-LCKF_n-Derivation-Attitude-estimate-errors"></a> </p><p class="formulaDsp">
<picture><source srcset="form_323_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-LCKF_n-Derivation-Attitude-estimate-errors}
  \mathbf{\hat{C}}_b^n \approx [\mathbf{I} - \mathbf{\Psi}] \mathbf{C}_b^n
\end{equation}" src="form_323.svg" width="1535" height="23"/></picture>
</p>
<p>and solving for <picture><source srcset="form_204_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \mathbf{\Psi} $" src="form_204.svg" width="16" height="14"/></picture> <a class="anchor" id="eq-LCKF_n-Derivation-Attitude-skew-mat"></a> </p><p class="formulaDsp">
<picture><source srcset="form_324_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-LCKF_n-Derivation-Attitude-skew-mat}
  \mathbf{\Psi} = \mathbf{I} - \mathbf{\hat{C}}_b^n {\mathbf{C}_b^n}^T
\end{equation}" src="form_324.svg" width="1535" height="23"/></picture>
</p>
<p>Differentiating this equation yields: <a class="anchor" id="eq-LCKF_n-Derivation-Attitude-skew-mat-dot"></a> </p><p class="formulaDsp">
<picture><source srcset="form_325_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-LCKF_n-Derivation-Attitude-skew-mat-dot}
  \mathbf{\dot{\Psi}} = -\mathbf{\dot{\hat{C}}}_b^{\raise-1.25ex\hbox{$\scriptstyle n$}} {\mathbf{C}_b^n}^T - \mathbf{\hat{C}}_b^n {\mathbf{\dot{C}}_b^n}\raise1.25ex\hbox{$\scriptstyle T$}
\end{equation}" src="form_325.svg" width="1566" height="26"/></picture>
</p>
<p>Using the following equations</p><ul>
<li>Time derivative DCM local-navigation-frame <picture><source srcset="form_326_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \mathbf{\dot{C}}_b^n = \mathbf{C}_b^n \mathbf{\Omega}_{nb}^b $" src="form_326.svg" width="102" height="23"/></picture> &emsp;<a class="el" href="citelist.html#CITEREF_Groves2013">[10]</a> Groves, ch. 5.4.1, eq. 5.39, p. 176 or <a class="el" href="citelist.html#CITEREF_Titterton2004">[32]</a> Titterton, ch. 3.5.3, eq. 3.28, p. 32<ul>
<li>Time derivative DCM <picture><source srcset="form_327_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \mathbf{\dot{C}}_\beta^\alpha(t) = \lim_{\delta t \to 0}\left(\dfrac{\mathbf{C}_\beta^\alpha(t+\delta t) - \mathbf{C}_\beta^\alpha(t)}{\delta t}\right) $" src="form_327.svg" width="301" height="44"/></picture> &emsp;<a class="el" href="citelist.html#CITEREF_Groves2013">[10]</a> Groves, ch. 2.3.1, eq. 2.52, p. 45</li>
<li>DCM with small angle approximation <picture><source srcset="form_328_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ C_\alpha^\beta \approx \begin{pmatrix} 1 &amp; -\psi_{\beta\alpha} &amp; \theta_{\beta\alpha} \\ \psi_{\beta\alpha} &amp; 1 &amp; -\phi_{\beta\alpha} \\ -\theta_{\beta\alpha} &amp; \phi_{\beta\alpha} &amp; 1 \end{pmatrix} = \mathbf{I}_3 + [\boldsymbol{\psi}_{\beta\alpha} \times ] = \mathbf{I}_3 + \mathbf{\Omega}_{\beta\alpha} $" src="form_328.svg" width="446" height="63"/></picture> &emsp;<a class="el" href="citelist.html#CITEREF_Groves2013">[10]</a> Groves, ch. 2.2.2, eq. 2.26, p. 39</li>
</ul>
</li>
<li>Angular rate splitting <picture><source srcset="form_211_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \boldsymbol{\omega}_{\beta\alpha}^\gamma = \boldsymbol{\omega}_{\beta\delta}^\gamma + \boldsymbol{\omega}_{\delta\alpha}^\gamma $" src="form_211.svg" width="135" height="23"/></picture> &emsp;<a class="el" href="citelist.html#CITEREF_Groves2013">[10]</a> Groves, ch. 2.3.1, eq. 2.48, p. 45</li>
<li>Skew-symmetric matrix transformation <picture><source srcset="form_212_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \mathbf{\Omega}_{\beta\alpha}^\delta = \mathbf{C}_\gamma^\delta \mathbf{\Omega}_{\beta\alpha}^\gamma \mathbf{C}_\delta^\gamma $" src="form_212.svg" width="135" height="25"/></picture> &emsp;<a class="el" href="citelist.html#CITEREF_Groves2013">[10]</a> Groves, ch. 2.3.1, eq. 2.51, p. 45</li>
</ul>
<p>leads to the time derivative of the coordinate transformation matrix (see <a class="el" href="citelist.html#CITEREF_Groves2013">[10]</a> Groves, ch. 5.4.1, eq. 5.40, p. 177 or <a class="el" href="citelist.html#CITEREF_Titterton2004">[32]</a> Titterton, ch. 12.3.1.1, eq. 12.12, p. 342) <a class="anchor" id="eq-LCKF_n-Derivation-Attitude-DCM-dot"></a> </p><p class="formulaDsp">
<picture><source srcset="form_329_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-LCKF_n-Derivation-Attitude-DCM-dot}
\begin{aligned}
  \mathbf{\dot{C}}_b^n &amp;= \mathbf{C}_b^n \mathbf{\Omega}_{nb}^b \\
                       &amp;= \mathbf{C}_b^n (\mathbf{\Omega}_{ib}^b - \mathbf{\Omega}_{in}^b) \\
                       &amp;= \mathbf{C}_b^n (\mathbf{\Omega}_{ib}^b - \mathbf{C}_n^b \mathbf{\Omega}_{in}^n \mathbf{C}_b^n) \\
                       &amp;= \mathbf{C}_b^n \mathbf{\Omega}_{ib}^b - \mathbf{\Omega}_{in}^n \mathbf{C}_b^n
\end{aligned}
\end{equation}" src="form_329.svg" width="1577" height="109"/></picture>
</p>
<p>where</p><ul>
<li><picture><source srcset="form_214_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \mathbf{\Omega}_{ib}^b $" src="form_214.svg" width="26" height="21"/></picture> is the skew-symmetric matrix of the absolute body rate,</li>
<li><picture><source srcset="form_330_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \mathbf{\Omega}_{in}^b $" src="form_330.svg" width="28" height="21"/></picture> is the skew-symmetric matrix of the navigation frame rate,</li>
<li><picture><source srcset="form_331_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \mathbf{\Omega}_{ie}^n $" src="form_331.svg" width="26" height="18"/></picture> is the skew-symmetric matrix of the earth rotation in navigation frame coordinates (<a class="el" href="citelist.html#CITEREF_Groves2013">[10]</a> Groves, ch. 5.4.1, eq. 5.41, p. 177), and</li>
<li><picture><source srcset="form_332_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \mathbf{\Omega}_{en}^n $" src="form_332.svg" width="30" height="18"/></picture> is the skew-symmetric matrix of the transport rate (rotation of the local-navigation-frame with respect to the Earth) (<a class="el" href="citelist.html#CITEREF_Groves2013">[10]</a> Groves, ch. 5.4.1, eq. 5.44, p. 177)</li>
</ul>
<p>Similarly, the time time differential of the estimated matrix <picture><source srcset="form_333_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \mathbf{\dot{\hat{C}}}_b^{\raise-1.25ex\hbox{$\scriptstyle n$}} $" src="form_333.svg" width="23" height="26"/></picture> can be calculated: <a class="anchor" id="eq-LCKF_n-Derivation-Attitude-DCM-dot-estimated"></a> </p><p class="formulaDsp">
<picture><source srcset="form_334_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-LCKF_n-Derivation-Attitude-DCM-dot-estimated}
  \mathbf{\dot{\hat{C}}}_b^{\raise-1.25ex\hbox{$\scriptstyle n$}} = \mathbf{\hat{C}}_b^n \mathbf{\hat{\Omega}}_{ib}^b - \mathbf{\hat{\Omega}}_{in}^n \mathbf{\hat{C}}_b^n
\end{equation}" src="form_334.svg" width="1558" height="26"/></picture>
</p>
<p>where</p><ul>
<li><picture><source srcset="form_335_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \mathbf{\hat{\Omega}}_{in}^b $" src="form_335.svg" width="28" height="23"/></picture> is the skew-symmetric matrix of the measured body rate,</li>
<li><picture><source srcset="form_330_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \mathbf{\Omega}_{in}^b $" src="form_330.svg" width="28" height="21"/></picture> is the skew-symmetric matrix of the estimated turn rate of the navigation reference frame,</li>
</ul>
<p>Substituting <a class="el" href="group__LooselyCoupledKF__n.html#eq-LCKF_n-Derivation-Attitude-DCM-dot"><picture><source srcset="form_336_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="\eqref{eq:eq-LCKF_n-Derivation-Attitude-DCM-dot}" src="form_336.svg" width="44" height="19"/></picture> </a> and <a class="el" href="group__LooselyCoupledKF__n.html#eq-LCKF_n-Derivation-Attitude-DCM-dot-estimated"><picture><source srcset="form_337_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="\eqref{eq:eq-LCKF_n-Derivation-Attitude-DCM-dot-estimated}" src="form_337.svg" width="44" height="19"/></picture> </a> into <a class="el" href="group__LooselyCoupledKF__n.html#eq-LCKF_n-Derivation-Attitude-skew-mat-dot"><picture><source srcset="form_338_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="\eqref{eq:eq-LCKF_n-Derivation-Attitude-skew-mat-dot}" src="form_338.svg" width="44" height="19"/></picture> </a> <a class="anchor" id="eq-LCKF_n-Derivation-Attitude-skew-mat-dot-calc1"></a> </p><p class="formulaDsp">
<picture><source srcset="form_339_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-LCKF_n-Derivation-Attitude-skew-mat-dot-calc1}
\begin{aligned}
  \mathbf{\dot{\Psi}} &amp;= -(\mathbf{\hat{C}}_b^n \mathbf{\hat{\Omega}}_{ib}^b - \mathbf{\hat{\Omega}}_{in}^n \mathbf{\hat{C}}_b^n) {\mathbf{C}_b^n}^T
                         - \mathbf{\hat{C}}_b^n (\mathbf{C}_b^n \mathbf{\Omega}_{ib}^b - \mathbf{\Omega}_{in}^n \mathbf{C}_b^n)^T \\
                      &amp;= - \mathbf{\hat{C}}_b^n \mathbf{\hat{\Omega}}_{ib}^b {\mathbf{C}_b^n}^T
                         + \mathbf{\hat{\Omega}}_{in}^n \mathbf{\hat{C}}_b^n {\mathbf{C}_b^n}^T
                         + \mathbf{\hat{C}}_b^n \mathbf{\Omega}_{ib}^b {\mathbf{C}_b^n}^T
                         - \mathbf{\hat{C}}_b^n {\mathbf{C}_b^n}^T \mathbf{\Omega}_{in}^n \\
                      &amp;= - \mathbf{\hat{C}}_b^n \left[ \mathbf{\hat{\Omega}}_{ib}^b - \mathbf{\Omega}_{ib}^b \right] {\mathbf{C}_b^n}^T
                         + \mathbf{\hat{\Omega}}_{in}^n \mathbf{\hat{C}}_b^n {\mathbf{C}_b^n}^T
                         - \mathbf{\hat{C}}_b^n {\mathbf{C}_b^n}^T \mathbf{\Omega}_{in}^n
\end{aligned}
\end{equation}" src="form_339.svg" width="1703" height="91"/></picture>
</p>
<p>Substituting <a class="el" href="group__LooselyCoupledKF__n.html#eq-LCKF_n-Derivation-Attitude-estimate-errors"><picture><source srcset="form_288_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="\eqref{eq:eq-LCKF_n-Derivation-Attitude-estimate-errors}" src="form_288.svg" width="44" height="19"/></picture> </a> into <a class="el" href="group__LooselyCoupledKF__n.html#eq-LCKF_n-Derivation-Attitude-skew-mat-dot-calc1"><picture><source srcset="form_340_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="\eqref{eq:eq-LCKF_n-Derivation-Attitude-skew-mat-dot-calc1}" src="form_340.svg" width="44" height="19"/></picture> </a> gives: <a class="anchor" id="eq-LCKF_n-Derivation-Attitude-skew-mat-dot-calc2"></a> </p><p class="formulaDsp">
<picture><source srcset="form_341_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-LCKF_n-Derivation-Attitude-skew-mat-dot-calc2}
\begin{aligned}
  \mathbf{\dot{\Psi}} &amp;= - [\mathbf{I} - \mathbf{\Psi}] \mathbf{C}_b^n \left[ \mathbf{\hat{\Omega}}_{ib}^b - \mathbf{\Omega}_{ib}^b \right] {\mathbf{C}_b^n}^T
                         + \mathbf{\hat{\Omega}}_{in}^n [\mathbf{I} - \mathbf{\Psi}] \mathbf{C}_b^n {\mathbf{C}_b^n}^T
                         - [\mathbf{I} - \mathbf{\Psi}] \mathbf{C}_b^n {\mathbf{C}_b^n}^T \mathbf{\Omega}_{in}^n \\
                      &amp;= - [\mathbf{I} - \mathbf{\Psi}] \mathbf{C}_b^n \left[ \mathbf{\hat{\Omega}}_{ib}^b - \mathbf{\Omega}_{ib}^b \right] {\mathbf{C}_b^n}^T
                         + \mathbf{\hat{\Omega}}_{in}^n - \mathbf{\hat{\Omega}}_{in}^n \mathbf{\Psi}
                         - \mathbf{\Omega}_{in}^n + \mathbf{\Psi} \mathbf{\Omega}_{in}^n \\
                         &amp;= - [\mathbf{I} - \mathbf{\Psi}] \mathbf{C}_b^n \left[ \mathbf{\hat{\Omega}}_{ib}^b - \mathbf{\Omega}_{ib}^b \right] {\mathbf{C}_b^n}^T
                            + \left[ \mathbf{\hat{\Omega}}_{in}^n - \mathbf{\Omega}_{in}^n \right]
                            - \mathbf{\hat{\Omega}}_{in}^n \mathbf{\Psi} + \mathbf{\Psi} \mathbf{\Omega}_{in}^n
\end{aligned}
\end{equation}" src="form_341.svg" width="1766" height="109"/></picture>
</p>
<p>Now we make the following substitutions</p><ul>
<li><picture><source srcset="form_342_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \boldsymbol{\delta}\mathbf{\Omega}_{in}^n = \mathbf{\hat{\Omega}}_{in}^n - \mathbf{\Omega}_{in}^n $" src="form_342.svg" width="140" height="23"/></picture></li>
<li><picture><source srcset="form_225_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \boldsymbol{\delta}\mathbf{\Omega}_{ib}^b = \mathbf{\hat{\Omega}}_{ib}^b - \mathbf{\Omega}_{ib}^b $" src="form_225.svg" width="133" height="23"/></picture></li>
</ul>
<p>and neglect error product terms. This leads to (same as <a class="el" href="citelist.html#CITEREF_Titterton2004">[32]</a> Titterton, ch. 12.3.1.1, eq. 12.17, p. 343) <a class="anchor" id="eq-LCKF_n-Derivation-Attitude-skew-mat-dot-final"></a> </p><p class="formulaDsp">
<picture><source srcset="form_343_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-LCKF_n-Derivation-Attitude-skew-mat-dot-final}
  \mathbf{\dot{\Psi}} \approx \mathbf{\Psi} \mathbf{\Omega}_{in}^n - \mathbf{\hat{\Omega}}_{in}^n \mathbf{\Psi}
                              + \boldsymbol{\delta}\mathbf{\Omega}_{in}^n
                              - \mathbf{C}_b^n \boldsymbol{\delta}\mathbf{\Omega}_{ib}^b {\mathbf{C}_b^n}^T
\end{equation}" src="form_343.svg" width="1635" height="23"/></picture>
</p>
<p>Finally by performing an element by element comparison with <a class="anchor" id="eq-LCKF_n-Derivation-Attitude-element-comp"></a> </p><p class="formulaDsp">
<picture><source srcset="form_344_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-LCKF_n-Derivation-Attitude-element-comp}
  \boldsymbol{\delta \psi} \times = \mathbf{\Psi} \qquad\quad
  \boldsymbol{\omega}_{in}^n \times = \mathbf{\Omega}_{in}^n \qquad\quad
  \boldsymbol{\delta \omega}_{in}^n \times = \boldsymbol{\delta}\mathbf{\Omega}_{in}^n \qquad\quad
  \boldsymbol{\delta \omega}_{ib}^b \times = \boldsymbol{\delta}\mathbf{\Omega}_{ib}^b
\end{equation}" src="form_344.svg" width="1745" height="23"/></picture>
</p>
<p>the equation can be expressed in vector form as: <a class="anchor" id="eq-LCKF_n-Derivation-Attitude-differential"></a> </p><p class="formulaDsp">
<picture><source srcset="form_345_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-LCKF_n-Derivation-Attitude-differential}
\begin{aligned}
  \boldsymbol{\delta \dot{\psi}} &amp;\approx \highlight[green!20]{-\boldsymbol{\omega}_{in}^n \times} \boldsymbol{\delta \psi}
                                                + \boldsymbol{\delta \omega}_{in}^n
                                                \highlight[orange!20]{- \mathbf{C}_b^n} \boldsymbol{\delta \omega}_{ib}^b \\
                                       &amp;= \highlight[green!20]{-\boldsymbol{\omega}_{in}^n \times} \boldsymbol{\delta \psi}
                                          + \boldsymbol{\delta}(\boldsymbol{\omega}_{ie}^n + \boldsymbol{\omega}_{en}^n)
                                          \highlight[orange!20]{- \mathbf{C}_b^n} \boldsymbol{\delta \omega}_{ib}^b
\end{aligned}
\end{equation}" src="form_345.svg" width="1642" height="65"/></picture>
</p>
<p>The transport rate <picture><source srcset="form_129_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \boldsymbol{\omega}_{en}^n $" src="form_129.svg" width="28" height="18"/></picture> is defined as (see <a class="el" href="citelist.html#CITEREF_Groves2013">[10]</a> Groves, ch. 5.4.1, eq. 5.44, p. 177 or <a class="el" href="citelist.html#CITEREF_Gleason2009">[8]</a> Gleason, ch. 6.2.3.2, eq. 6.15, p. 155) <a class="anchor" id="eq-LCKF_n-Derivation-Attitude-transport-rate"></a> </p><p class="formulaDsp">
<picture><source srcset="form_346_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-LCKF_n-Derivation-Attitude-transport-rate}
  \boldsymbol{\omega}_{en}^n = \begin{bmatrix} \dfrac{v_E}{R_E + h} &amp; -\dfrac{v_N}{R_N + h} &amp; -\dfrac{v_E \tan{\phi}}{R_E + h} \end{bmatrix}^T
\end{equation}" src="form_346.svg" width="1638" height="47"/></picture>
</p>
<p>The differential of left and right side neglecting errors in <picture><source srcset="form_312_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$R_N $" src="form_312.svg" width="26" height="16"/></picture> and <picture><source srcset="form_313_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$R_E $" src="form_313.svg" width="25" height="16"/></picture> ( <picture><source srcset="form_314_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \nicefrac{\partial R_N}{\partial p_i} = 0 $" src="form_314.svg" width="89" height="19"/></picture> and <picture><source srcset="form_315_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \quad \nicefrac{\partial R_E}{\partial p_i} = 0$" src="form_315.svg" width="88" height="19"/></picture>) <a class="anchor" id="eq-LCKF_n-Derivation-Attitude-transport-rate-differential"></a> </p><p class="formulaDsp">
<picture><source srcset="form_347_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-LCKF_n-Derivation-Attitude-transport-rate-differential}
\begin{aligned}
  \delta \omega_{en,1}^n &amp;= \frac{\partial \omega_{en,1}^n}{\partial v_E} \delta v_E
                              + \frac{\partial\omega_{en,1}^n}{\partial h} \delta h
                            = \frac{1}{R_E + h} \delta v_E
                              - \frac{v_E}{(R_E + h)^2} \delta h \\
  \delta \omega_{en,2}^n &amp;= \frac{\partial \omega_{en,2}^n}{\partial v_N} \delta v_N
                              + \frac{\partial \omega_{en,2}^n}{\partial h} \delta h
                            = -\frac{1}{R_N + h} \delta v_N
                              + \frac{v_N}{(R_N + h)^2} \delta h \\
  \delta \omega_{en,3}^n &amp;= \frac{\partial \omega_{en,3}^n}{\partial v_E} \delta v_E
                              + \frac{\partial \omega_{en,3}^n}{\partial h} \delta h
                              + \frac{\partial \omega_{en,3}^n}{\partial \phi} \delta \phi
                            = -\frac{\tan{\phi}}{R_E + h} \delta v_E
                              + \frac{v_E \tan{\phi}}{(R_E + h)^2} \delta h
                              - \frac{v_E}{(R_E + h)\cos^2{\phi}} \delta \phi
\end{aligned}
\end{equation}" src="form_347.svg" width="1845" height="142"/></picture>
</p>
<p>The Earth rotation in local-navigation-frame coordinates <picture><source srcset="form_128_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \boldsymbol{\omega}_{ie}^n $" src="form_128.svg" width="25" height="18"/></picture> is given <a class="anchor" id="eq-LCKF_n-Derivation-Attitude-earth-rotation-n"></a> </p><p class="formulaDsp">
<picture><source srcset="form_348_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-LCKF_n-Derivation-Attitude-earth-rotation-n}
  \boldsymbol{\omega}_{ie}^n = \mathbf{C}_e^n \boldsymbol{\omega}_{ie}^e
                             = \begin{pmatrix} -\sin{\phi}\cos{\lambda} &amp; -\sin{\phi}\sin{\lambda} &amp; \cos{\phi} \\
                                                    -\sin{\lambda}      &amp;      \cos{\lambda}       &amp;      0     \\
                                               -\cos{\phi}\cos{\lambda} &amp; -\cos{\phi}\sin{\lambda} &amp; -\sin{\phi} \end{pmatrix}
                               \cdot \begin{pmatrix} 0 \\ 0 \\ \omega_{ie} \end{pmatrix}
                             = \omega_{ie} \cdot \begin{pmatrix} \cos{\phi} \\ 0 \\ -\sin{\phi} \end{pmatrix}
\end{equation}" src="form_348.svg" width="1787" height="63"/></picture>
</p>
<p>The differential of left and right side is <a class="anchor" id="eq-LCKF_n-Derivation-Attitude-earth-rotation-n-differential"></a> </p><p class="formulaDsp">
<picture><source srcset="form_349_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-LCKF_n-Derivation-Attitude-earth-rotation-n-differential}
\begin{aligned}
  \boldsymbol{\delta \omega}_{ie}^n = \frac{\partial \boldsymbol{\omega}_{ie}^n}{\partial \phi} \delta \phi
                                    = \begin{pmatrix} -\omega_{ie}\sin{\phi} \\ 0 \\ -\omega_{ie}\cos{\phi} \end{pmatrix} \delta \phi
\end{aligned}
\end{equation}" src="form_349.svg" width="1607" height="63"/></picture>
</p>
<p>Substituting <a class="el" href="group__LooselyCoupledKF__n.html#eq-LCKF_n-Derivation-Attitude-transport-rate-differential"><picture><source srcset="form_350_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="\eqref{eq:eq-LCKF_n-Derivation-Attitude-transport-rate-differential}" src="form_350.svg" width="44" height="19"/></picture> </a> and <a class="el" href="group__LooselyCoupledKF__n.html#eq-LCKF_n-Derivation-Attitude-earth-rotation-n-differential"><picture><source srcset="form_351_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="\eqref{eq:eq-LCKF_n-Derivation-Attitude-earth-rotation-n-differential}" src="form_351.svg" width="44" height="19"/></picture> </a> into <a class="el" href="group__LooselyCoupledKF__n.html#eq-LCKF_n-Derivation-Attitude-differential"><picture><source srcset="form_352_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="\eqref{eq:eq-LCKF_n-Derivation-Attitude-differential}" src="form_352.svg" width="44" height="19"/></picture> </a> gives: <a class="anchor" id="eq-LCKF_n-Derivation-Attitude-differential-final"></a> </p><p class="formulaDsp">
<picture><source srcset="form_353_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-LCKF_n-Derivation-Attitude-differential-final}
  \boldsymbol{\delta \dot{\psi}} \approx \highlight[green!20]{-\boldsymbol{\omega}_{in}^n \times} \boldsymbol{\delta \psi}
                                         + \begin{tikzpicture}[baseline=-\the\dimexpr\fontdimen22\textfont2\relax,decoration=brace]
                                             \matrix (m)[matrix of math nodes,left delimiter={(},right delimiter={)},row sep=0.3em, column sep=0.4em,
                                                         nodes={rectangle,minimum height=2.3em,anchor=center}] {
                                               -\omega_{ie}\sin{\phi} \\
                                                          0           \\
                                               -\omega_{ie}\cos{\phi} \\
                                             };
                                             \begin{pgfonlayer}{background} \fhighlight[lime!20]{m-1-1}{m-3-1} \end{pgfonlayer}
                                           \end{tikzpicture}
                                           \delta \phi
                                         + \begin{tikzpicture}[baseline=-\the\dimexpr\fontdimen22\textfont2\relax,decoration=brace]
                                             \matrix (m)[matrix of math nodes,left delimiter={(},right delimiter={)},row sep=0.3em, column sep=0.4em,
                                                         nodes={rectangle,minimum height=2.3em,anchor=center}] {
                                                        0         &amp;      \frac{1}{R_E + h}      &amp; 0 \\
                                               -\frac{1}{R_N + h} &amp;              0              &amp; 0 \\
                                                        0         &amp; -\frac{\tan{\phi}}{R_E + h} &amp; 0 \\
                                             };

                                             \foreach \r in {1,3} {
                                               \foreach \c in {1,3} {
                                                 \coordinate (m-\r-\c-nw) at (100,-100);
                                                 \coordinate (m-\r-\c-se) at (-100,100);

                                                 \foreach \row in {1,...,3} {
                                                   \path let \p1=(m-\row-\c.west), \p2=(m-\r-\c-nw) in coordinate (m-\r-\c-nw) at ({min(\x1,\x2)},\y2);
                                                   \path let \p1=(m-\row-\c.east), \p2=(m-\r-\c-se) in coordinate (m-\r-\c-se) at ({max(\x1,\x2)},\y2);
                                                 }
                                                 \foreach \col in {1,...,3} {
                                                   \path let \p1=(m-\r-\col.north), \p2=(m-\r-\c-nw) in coordinate (m-\r-\c-nw) at (\x2,{max(\y1,\y2)});
                                                   \path let \p1=(m-\r-\col.south), \p2=(m-\r-\c-se) in coordinate (m-\r-\c-se) at (\x2,{min(\y1,\y2)});
                                                 }
                                               }
                                             }
                                             \begin{pgfonlayer}{background} \fhighlight[yellow!20]{m-1-1-nw}{m-3-3-se} \end{pgfonlayer}
                                           \end{tikzpicture}
                                           \begin{pmatrix} \delta v_N \\ \delta v_E \\ \delta v_D \end{pmatrix}
                                         + \begin{tikzpicture}[baseline=-\the\dimexpr\fontdimen22\textfont2\relax,decoration=brace]
                                             \matrix (m)[matrix of math nodes,left delimiter={(},right delimiter={)},row sep=0.3em, column sep=0.4em,
                                                         nodes={rectangle,minimum height=2.3em,anchor=center}] {
                                                                0                  &amp; 0 &amp;       -\frac{v_E}{(R_E + h)^2}      \\
                                                                0                  &amp; 0 &amp;        \frac{v_N}{(R_N + h)^2}      \\
                                               - \frac{v_E}{(R_E + h)\cos^2{\phi}} &amp; 0 &amp;  \frac{v_E \tan{\phi}}{(R_E + h)^2} \\
                                             };

                                             \foreach \r in {1,3} {
                                               \foreach \c in {1,3} {
                                                 \coordinate (m-\r-\c-nw) at (100,-100);
                                                 \coordinate (m-\r-\c-se) at (-100,100);

                                                 \foreach \row in {1,...,3} {
                                                   \path let \p1=(m-\row-\c.west), \p2=(m-\r-\c-nw) in coordinate (m-\r-\c-nw) at ({min(\x1,\x2)},\y2);
                                                   \path let \p1=(m-\row-\c.east), \p2=(m-\r-\c-se) in coordinate (m-\r-\c-se) at ({max(\x1,\x2)},\y2);
                                                 }
                                                 \foreach \col in {1,...,3} {
                                                   \path let \p1=(m-\r-\col.north), \p2=(m-\r-\c-nw) in coordinate (m-\r-\c-nw) at (\x2,{max(\y1,\y2)});
                                                   \path let \p1=(m-\r-\col.south), \p2=(m-\r-\c-se) in coordinate (m-\r-\c-se) at (\x2,{min(\y1,\y2)});
                                                 }
                                               }
                                             }
                                             \begin{pgfonlayer}{background} \fhighlight[lime!20]{m-1-1-nw}{m-3-3-se} \end{pgfonlayer}
                                           \end{tikzpicture}
                                           \begin{pmatrix} \delta \phi \\ \delta \lambda \\ \delta h \end{pmatrix}
                                         \highlight[orange!20]{- \mathbf{C}_b^n} \boldsymbol{\delta \omega}_{ib}^b
\end{equation}" src="form_353.svg" width="2002" height="137"/></picture>
</p>
<h3><a class="anchor" id="LooselyCoupledKF_n-ErrorStateEquations-LocalLevelFrame-Derivation-Velocity"></a>
Velocity Equations</h3>
<p>The equations here mainly follow <a class="el" href="citelist.html#CITEREF_Titterton2004">[32]</a> Titterton, ch. 12.3.1.2, p. 343f</p>
<p>The time derivative of the velocity in local-navigation-frame coordinates is (see <a class="el" href="citelist.html#CITEREF_Titterton2004">[32]</a> Titterton, ch. 3.7.1, eq. 3.69, p. 47 or <a class="el" href="citelist.html#CITEREF_Jekeli2001">[13]</a> Jekeli, ch. 4.3.4, eq. 4.88, p. 127) <a class="anchor" id="eq-LCKF_n-Derivation-Velocity-timeDerivative"></a> </p><p class="formulaDsp">
<picture><source srcset="form_354_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-LCKF_n-Derivation-Velocity-timeDerivative}
  \boldsymbol{\dot{v}}^n
      = \overbrace{\boldsymbol{f}^n}^{\hidewidth\text{measured}\hidewidth}
        -\ \underbrace{(2 \boldsymbol{\omega}_{ie}^n + \boldsymbol{\omega}_{en}^n) \times \boldsymbol{v}^n}_{\text{coriolis acceleration}}
        +\ \overbrace{\mathbf{g}^n}^{\hidewidth\text{gravity}\hidewidth}
\end{equation}" src="form_354.svg" width="1621" height="67"/></picture>
</p>
<p> where</p><ul>
<li><picture><source srcset="form_126_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \boldsymbol{v}^n = \begin{pmatrix} v_N &amp; v_E &amp; v_D \end{pmatrix}^T $" src="form_126.svg" width="168" height="26"/></picture> is the velocity with respect to the Earth in local-navigation frame coordinates,</li>
<li><picture><source srcset="form_127_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \boldsymbol{f}^n = \begin{pmatrix} f_N &amp; f_E &amp; f_D \end{pmatrix}^T $" src="form_127.svg" width="170" height="26"/></picture> is the specific force vector as measured by a triad of accelerometers and resolved into local-navigation frame coordinates</li>
<li><picture><source srcset="form_128_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \boldsymbol{\omega}_{ie}^n $" src="form_128.svg" width="25" height="18"/></picture> is the turn rate of the Earth expressed in local-navigation frame coordinates</li>
<li><picture><source srcset="form_129_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \boldsymbol{\omega}_{en}^n $" src="form_129.svg" width="28" height="18"/></picture> is the turn rate of the local frame with respect to the Earth-fixed frame, called the transport rate, expressed in local-navigation frame coordinates</li>
<li><picture><source srcset="form_355_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \mathbf{g}^n $" src="form_355.svg" width="19" height="18"/></picture> is the local gravity vector which is a combination of (see <a class="el" href="citelist.html#CITEREF_Titterton2004">[32]</a> Titterton, ch. 3.7.1, eq. 3.75, p. 48)<ul>
<li><picture><source srcset="form_356_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \boldsymbol{\gamma}_{ib}^n $" src="form_356.svg" width="23" height="18"/></picture> the local gravitation vector (caused by effects of mass attraction)</li>
<li><picture><source srcset="form_234_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ -\boldsymbol{\omega}_{ie}^e \times [ \boldsymbol{\omega}_{ie}^e \times \mathbf{r}^e ] $" src="form_234.svg" width="131" height="19"/></picture> the centrifugal acceleration caused by the Earth's rotation</li>
</ul>
</li>
</ul>
<p>The estimated velocity follows the same propagation <a class="anchor" id="eq-LCKF_n-Derivation-Velocity-timeDerivative-estimate"></a> </p><p class="formulaDsp">
<picture><source srcset="form_357_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-LCKF_n-Derivation-Velocity-timeDerivative-estimate}
  \boldsymbol{\dot{\hat{v}}}^{\raise-0.45ex\hbox{$\scriptstyle n$}}
      = \boldsymbol{\hat{f}}^n
      - (2 \boldsymbol{\hat{\omega}}_{ie}^n + \boldsymbol{\hat{\omega}}_{en}^n) \times \boldsymbol{\hat{v}}_e^n
      + \mathbf{\hat{g}}^n
\end{equation}" src="form_357.svg" width="1607" height="25"/></picture>
</p>
<p>Differencing equation <a class="el" href="group__LooselyCoupledKF__n.html#eq-LCKF_n-Derivation-Velocity-timeDerivative"><picture><source srcset="form_358_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="\eqref{eq:eq-LCKF_n-Derivation-Velocity-timeDerivative}" src="form_358.svg" width="44" height="19"/></picture> </a> and <a class="el" href="group__LooselyCoupledKF__n.html#eq-LCKF_n-Derivation-Velocity-timeDerivative-estimate"><picture><source srcset="form_359_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="\eqref{eq:eq-LCKF_n-Derivation-Velocity-timeDerivative-estimate}" src="form_359.svg" width="44" height="19"/></picture> </a> we get <a class="anchor" id="eq-LCKF_n-Derivation-Velocity-timeDerivative-differential"></a> </p><p class="formulaDsp">
<picture><source srcset="form_360_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-LCKF_n-Derivation-Velocity-timeDerivative-differential}
\begin{aligned}
  \boldsymbol{\delta \dot{v}}^n &amp;= \boldsymbol{\dot{\hat{v}}}^{\raise-0.45ex\hbox{$\scriptstyle n$}} - \boldsymbol{\dot{v}}^n \\
                                &amp;= \mathbf{\hat{C}}_b^n \boldsymbol{\hat{f}}^b
                                       - \mathbf{C}_b^n \boldsymbol{f}^b
                                   - (2 \boldsymbol{\hat{\omega}}_{ie}^n + \boldsymbol{\hat{\omega}}_{en}^n) \times \boldsymbol{\hat{v}}^n
                                       + (2 \boldsymbol{\omega}_{ie}^n + \boldsymbol{\omega}_{en}^n) \times \boldsymbol{v}^n
                                   + \mathbf{\hat{g}}^n
                                       - \mathbf{g}^n
\end{aligned}
\end{equation}" src="form_360.svg" width="1754" height="56"/></picture>
</p>
<ul>
<li>Substituting equation <a class="el" href="group__LooselyCoupledKF__n.html#eq-LCKF_n-Derivation-Attitude-estimate-errors"><picture><source srcset="form_288_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="\eqref{eq:eq-LCKF_n-Derivation-Attitude-estimate-errors}" src="form_288.svg" width="44" height="19"/></picture> </a>: <picture><source srcset="form_361_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \mathbf{\hat{C}}_b^n \approx [\mathbf{I} - \mathbf{\Psi}] \mathbf{C}_b^n $" src="form_361.svg" width="124" height="23"/></picture></li>
<li>and writing<ul>
<li><picture><source srcset="form_362_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \boldsymbol{\delta f}^b = \boldsymbol{\hat{f}}^b - \boldsymbol{f}^b $" src="form_362.svg" width="110" height="25"/></picture></li>
<li><picture><source srcset="form_363_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \boldsymbol{\delta v}^n = \boldsymbol{\hat{v}}^n - \boldsymbol{v}^n $" src="form_363.svg" width="114" height="16"/></picture></li>
<li><picture><source srcset="form_364_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \boldsymbol{\delta \omega}_{ie}^n = \boldsymbol{\hat{\omega}}_{ie}^n - \boldsymbol{\omega}_{ie}^n $" src="form_364.svg" width="130" height="19"/></picture></li>
<li><picture><source srcset="form_365_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \boldsymbol{\delta \omega}_{en}^n = \boldsymbol{\hat{\omega}}_{en}^n - \boldsymbol{\omega}_{en}^n $" src="form_365.svg" width="142" height="19"/></picture></li>
<li><picture><source srcset="form_366_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \boldsymbol{\delta} \mathbf{g}^n = \mathbf{\hat{g}}^n - \mathbf{g}^n $" src="form_366.svg" width="114" height="19"/></picture></li>
</ul>
</li>
</ul>
<p>we get <a class="anchor" id="eq-LCKF_n-Derivation-Velocity-timeDerivative-differential-transformation"></a> </p><p class="formulaDsp">
<picture><source srcset="form_367_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-LCKF_n-Derivation-Velocity-timeDerivative-differential-transformation}
\begin{aligned}
  \boldsymbol{\delta \dot{v}}^n &amp;= [\mathbf{I} - \mathbf{\Psi}] \mathbf{C}_b^n \boldsymbol{\hat{f}}^b
                                       - \mathbf{C}_b^n \boldsymbol{f}^b
                                   - (2 \boldsymbol{\delta \omega}_{ie}^n + 2 \boldsymbol{\omega}_{ie}^n + \boldsymbol{\delta \omega}_{en}^n + \boldsymbol{\omega}_{en}^n) \times \boldsymbol{\hat{v}}^n
                                       + (2 \boldsymbol{\omega}_{ie}^n + \boldsymbol{\omega}_{en}^n) \times \boldsymbol{v}^n
                                   + \boldsymbol{\delta} \mathbf{g}^n \\
                                &amp;= \mathbf{C}_b^n \boldsymbol{\hat{f}}^b - \mathbf{\Psi} \mathbf{C}_b^n \boldsymbol{\hat{f}}^b
                                       - \mathbf{C}_b^n \boldsymbol{f}^b
                                   - (2 \boldsymbol{\omega}_{ie}^n + \boldsymbol{\omega}_{en}^n) \times \boldsymbol{\hat{v}}^n
                                   - (2 \boldsymbol{\delta \omega}_{ie}^n + \boldsymbol{\delta \omega}_{en}^n) \times \boldsymbol{\hat{v}}^n
                                       + (2 \boldsymbol{\omega}_{ie}^n + \boldsymbol{\omega}_{en}^n) \times \boldsymbol{v}^n
                                   + \boldsymbol{\delta} \mathbf{g}^n \\
                                &amp;= - \boldsymbol{\delta \psi} \times \mathbf{C}_b^n \boldsymbol{\hat{f}}^b
                                   + \highlight[red!20]{\mathbf{C}_b^n \boldsymbol{\delta f}^b}
                                   - (2 \boldsymbol{\omega}_{ie}^n + \boldsymbol{\omega}_{en}^n) \times \boldsymbol{\delta v}^n
                                   - (2 \boldsymbol{\delta \omega}_{ie}^n + \boldsymbol{\delta \omega}_{en}^n) \times \boldsymbol{\hat{v}}^n
                                   + \boldsymbol{\delta} \mathbf{g}^n \\
                                &amp;= (\mathbf{C}_b^n \boldsymbol{\delta f}^b + \mathbf{C}_b^n \boldsymbol{f}^b) \times \boldsymbol{\delta \psi}
                                   + \highlight[red!20]{\mathbf{C}_b^n \boldsymbol{\delta f}^b}
                                   - (2 \boldsymbol{\omega}_{ie}^n + \boldsymbol{\omega}_{en}^n) \times \boldsymbol{\delta v}^n
                                   - (2 \boldsymbol{\delta \omega}_{ie}^n + \boldsymbol{\delta \omega}_{en}^n) \times (\boldsymbol{\delta v}^n + \boldsymbol{v}^n)
                                   + \boldsymbol{\delta} \mathbf{g}^n \\
\end{aligned}
\end{equation}" src="form_367.svg" width="1869" height="138"/></picture>
</p>
<p> Now neglecting error product terms <picture><source srcset="form_368_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \boldsymbol{\delta f}^b \times \boldsymbol{\delta \psi} \approx 0 $" src="form_368.svg" width="105" height="23"/></picture> and <picture><source srcset="form_369_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ (2 \boldsymbol{\delta \omega}_{ie}^n + \boldsymbol{\delta \omega}_{en}^n) \times \boldsymbol{\delta v}^n \approx 0$" src="form_369.svg" width="201" height="19"/></picture> <a class="anchor" id="eq-LCKF_n-Derivation-Velocity-timeDerivative-differential-transformation-neglect"></a> </p><p class="formulaDsp">
<picture><source srcset="form_370_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-LCKF_n-Derivation-Velocity-timeDerivative-differential-transformation-neglect}
  \boldsymbol{\delta \dot{v}}^n \approx \highlight[purple!20]{\boldsymbol{f}^n \times} \boldsymbol{\delta \psi}
                                   + \highlight[red!20]{\mathbf{C}_b^n \boldsymbol{\delta f}^b}
                                   - (2 \boldsymbol{\omega}_{ie}^n + \boldsymbol{\omega}_{en}^n) \times \boldsymbol{\delta v}^n
                                   - (2 \boldsymbol{\delta \omega}_{ie}^n + \boldsymbol{\delta \omega}_{en}^n) \times \boldsymbol{v}^n
                                   + \boldsymbol{\delta} \mathbf{g}^n
\end{equation}" src="form_370.svg" width="1776" height="35"/></picture>
</p>
<p> This is equal to <a class="el" href="citelist.html#CITEREF_Titterton2004">[32]</a> Titterton, ch. 12.3.1.2, eq. 12.21, p. 344, except the sign of the gravity error term.</p>
<p>Substituting equations <a class="el" href="group__LooselyCoupledKF__n.html#eq-LCKF_n-Derivation-Attitude-transport-rate"><picture><source srcset="form_371_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="\eqref{eq:eq-LCKF_n-Derivation-Attitude-transport-rate}" src="form_371.svg" width="44" height="19"/></picture> </a>, <a class="el" href="group__LooselyCoupledKF__n.html#eq-LCKF_n-Derivation-Attitude-transport-rate-differential"><picture><source srcset="form_350_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="\eqref{eq:eq-LCKF_n-Derivation-Attitude-transport-rate-differential}" src="form_350.svg" width="44" height="19"/></picture> </a>, <a class="el" href="group__LooselyCoupledKF__n.html#eq-LCKF_n-Derivation-Attitude-earth-rotation-n"><picture><source srcset="form_372_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="\eqref{eq:eq-LCKF_n-Derivation-Attitude-earth-rotation-n}" src="form_372.svg" width="44" height="19"/></picture> </a> and <a class="el" href="group__LooselyCoupledKF__n.html#eq-LCKF_n-Derivation-Attitude-earth-rotation-n-differential"><picture><source srcset="form_351_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="\eqref{eq:eq-LCKF_n-Derivation-Attitude-earth-rotation-n-differential}" src="form_351.svg" width="44" height="19"/></picture> </a> leads to <a class="anchor" id="eq-LCKF_n-Derivation-Velocity-timeDerivative-final-pre"></a> </p><p class="formulaDsp">
<picture><source srcset="form_373_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-LCKF_n-Derivation-Velocity-timeDerivative-final-pre}
\renewcommand*{\arraystretch}{1.9}
\begin{aligned}
  \boldsymbol{\delta \dot{v}}^n &amp;\approx \highlight[purple!20]{\boldsymbol{f}^n \times} \boldsymbol{\delta \psi}
                                   + \highlight[red!20]{\mathbf{C}_b^n \boldsymbol{\delta f}^b}
                                   - \left[\begin{pmatrix} 2 \omega_{ie} \cos{\phi} \\ 0 \\ - 2 \omega_{ie} \sin{\phi} \end{pmatrix}
                                      + \begin{pmatrix} \frac{v_E}{R_E + h} \\ -\frac{v_N}{R_N + h} \\ -\frac{v_E \tan{\phi}}{R_E + h} \end{pmatrix} \right]
                                          \times \begin{pmatrix} \delta v_N \\ \delta v_E \\ \delta v_D \end{pmatrix}
                                   - \left[\begin{pmatrix} -2\omega_{ie}\sin{\phi}\ \delta \phi \\ 0 \\ -2\omega_{ie}\cos{\phi}\ \delta \phi \end{pmatrix}
                                      + \begin{pmatrix}
                                          \frac{1}{R_E + h} \delta v_E - \frac{v_E}{(R_E + h)^2} \delta h \\
                                          -\frac{1}{R_N + h} \delta v_N + \frac{v_N}{(R_N + h)^2} \delta h \\
                                          -\frac{\tan{\phi}}{R_E + h} \delta v_E + \frac{v_E \tan{\phi}}{(R_E + h)^2} \delta h - \frac{v_E}{(R_E + h)\cos^2{\phi}} \delta \phi \\
                                        \end{pmatrix} \right]
                                          \times \begin{pmatrix} v_N \\ v_E \\ v_D \end{pmatrix}
                                   + \boldsymbol{\delta} \mathbf{g}^n \\
                                &amp;= \highlight[purple!20]{\boldsymbol{f}^n \times} \boldsymbol{\delta \psi}
                                   + \highlight[red!20]{\mathbf{C}_b^n \boldsymbol{\delta f}^b}
                                   + \begin{pmatrix} - 2 \omega_{ie} \cos{\phi} - \frac{v_E}{R_E + h} \\
                                                      \frac{v_N}{R_N + h} \\
                                                      2 \omega_{ie} \sin{\phi} + \frac{v_E \tan{\phi}}{R_E + h}
                                     \end{pmatrix}
                                     \times \begin{pmatrix} \delta v_N \\
                                                            \delta v_E \\
                                                            \delta v_D \\
                                            \end{pmatrix}
                                   + \begin{pmatrix} 2\omega_{ie}\sin{\phi}\ \delta \phi - \frac{1}{R_E + h} \delta v_E + \frac{v_E}{(R_E + h)^2} \delta h \\
                                                     \frac{1}{R_N + h} \delta v_N - \frac{v_N}{(R_N + h)^2} \delta h \\
                                                     2\omega_{ie}\cos{\phi}\ \delta \phi + \frac{\tan{\phi}}{R_E + h} \delta v_E - \frac{v_E \tan{\phi}}{(R_E + h)^2} \delta h + \frac{v_E}{(R_E + h)\cos^2{\phi}} \delta \phi
                                     \end{pmatrix}
                                     \times \begin{pmatrix} v_N \\
                                                            v_E \\
                                                            v_D \\
                                            \end{pmatrix}
                                   + \boldsymbol{\delta} \mathbf{g}^n \\
                                &amp;= \highlight[purple!20]{\boldsymbol{f}^n \times} \boldsymbol{\delta \psi}
                                   + \highlight[red!20]{\mathbf{C}_b^n \boldsymbol{\delta f}^b}
                                   + \begin{pmatrix} \left(\frac{v_N}{R_N + h} \right) \cdot \delta v_D
                                                            - \left(2 \omega_{ie} \sin{\phi} + \frac{v_E \tan{\phi}}{R_E + h} \right) \cdot \delta v_E \\
                                                     \left(2 \omega_{ie} \sin{\phi} + \frac{v_E \tan{\phi}}{R_E + h} \right) \cdot \delta v_N
                                                            - \left(- 2 \omega_{ie} \cos{\phi} - \frac{v_E}{R_E + h} \right) \cdot \delta v_D \\
                                                     \left(- 2 \omega_{ie} \cos{\phi} - \frac{v_E}{R_E + h} \right) \cdot \delta v_E
                                                            - \left(\frac{v_N}{R_N + h} \right) \cdot \delta v_N \\
                                     \end{pmatrix}
                                   + \begin{pmatrix} \left( \frac{1}{R_N + h} \delta v_N - \frac{v_N}{(R_N + h)^2} \delta h \right) \cdot v_D - \left( 2\omega_{ie}\cos{\phi}\ \delta \phi + \frac{\tan{\phi}}{R_E + h} \delta v_E - \frac{v_E \tan{\phi}}{(R_E + h)^2} \delta h + \frac{v_E}{(R_E + h)\cos^2{\phi}} \delta \phi \right) \cdot v_E \\
                                                     \left( 2\omega_{ie}\cos{\phi}\ \delta \phi + \frac{\tan{\phi}}{R_E + h} \delta v_E - \frac{v_E \tan{\phi}}{(R_E + h)^2} \delta h + \frac{v_E}{(R_E + h)\cos^2{\phi}} \delta \phi \right) \cdot v_N - \left( 2\omega_{ie}\sin{\phi}\ \delta \phi - \frac{1}{R_E + h} \delta v_E + \frac{v_E}{(R_E + h)^2} \delta h \right) \cdot v_D \\
                                                     \left( 2\omega_{ie}\sin{\phi}\ \delta \phi - \frac{1}{R_E + h} \delta v_E + \frac{v_E}{(R_E + h)^2} \delta h \right) \cdot v_E - \left( \frac{1}{R_N + h} \delta v_N - \frac{v_N}{(R_N + h)^2} \delta h \right) \cdot v_N \\
                                     \end{pmatrix}
                                   + \boldsymbol{\delta} \mathbf{g}^n \\
\end{aligned}
\end{equation}" src="form_373.svg" width="2296" height="369"/></picture>
</p>
<p>The gravity error can be expressed as (see <a class="el" href="citelist.html#CITEREF_Groves2013">[10]</a> Groves, ch. 14.2.4, eq. 14.59, p. 586) <a class="anchor" id="eq-LCKF_n-Derivation-Velocity-gravityError"></a> </p><p class="formulaDsp">
<picture><source srcset="form_374_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-LCKF_n-Derivation-Velocity-gravityError}
\begin{aligned}
  \boldsymbol{\delta} \mathbf{g}^e \approx - \frac{2 g_0}{r_{eS}^e} \delta h \mathbf{u}_D^e
\end{aligned}
\end{equation}" src="form_374.svg" width="1540" height="44"/></picture>
</p>
<p> where</p><ul>
<li><picture><source srcset="form_375_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \mathbf{u}_D^e $" src="form_375.svg" width="23" height="18"/></picture> is the local navigation frame down unit vector</li>
<li><picture><source srcset="form_248_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ h &lt;&lt; r_{eS}^e $" src="form_248.svg" width="70" height="18"/></picture> is assumed</li>
<li>centrifugal term and latitude-error dependence have been neglected</li>
</ul>
<p>Reordering the terms leads to the final form <a class="anchor" id="eq-LCKF_n-Derivation-Velocity-timeDerivative-final"></a> </p><p class="formulaDsp">
<picture><source srcset="form_376_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-LCKF_n-Derivation-Velocity-timeDerivative-final}
  \boldsymbol{\delta \dot{v}}^n \approx \highlight[purple!20]{\boldsymbol{f}^n \times} \boldsymbol{\delta \psi}
                                        + \begin{tikzpicture}[baseline=-\the\dimexpr\fontdimen22\textfont2\relax,decoration=brace]
                                            \matrix (m)[matrix of math nodes,left delimiter={(},right delimiter={)},row sep=0.3em, column sep=0.4em,
                                                        nodes={rectangle,minimum height=2.3em,anchor=center}] {
                                                        \frac{v_D}{R_N + h} &amp; - \frac{v_E \tan{\phi}}{R_E + h} - 2 \omega_{ie} \sin{\phi} - \frac{v_E \tan{\phi}}{R_E + h} &amp; \frac{v_N}{R_N + h} \\
                                                        \frac{v_E \tan{\phi}}{R_E + h} + 2 \omega_{ie} \sin{\phi} &amp; \frac{v_N \tan{\phi}}{R_E + h} + \frac{v_D}{R_E + h} &amp; \frac{v_E}{R_E + h} + 2 \omega_{ie} \cos{\phi} \\
                                                        - \frac{v_N}{R_N + h} - \frac{v_N}{R_N + h} &amp; - 2 \omega_{ie} \cos{\phi} - \frac{v_E}{R_E + h} - \frac{v_E}{R_E + h} &amp; 0 \\
                                            };

                                            \foreach \r in {1,3} {
                                              \foreach \c in {1,3} {
                                                \coordinate (m-\r-\c-nw) at (100,-100);
                                                \coordinate (m-\r-\c-se) at (-100,100);

                                                \foreach \row in {1,...,3} {
                                                  \path let \p1=(m-\row-\c.west), \p2=(m-\r-\c-nw) in coordinate (m-\r-\c-nw) at ({min(\x1,\x2)},\y2);
                                                  \path let \p1=(m-\row-\c.east), \p2=(m-\r-\c-se) in coordinate (m-\r-\c-se) at ({max(\x1,\x2)},\y2);
                                                }
                                                \foreach \col in {1,...,3} {
                                                  \path let \p1=(m-\r-\col.north), \p2=(m-\r-\c-nw) in coordinate (m-\r-\c-nw) at (\x2,{max(\y1,\y2)});
                                                  \path let \p1=(m-\r-\col.south), \p2=(m-\r-\c-se) in coordinate (m-\r-\c-se) at (\x2,{min(\y1,\y2)});
                                                }
                                              }
                                            }
                                            \begin{pgfonlayer}{background} \fhighlight[blue!20]{m-1-1-nw}{m-3-3-se} \end{pgfonlayer}
                                          \end{tikzpicture}
                                          \begin{pmatrix} \delta v_N \\
                                                          \delta v_E \\
                                                          \delta v_D \\
                                          \end{pmatrix}
                                        + \begin{tikzpicture}[baseline=-\the\dimexpr\fontdimen22\textfont2\relax,decoration=brace]
                                            \matrix (m)[matrix of math nodes,left delimiter={(},right delimiter={)},row sep=0.3em, column sep=0.4em,
                                                        nodes={rectangle,minimum height=2.3em,anchor=center}] {
                                                        - \frac{v_E^2}{(R_E + h)\cos^2{\phi}} - 2 v_E \omega_{ie}\cos{\phi} &amp; 0 &amp; \frac{v_E^2 \tan{\phi}}{(R_E + h)^2} - \frac{v_N v_D}{(R_N + h)^2} \\
                                                        \frac{v_N v_E}{(R_E + h)\cos^2{\phi}} + 2 v_N \omega_{ie}\cos{\phi} - 2 v_D \omega_{ie}\sin{\phi} &amp; 0 &amp; - \frac{v_N v_E \tan{\phi}}{(R_E + h)^2} - \frac{v_E v_D}{(R_E + h)^2} \\
                                                        2 v_E \omega_{ie}\sin{\phi} &amp; 0 &amp; \frac{v_E^2}{(R_E + h)^2} + \frac{v_N^2}{(R_N + h)^2} - \frac{2 g_0}{r_{eS}^e} \\
                                            };

                                            \foreach \r in {1,3} {
                                              \foreach \c in {1,3} {
                                                \coordinate (m-\r-\c-nw) at (100,-100);
                                                \coordinate (m-\r-\c-se) at (-100,100);

                                                \foreach \row in {1,...,3} {
                                                  \path let \p1=(m-\row-\c.west), \p2=(m-\r-\c-nw) in coordinate (m-\r-\c-nw) at ({min(\x1,\x2)},\y2);
                                                  \path let \p1=(m-\row-\c.east), \p2=(m-\r-\c-se) in coordinate (m-\r-\c-se) at ({max(\x1,\x2)},\y2);
                                                }
                                                \foreach \col in {1,...,3} {
                                                  \path let \p1=(m-\r-\col.north), \p2=(m-\r-\c-nw) in coordinate (m-\r-\c-nw) at (\x2,{max(\y1,\y2)});
                                                  \path let \p1=(m-\r-\col.south), \p2=(m-\r-\c-se) in coordinate (m-\r-\c-se) at (\x2,{min(\y1,\y2)});
                                                }
                                              }
                                            }
                                            \begin{pgfonlayer}{background} \fhighlight[violet!20]{m-1-1-nw}{m-3-3-se} \end{pgfonlayer}
                                          \end{tikzpicture}
                                          \begin{pmatrix} \delta \phi \\
                                                          \delta \lambda \\
                                                          \delta h \\
                                          \end{pmatrix}
                                        + \highlight[red!20]{\mathbf{C}_b^n \boldsymbol{\delta f}^b}
\end{equation}" src="form_376.svg" width="2268" height="147"/></picture>
</p>
<h2><a class="anchor" id="LooselyCoupledKF_n-Appendix-ErrorStateEquations-LocalLevelFrame-Comparison"></a>
Error Equations comparison</h2>
<h3><a class="anchor" id="LooselyCoupledKF_n-Appendix-ErrorStateEquations-LocalLevelFrame-Comparison-Titterton"></a>
Titterton</h3>
<p><a class="el" href="citelist.html#CITEREF_Titterton2004">[32]</a> Titterton, ch. 12.3.1.3, eq. 12.28, p. 345 has different <em>sign</em> in equations <picture><source srcset="form_252_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \highlight[yellow!20]{\mathbf{F}_{\delta \dotup{\psi},\delta v}^n} $" src="form_252.svg" width="61" height="33"/></picture>, <picture><source srcset="form_253_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \highlight[lime!20]{\mathbf{F}_{\delta \dotup{\psi},\delta r}^n} $" src="form_253.svg" width="61" height="33"/></picture>, <picture><source srcset="form_254_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \highlight[orange!20]{\mathbf{F}_{\delta \dotup{\psi},\delta \omega}^n} $" src="form_254.svg" width="63" height="33"/></picture>, <picture><source srcset="form_255_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \highlight[purple!20]{\mathbf{F}_{\delta \dotup{v},\delta \psi}^n} $" src="form_255.svg" width="61" height="32"/></picture></p>
<p><a class="anchor" id="eq-LCKF_n-stateMatrix-Titterton"></a> </p><p class="formulaDsp">
<picture><source srcset="form_377_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-LCKF_n-stateMatrix-Titterton}
  \begin{tikzpicture}[baseline=-\the\dimexpr\fontdimen22\textfont2\relax,decoration=brace]
    \matrix (m)[matrix of math nodes,left delimiter={(},right delimiter={)},
                nodes={rectangle,text width=1.5em,align=center,minimum height=2.3em,anchor=center},row sep=0.3em, column sep=0.4em,] {
      \delta \dotup{R}              \\ \delta \dotup{P}              \\ \delta \dotup{Y}              \\
      \delta \dotup{v}_{N}          \\ \delta \dotup{v}_{E}          \\ \delta \dotup{v}_{D}          \\
      \delta \dotup{\phi}           \\ \delta \dotup{\lambda}        \\ \delta \dotup{h}              \\
      \delta \dotup{f}_{x}^{b}      \\ \delta \dotup{f}_{y}^{b}      \\ \delta \dotup{f}_{z}^{b}      \\
      \delta \dotup{\omega}_{x}^{b} \\ \delta \dotup{\omega}_{y}^{b} \\ \delta \dotup{\omega}_{z}^{b} \\
    };
    \draw[decorate,transform canvas={yshift=.5em},thick] (m-1-1.north west) -- node[above=2pt] {$\boldsymbol{\delta} \mathbf{\dot{x}}$} (m-1-1.north east);

    \begin{pgfonlayer}{background}
      \fhighlight[green!20]{m-1-1}{m-3-1}
      \fhighlight[blue!20]{m-4-1}{m-6-1}
      \fhighlight[cyan!20]{m-7-1}{m-9-1}
      \fhighlight[red!20]{m-10-1}{m-12-1}
      \fhighlight[orange!20]{m-13-1}{m-15-1}
    \end{pgfonlayer}
  \end{tikzpicture}
  =
  \begin{tikzpicture}[baseline=-\the\dimexpr\fontdimen22\textfont2\relax,decoration=brace]
    \matrix (m)[matrix of math nodes,left delimiter={(},right delimiter={)},nodes in empty cells,
                row sep=0.3em, column sep=0.4em,
                nodes={rectangle,minimum height=2.3em,anchor=center},] {
                  0            &amp;     \omega_{in,3}^{n}    &amp;    -\omega_{in,2}^{n}    &amp;                             0                            &amp;         \highlight[red!60]{+}\frac{1}{R_E + h}            &amp;                       0                      &amp;                             \highlight[red!60]{-}\omega_{ie}\sin{\phi}                             &amp;      0       &amp;                \highlight[red!60]{-}\frac{v_E}{(R_E + h)^2}                  &amp;  &amp;                &amp;  &amp;  &amp;                                     &amp; \\
         -\omega_{in,3}^{n}    &amp;             0            &amp;     \omega_{in,1}^{n}    &amp;        \highlight[red!60]{-}\frac{1}{R_N + h}            &amp;                             0                             &amp;                       0                      &amp;                                                0                                                   &amp;      0       &amp;                \highlight[red!60]{+}\frac{v_N}{(R_N + h)^2}                  &amp;  &amp;  \mathbf{0}_3  &amp;  &amp;  &amp; \highlight[red!60]{-}\mathbf{C}_b^n &amp; \\
          \omega_{in,2}^{n}    &amp;    -\omega_{in,1}^{n}    &amp;             0            &amp;                             0                            &amp;       \highlight[red!60]{-}\frac{\tan{\phi}}{R_E + h}     &amp;                       0                      &amp; \highlight[red!60]{-}\omega_{ie}\cos{\phi} \highlight[red!60]{-} \frac{v_E}{(R_E + h)\cos^2{\phi}} &amp;      0       &amp;            \highlight[red!60]{+}\frac{v_E \tan{\phi}}{(R_E + h)^2}           &amp;  &amp;                &amp;  &amp;  &amp;                                     &amp; \\
                  0            &amp; \highlight[red!60]{-}f_D &amp; \highlight[red!60]{+}f_E &amp;                    \frac{v_D}{R_N + h}                   &amp; -2\frac{v_E \tan{\phi}}{R_E + h} - 2\omega_{ie}\sin{\phi} &amp;              \frac{v_N}{R_N + h}             &amp;                   -\frac{v_E^2}{(R_E+h)\cos^2{\phi}}-2v_E\omega_{ie}\cos{\phi}                     &amp;      0       &amp;         \frac{v_E^2\tan{\phi}}{(R_E+h)^2} - \frac{v_Nv_D}{(R_N+h)^2}         &amp;  &amp;                &amp;  &amp;  &amp;                                     &amp; \\
      \highlight[red!60]{+}f_D &amp;             0            &amp; \highlight[red!60]{-}f_N &amp;  \frac{v_E \tan{\phi}}{R_E + h} + 2\omega_{ie}\sin{\phi} &amp;            \frac{v_N \tan{\phi} + v_D}{R_E + h}           &amp; \frac{v_E}{R_E + h} + 2\omega_{ie}\cos{\phi} &amp;    \frac{v_N v_E}{(R_E+h)\cos^2{\phi}} + 2v_N\omega_{ie}\cos{\phi} - 2v_D\omega_{ie}\sin{\phi}     &amp;      0       &amp;                -\frac{v_Nv_E\tan{\phi} + v_Ev_D}{(R_E + h)^2}                &amp;  &amp; \mathbf{C}_b^n &amp;  &amp;  &amp;             \mathbf{0}_3            &amp; \\
      \highlight[red!60]{-}f_E &amp; \highlight[red!60]{+}f_N &amp;             0            &amp;                  -\frac{2v_N}{R_N + h}                   &amp;       -\frac{2v_E}{R_E + h} - 2\omega_{ie}\cos{\phi}      &amp;                       0                      &amp;                                     2v_E\omega_{ie}\sin{\phi}                                      &amp;      0       &amp; \frac{v_E^2}{(R_E + h)^2} + \frac{v_N^2}{(R_N + h)^2} -\frac{2g_0}{r_{eS}^e} &amp;  &amp;                &amp;  &amp;  &amp;                                     &amp; \\
                               &amp;                          &amp;                          &amp;                      \frac{1}{R_N+h}                     &amp;                             0                             &amp;                       0                      &amp;                                                0                                                   &amp;      0       &amp;                           -\frac{v_N}{(R_N + h)^2}                           &amp;  &amp;                &amp;  &amp;  &amp;                                     &amp; \\
                               &amp;       \mathbf{0}_3       &amp;                          &amp;                             0                            &amp;                \frac{1}{(R_E+h)\cos{\phi}}                &amp;                       0                      &amp;                              \frac{v_E\tan{\phi}}{(R_E+h)\cos{\phi}}                               &amp;      0       &amp;                      -\frac{v_E}{(R_E + h)^2\cos{\phi}}                      &amp;  &amp;  \mathbf{0}_3  &amp;  &amp;  &amp;             \mathbf{0}_3            &amp; \\
                               &amp;                          &amp;                          &amp;                             0                            &amp;                             0                             &amp;                      -1                      &amp;                                                0                                                   &amp;      0       &amp;                                       0                                      &amp;  &amp;                &amp;  &amp;  &amp;                                     &amp; \\
                               &amp;                          &amp;                          &amp;                                                          &amp;                                                           &amp;                                              &amp;                                                                                                    &amp;              &amp;                                                                              &amp;  &amp;                &amp;  &amp;  &amp;                                     &amp; \\
                               &amp;       \mathbf{0}_3       &amp;                          &amp;                                                          &amp;                       \mathbf{0}_3                        &amp;                                              &amp;                                                                                                    &amp; \mathbf{0}_3 &amp;                                                                              &amp;  &amp;  \mathbf{0}_3  &amp;  &amp;  &amp;             \mathbf{0}_3            &amp; \\
                               &amp;                          &amp;                          &amp;                                                          &amp;                                                           &amp;                                              &amp;                                                                                                    &amp;              &amp;                                                                              &amp;  &amp;                &amp;  &amp;  &amp;                                     &amp; \\
                               &amp;                          &amp;                          &amp;                                                          &amp;                                                           &amp;                                              &amp;                                                                                                    &amp;              &amp;                                                                              &amp;  &amp;                &amp;  &amp;  &amp;                                     &amp; \\
                               &amp;       \mathbf{0}_3       &amp;                          &amp;                                                          &amp;                       \mathbf{0}_3                        &amp;                                              &amp;                                                                                                    &amp; \mathbf{0}_3 &amp;                                                                              &amp;  &amp;  \mathbf{0}_3  &amp;  &amp;  &amp;             \mathbf{0}_3            &amp; \\
                               &amp;                          &amp;                          &amp;                                                          &amp;                                                           &amp;                                              &amp;                                                                                                    &amp;              &amp;                                                                              &amp;  &amp;                &amp;  &amp;  &amp;                                     &amp; \\
    };

    \foreach \r in {1,3,4,6,7,9} {
      \foreach \c in {1,3,4,6,7,9,10,12,13,15} {
        \coordinate (m-\r-\c-nw) at (100,-100);
        \coordinate (m-\r-\c-se) at (-100,100);

        \foreach \row in {1,...,9} {
          \path let \p1=(m-\row-\c.west), \p2=(m-\r-\c-nw) in coordinate (m-\r-\c-nw) at ({min(\x1,\x2)},\y2);
          \path let \p1=(m-\row-\c.east), \p2=(m-\r-\c-se) in coordinate (m-\r-\c-se) at ({max(\x1,\x2)},\y2);
        }
        \foreach \col in {1,...,15} {
          \path let \p1=(m-\r-\col.north), \p2=(m-\r-\c-nw) in coordinate (m-\r-\c-nw) at (\x2,{max(\y1,\y2)});
          \path let \p1=(m-\r-\col.south), \p2=(m-\r-\c-se) in coordinate (m-\r-\c-se) at (\x2,{min(\y1,\y2)});
        }
      }
    }

    \path let \p1=(m-1-1-nw), \p2=(m-1-15-se) in coordinate (m-1-15-ne) at (\x2,\y1);
    \draw[decorate,transform canvas={yshift=.5em},thick] (m-1-1-nw) -- node[above=2pt] {$\mathbf{F}$} (m-1-15-ne);

    \begin{pgfonlayer}{background}
      \fhighlight[green!20]{m-1-1-nw}{m-3-3-se}
      \fhighlight[yellow!20]{m-1-4-nw}{m-3-6-se}
      \fhighlight[lime!20]{m-1-7-nw}{m-3-9-se}
      \fhighlight[orange!20]{m-1-13-nw}{m-3-15-se}
      \fhighlight[purple!20]{m-4-1-nw}{m-6-3-se}
      \fhighlight[blue!20]{m-4-4-nw}{m-6-6-se}
      \fhighlight[violet!20]{m-4-7-nw}{m-6-9-se}
      \fhighlight[red!20]{m-4-10-nw}{m-6-12-se}
      \fhighlight[teal!20]{m-7-4-nw}{m-9-6-se}
      \fhighlight[cyan!20]{m-7-7-nw}{m-9-9-se}
    \end{pgfonlayer}
  \end{tikzpicture}
  \cdot
  \begin{tikzpicture}[baseline=-\the\dimexpr\fontdimen22\textfont2\relax,decoration=brace]
    \matrix (m)[matrix of math nodes,left delimiter={(},right delimiter={)},row sep=0.3em, column sep=0.4em,
                nodes={rectangle,text width=1.5em,align=center,minimum height=2.3em,anchor=center},] {
      \delta R              \\ \delta P              \\ \delta Y              \\
      \delta v_{N}          \\ \delta v_{E}          \\ \delta v_{D}          \\
      \delta \phi           \\ \delta \lambda        \\ \delta h              \\
      \delta f_{x}^{b}      \\ \delta f_{y}^{b}      \\ \delta f_{z}^{b}      \\
      \delta \omega_{x}^{b} \\ \delta \omega_{y}^{b} \\ \delta \omega_{z}^{b} \\
    };
    \draw[decorate,transform canvas={yshift=.5em},thick] (m-1-1.north west) -- node[above=2pt] {$\boldsymbol{\delta} \mathbf{x}$} (m-1-1.north east);

    \begin{pgfonlayer}{background}
      \fhighlight[green!20]{m-1-1}{m-3-1}
      \fhighlight[blue!20]{m-4-1}{m-6-1}
      \fhighlight[cyan!20]{m-7-1}{m-9-1}
      \fhighlight[red!20]{m-10-1}{m-12-1}
      \fhighlight[orange!20]{m-13-1}{m-15-1}
    \end{pgfonlayer}
  \end{tikzpicture}
\end{equation}" src="form_377.svg" width="2331" height="716"/></picture>
</p>
<p>As all signs related to the attitude error have a different sign, it can be explained by the attitude error being defined in the opposite direction. To check this, we can look at the definition of the correction of the state with the attitude errors (<a class="el" href="citelist.html#CITEREF_Groves2013">[10]</a> Groves, ch. 14.1.1, eq. 14.7, p. 564) <a class="anchor" id="eq-LCKF_n-stateMatrix-Groves-attitude-correction"></a> </p><p class="formulaDsp">
<picture><source srcset="form_378_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-LCKF_n-stateMatrix-Groves-attitude-correction}
  \mathbf{C}_b^n \approx (\mathbf{I}_3 - [\boldsymbol{\delta \psi}_{nb}^n \times]) \mathbf{\hat{C}}_b^n
\end{equation}" src="form_378.svg" width="1565" height="23"/></picture>
</p>
<p> while Titterton rearranges equation <a class="el" href="group__LooselyCoupledKF__n.html#eq-LCKF_n-Derivation-Attitude-estimate-errors"><picture><source srcset="form_288_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="\eqref{eq:eq-LCKF_n-Derivation-Attitude-estimate-errors}" src="form_288.svg" width="44" height="19"/></picture> </a> and defines the correction as (<a class="el" href="citelist.html#CITEREF_Titterton2004">[32]</a> Titterton, ch. 13.6.2.3, eq. 13.15, p. 407) <a class="anchor" id="eq-LCKF_n-stateMatrix-Groves-attitude-correction-Titterton"></a> </p><p class="formulaDsp">
<picture><source srcset="form_379_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-LCKF_n-stateMatrix-Groves-attitude-correction-Titterton}
  \mathbf{C}_b^n = (\mathbf{I}_3 + [\boldsymbol{\delta \psi} \times]) \mathbf{\hat{C}}_b^n
\end{equation}" src="form_379.svg" width="1556" height="23"/></picture>
</p>
<p> Therefore the attitude error is defined differently in Groves and Titterton, which explains the sign change in the error equations.</p>
<h3><a class="anchor" id="LooselyCoupledKF_n-Appendix-ErrorStateEquations-LocalLevelFrame-Comparison-Gleason"></a>
Gleason</h3>
<p><a class="el" href="citelist.html#CITEREF_Gleason2009">[8]</a> Gleason, ch. 6.2.5, eq. 6.21-6.23, p. 157 define the same error equations as Titterton, but has a bracket mistake inside the velocity equation (bracket should include the '2') <a class="anchor" id="eq-LCKF_n-stateMatrix-Gleason-position-error"></a> </p><p class="formulaDsp">
<picture><source srcset="form_380_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-LCKF_n-stateMatrix-Gleason-position-error}
\begin{aligned}
  \boldsymbol{\delta} \mathbf{\dot{p}}  &amp;= T' \boldsymbol{\delta} \mathbf{p}^n + T \boldsymbol{\delta v}^n \\
  \boldsymbol{\delta \dot{v}}^n         &amp;= \highlight[purple!20]{\left[ (\mathbf{C}_b^n \boldsymbol{f}^b) \times \right]} \boldsymbol{\delta \psi}_{nb}^n
                                            \highlight[red!20]{+ \mathbf{C}_b^n} \boldsymbol{\delta f}^b
                                           - \left[ \highlight[red!60]{ 2 ( }\boldsymbol{\omega}_{ie}^n + \boldsymbol{\omega}_{en}^n) \times \right] \boldsymbol{\delta v}^n
                                           - \left[ (2 \boldsymbol{\delta \omega}_{ie}^n + \boldsymbol{\delta \omega}_{en}^n) \times \right] \boldsymbol{v}^n
                                           + \boldsymbol{\delta} \mathbf{g}^n \\
  \boldsymbol{\delta \dot{\psi}}_{nb}^n &amp;= \highlight[green!20]{- \left[ \boldsymbol{\omega}_{in}^n \times \right]} \boldsymbol{\delta \psi}_{nb}^n + \boldsymbol{\delta \omega}_{in}^n \highlight[orange!20]{-\mathbf{C}_b^n} \boldsymbol{\delta \omega}_{ib}^b
\end{aligned}
\end{equation}" src="form_380.svg" width="1825" height="107"/></picture>
</p>
<h3><a class="anchor" id="LooselyCoupledKF_n-Appendix-ErrorStateEquations-LocalLevelFrame-Comparison-Noureldin"></a>
Noureldin</h3>
<p>Extracting the equations from <a class="el" href="citelist.html#CITEREF_Noureldin2013">[21]</a> Noureldin, ch. 6.1.5, eq. 6.76, p. 219 gives</p>
<p><a class="anchor" id="eq-LCKF_n-stateMatrix-Noureldin-Position"></a> </p><p class="formulaDsp">
<picture><source srcset="form_381_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-LCKF_n-stateMatrix-Noureldin-Position}
  \begin{pmatrix} \delta \dotup{\phi} \\ \delta \dotup{\lambda} \\ \delta \dotup{h} \end{pmatrix}
  =
  \begin{pmatrix}
                 0              &amp; \frac{1}{R_N+h} &amp; 0 \\
    \frac{1}{(R_E+h)\cos{\phi}} &amp;        0        &amp; 0 \\
                 0              &amp;        0        &amp; 1 \\
  \end{pmatrix}
  \begin{pmatrix} \delta v_E \\ \delta v_N \\ \delta v_U \end{pmatrix}
\end{equation}" src="form_381.svg" width="1638" height="67"/></picture>
</p>
<p> <a class="anchor" id="eq-LCKF_n-stateMatrix-Noureldin-Velocity"></a> </p><p class="formulaDsp">
<picture><source srcset="form_382_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-LCKF_n-stateMatrix-Noureldin-Velocity}
  \begin{pmatrix} \delta \dotup{v}_{E} \\ \delta \dotup{v}_{N} \\ \delta \dotup{v}_{U} \end{pmatrix}
  =
  \begin{pmatrix}
      0  &amp;  f_U &amp; -f_N \\
    -f_U &amp;   0  &amp;  f_E \\
     f_N &amp; -f_E &amp;   0  \\
  \end{pmatrix}
  \begin{pmatrix} \delta P \\ \delta R \\ \delta Y \end{pmatrix}
  + \mathbf{C}_b^{enu} \boldsymbol{\delta f}^b
\end{equation}" src="form_382.svg" width="1666" height="63"/></picture>
</p>
<p> <a class="anchor" id="eq-LCKF_n-stateMatrix-Noureldin-Attitude"></a> </p><p class="formulaDsp">
<picture><source srcset="form_383_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-LCKF_n-stateMatrix-Noureldin-Attitude}
  \begin{pmatrix} \delta \dotup{P} \\ \delta \dotup{R} \\ \delta \dotup{Y} \end{pmatrix}
  =
  \begin{pmatrix}
                 0              &amp; \frac{1}{R_N + h} &amp; 0 \\
         -\frac{1}{R_E + h}     &amp;         0         &amp; 0 \\
    -\frac{\tan{\phi}}{R_E + h} &amp;         0         &amp; 0 \\
  \end{pmatrix}
  \begin{pmatrix} \delta v_E \\ \delta v_N \\ \delta v_U \end{pmatrix}
  + \mathbf{C}_b^{enu} \boldsymbol{\delta \omega}_{ib}^b
\end{equation}" src="form_383.svg" width="1673" height="72"/></picture>
</p>
<p>Reordering roll/pitch and east/north gives <a class="anchor" id="eq-LCKF_n-stateMatrix-Noureldin-Position-reordered"></a> </p><p class="formulaDsp">
<picture><source srcset="form_384_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-LCKF_n-stateMatrix-Noureldin-Position-reordered}
  \begin{pmatrix} \delta \dotup{\phi} \\ \delta \dotup{\lambda} \\ \delta \dotup{h} \end{pmatrix}
  =
  \begin{pmatrix}
    \frac{1}{R_N+h} &amp;              0              &amp; 0 \\
           0        &amp; \frac{1}{(R_E+h)\cos{\phi}} &amp; 0 \\
           0        &amp;              0              &amp; 1 \\
  \end{pmatrix}
  \begin{pmatrix} \delta v_N \\ \delta v_E \\ \delta v_U \end{pmatrix}
\end{equation}" src="form_384.svg" width="1638" height="67"/></picture>
</p>
<p> <a class="anchor" id="eq-LCKF_n-stateMatrix-Noureldin-Velocity-reordered"></a> </p><p class="formulaDsp">
<picture><source srcset="form_385_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-LCKF_n-stateMatrix-Noureldin-Velocity-reordered}
  \begin{pmatrix} \delta \dotup{v}_{N} \\ \delta \dotup{v}_{E} \\ \delta \dotup{v}_{U} \end{pmatrix}
  =
  \begin{pmatrix}
      0  &amp; -f_U &amp;  f_E \\
     f_U &amp;   0  &amp; -f_N \\
    -f_E &amp;  f_N &amp;   0  \\
  \end{pmatrix}
  \begin{pmatrix} \delta R \\ \delta P \\ \delta Y \end{pmatrix}
  + \mathbf{C}_b^{neu} \boldsymbol{\delta f}^b
\end{equation}" src="form_385.svg" width="1666" height="63"/></picture>
</p>
<p> <a class="anchor" id="eq-LCKF_n-stateMatrix-Noureldin-Attitude-reordered"></a> </p><p class="formulaDsp">
<picture><source srcset="form_386_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-LCKF_n-stateMatrix-Noureldin-Attitude-reordered}
  \begin{pmatrix} \delta \dotup{R} \\ \delta \dotup{P} \\ \delta \dotup{Y} \end{pmatrix}
  =
  \begin{pmatrix}
            0         &amp;      -\frac{1}{R_E + h}     &amp; 0 \\
    \frac{1}{R_N + h} &amp;              0              &amp; 0 \\
            0         &amp; -\frac{\tan{\phi}}{R_E + h} &amp; 0 \\
  \end{pmatrix}
  \begin{pmatrix} \delta v_N \\ \delta v_E \\ \delta v_U \end{pmatrix}
  + \mathbf{C}_b^{neu} \boldsymbol{\delta \omega}_{ib}^b
\end{equation}" src="form_386.svg" width="1673" height="72"/></picture>
</p>
<p> In <a class="el" href="citelist.html#CITEREF_Noureldin2013">[21]</a> ch. 2.2.6.1, p. 32 Noureldin defines the yaw angle as measured counterclockwise from north which is the opposite measurement direction of the NED convention. Therefore all yaw terms have to flip the sign. <a class="anchor" id="eq-LCKF_n-stateMatrix-Noureldin-Position-yaw-sign"></a> </p><p class="formulaDsp">
<picture><source srcset="form_387_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-LCKF_n-stateMatrix-Noureldin-Position-yaw-sign}
  \begin{pmatrix} \delta \dotup{\phi} \\ \delta \dotup{\lambda} \\ \delta \dotup{h} \end{pmatrix}
  =
  \begin{pmatrix}
    \frac{1}{R_N+h} &amp;              0              &amp; 0 \\
           0        &amp; \frac{1}{(R_E+h)\cos{\phi}} &amp; 0 \\
           0        &amp;              0              &amp; 1 \\
  \end{pmatrix}
  \begin{pmatrix} \delta v_N \\ \delta v_E \\ \delta v_U \end{pmatrix}
\end{equation}" src="form_387.svg" width="1638" height="67"/></picture>
</p>
<p> <a class="anchor" id="eq-LCKF_n-stateMatrix-Noureldin-Velocity-yaw-sign"></a> </p><p class="formulaDsp">
<picture><source srcset="form_388_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-LCKF_n-stateMatrix-Noureldin-Velocity-yaw-sign}
  \begin{pmatrix} \delta \dotup{v}_{N} \\ \delta \dotup{v}_{E} \\ \delta \dotup{v}_{U} \end{pmatrix}
  =
  \begin{pmatrix}
      0  &amp; -f_U &amp; -f_E \\
     f_U &amp;   0  &amp;  f_N \\
    -f_E &amp;  f_N &amp;   0  \\
  \end{pmatrix}
  \begin{pmatrix} \delta R \\ \delta P \\ \delta Y \end{pmatrix}
  + \mathbf{C}_b^{neu} \boldsymbol{\delta f}^b
\end{equation}" src="form_388.svg" width="1666" height="63"/></picture>
</p>
<p> <a class="anchor" id="eq-LCKF_n-stateMatrix-Noureldin-Attitude-yaw-sign"></a> </p><p class="formulaDsp">
<picture><source srcset="form_389_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-LCKF_n-stateMatrix-Noureldin-Attitude-yaw-sign}
  \begin{pmatrix} \delta \dotup{R} \\ \delta \dotup{P} \\ \delta \dotup{Y} \end{pmatrix}
  =
  \begin{pmatrix}
            0         &amp;     -\frac{1}{R_E + h}     &amp; 0 \\
    \frac{1}{R_N + h} &amp;             0              &amp; 0 \\
            0         &amp; \frac{\tan{\phi}}{R_E + h} &amp; 0 \\
  \end{pmatrix}
  \begin{pmatrix} \delta v_N \\ \delta v_E \\ \delta v_U \end{pmatrix}
  + \mathbf{C}_b^{neu} \boldsymbol{\delta \omega}_{ib}^b
\end{equation}" src="form_389.svg" width="1673" height="72"/></picture>
</p>
<p>Next we replace the up component with a down component <a class="anchor" id="eq-LCKF_n-stateMatrix-Noureldin-Position-up-down"></a> </p><p class="formulaDsp">
<picture><source srcset="form_390_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-LCKF_n-stateMatrix-Noureldin-Position-up-down}
  \begin{pmatrix} \delta \dotup{\phi} \\ \delta \dotup{\lambda} \\ \delta \dotup{h} \end{pmatrix}
  =
  \begin{pmatrix}
    \frac{1}{R_N+h} &amp;              0              &amp;  0 \\
           0        &amp; \frac{1}{(R_E+h)\cos{\phi}} &amp;  0 \\
           0        &amp;              0              &amp; -1 \\
  \end{pmatrix}
  \begin{pmatrix} \delta v_N \\ \delta v_E \\ \delta v_D \end{pmatrix}
\end{equation}" src="form_390.svg" width="1645" height="67"/></picture>
</p>
<p> <a class="anchor" id="eq-LCKF_n-stateMatrix-Noureldin-Velocity-up-down"></a> </p><p class="formulaDsp">
<picture><source srcset="form_391_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-LCKF_n-stateMatrix-Noureldin-Velocity-up-down}
  \begin{pmatrix} \delta \dotup{v}_{N} \\ \delta \dotup{v}_{E} \\ \delta \dotup{v}_{D} \end{pmatrix}
  =
  \begin{pmatrix}
                0            &amp; \highlight[red!60]{+}f_D &amp; \highlight[red!60]{-}f_E \\
    \highlight[red!60]{-}f_D &amp;             0            &amp; \highlight[red!60]{+}f_N \\
    \highlight[red!60]{+}f_E &amp; \highlight[red!60]{-}f_N &amp;             0            \\
  \end{pmatrix}
  \begin{pmatrix} \delta R \\ \delta P \\ \delta Y \end{pmatrix}
  \highlight[red!60]{+} \mathbf{C}_b^n \boldsymbol{\delta f}^b
\end{equation}" src="form_391.svg" width="1678" height="68"/></picture>
</p>
<p> <a class="anchor" id="eq-LCKF_n-stateMatrix-Noureldin-Attitude-up-down"></a> </p><p class="formulaDsp">
<picture><source srcset="form_392_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-LCKF_n-stateMatrix-Noureldin-Attitude-up-down}
  \begin{pmatrix} \delta \dotup{R} \\ \delta \dotup{P} \\ \delta \dotup{Y} \end{pmatrix}
  =
  \begin{pmatrix}
                      0                    &amp;     \highlight[red!60]{-}\frac{1}{R_E + h}      &amp; 0 \\
    \highlight[red!60]{+}\frac{1}{R_N + h} &amp;                       0                         &amp; 0 \\
                      0                    &amp; \highlight[red!60]{+}\frac{\tan{\phi}}{R_E + h} &amp; 0 \\
  \end{pmatrix}
  \begin{pmatrix} \delta v_N \\ \delta v_E \\ \delta v_D \end{pmatrix}
  + \mathbf{C}_b^n \boldsymbol{\delta \omega}_{ib}^b
\end{equation}" src="form_392.svg" width="1684" height="74"/></picture>
</p>
<p> As in <a class="el" href="citelist.html#CITEREF_Groves2013">[10]</a> Groves, all signs concerning the attitude errors are now switched comparing to <a class="el" href="citelist.html#CITEREF_Titterton2004">[32]</a> Titterton. This leads to the same assumption, that the attitude errors are defined differently. And this can easily be shown by looking at <a class="el" href="citelist.html#CITEREF_Noureldin2013">[21]</a> Noureldin, ch. 6.1.3, eq. 6.44, p. 212 <a class="anchor" id="eq-LCKF_n-stateMatrix-Noureldin-Attitude-error-definition"></a> </p><p class="formulaDsp">
<picture><source srcset="form_393_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation} \label{eq:eq-LCKF_n-stateMatrix-Noureldin-Attitude-error-definition}
  \mathbf{\hat{C}}_b^n = (\mathbf{I} + \mathbf{\Psi}) \mathbf{C}_b^n
\end{equation}" src="form_393.svg" width="1537" height="23"/></picture>
</p>
<p> Comparing this with equation <a class="el" href="group__LooselyCoupledKF__n.html#eq-LCKF_n-Derivation-Attitude-estimate-errors"><picture><source srcset="form_288_dark.svg" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="\eqref{eq:eq-LCKF_n-Derivation-Attitude-estimate-errors}" src="form_288.svg" width="44" height="19"/></picture> </a> we can see that the attitude error is defined in the opposite direction. </p>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.2-->
<!-- start footer part -->
<div id="nav-path" class="navpath">
    <!-- id is needed for treeview function! -->
    <ul>
        <li class="footer">Generated on Mon Jan 23 2023 09:56:09 for INSTINCT by <a href="https://www.doxygen.org/index.html"><img class="footer"
                    src="doxygen.svg" width="104" height="31" alt="doxygen" /></a> 1.9.6 </li>
    </ul>
</div>
</body>
</html>
